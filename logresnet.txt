step 1: 
step 2: 
Layer conv1, precision switch from w4a8 to w4a8.
Layer layer1.0.conv1, precision switch from w4a8 to w4a8.
Layer layer1.0.conv2, precision switch from w4a8 to w4a8.
Layer layer1.0.conv3, precision switch from w4a8 to w4a8.
Layer layer1.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer1.1.conv1, precision switch from w4a8 to w4a8.
Layer layer1.1.conv2, precision switch from w4a8 to w4a8.
Layer layer1.1.conv3, precision switch from w4a8 to w4a8.
Layer layer1.2.conv1, precision switch from w4a8 to w4a8.
Layer layer1.2.conv2, precision switch from w4a8 to w4a8.
Layer layer1.2.conv3, precision switch from w4a8 to w4a8.
Layer layer2.0.conv1, precision switch from w4a8 to w4a8.
Layer layer2.0.conv2, precision switch from w4a8 to w4a8.
Layer layer2.0.conv3, precision switch from w4a8 to w4a8.
Layer layer2.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer2.1.conv1, precision switch from w4a8 to w4a8.
Layer layer2.1.conv2, precision switch from w4a8 to w4a8.
Layer layer2.1.conv3, precision switch from w4a8 to w4a8.
Layer layer2.2.conv1, precision switch from w4a8 to w4a8.
Layer layer2.2.conv2, precision switch from w4a8 to w4a8.
Layer layer2.2.conv3, precision switch from w4a8 to w4a8.
Layer layer2.3.conv1, precision switch from w4a8 to w4a8.
Layer layer2.3.conv2, precision switch from w4a8 to w4a8.
Layer layer2.3.conv3, precision switch from w4a8 to w4a8.
Layer layer3.0.conv1, precision switch from w4a8 to w4a8.
Layer layer3.0.conv2, precision switch from w4a8 to w4a8.
Layer layer3.0.conv3, precision switch from w4a8 to w4a8.
Layer layer3.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer3.1.conv1, precision switch from w4a8 to w4a8.
Layer layer3.1.conv2, precision switch from w4a8 to w4a8.
Layer layer3.1.conv3, precision switch from w4a8 to w4a8.
Layer layer3.2.conv1, precision switch from w4a8 to w4a8.
Layer layer3.2.conv2, precision switch from w4a8 to w4a8.
Layer layer3.2.conv3, precision switch from w4a8 to w4a8.
Layer layer3.3.conv1, precision switch from w4a8 to w4a8.
Layer layer3.3.conv2, precision switch from w4a8 to w4a8.
Layer layer3.3.conv3, precision switch from w4a8 to w4a8.
Layer layer3.4.conv1, precision switch from w4a8 to w4a8.
Layer layer3.4.conv2, precision switch from w4a8 to w4a8.
Layer layer3.4.conv3, precision switch from w4a8 to w4a8.
Layer layer3.5.conv1, precision switch from w4a8 to w4a8.
Layer layer3.5.conv2, precision switch from w4a8 to w4a8.
Layer layer3.5.conv3, precision switch from w4a8 to w4a8.
Layer layer4.0.conv1, precision switch from w4a8 to w4a8.
Layer layer4.0.conv2, precision switch from w4a8 to w4a8.
Layer layer4.0.conv3, precision switch from w4a8 to w4a8.
Layer layer4.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer4.1.conv1, precision switch from w4a8 to w4a8.
Layer layer4.1.conv2, precision switch from w4a8 to w4a8.
Layer layer4.1.conv3, precision switch from w4a8 to w4a8.
Layer layer4.2.conv1, precision switch from w4a8 to w4a8.
Layer layer4.2.conv2, precision switch from w4a8 to w4a8.
Layer layer4.2.conv3, precision switch from w4a8 to w4a8.
Layer fc, precision switch from w4a8 to w4a8.
read json file /workspace/develop/CalibTIP/results/resnet50_w4a8.adaquant/resnet_adaquant.piano.kdp530.scaled.onnx.json
Json : Layer conv1, precision switch from w8a8 to w8a8.
Json : Layer layer1.0.conv1, precision switch from w4a8 to w4a8.
Json : Layer layer1.0.conv2, precision switch from w4a8 to w4a8.
Json : Layer layer1.0.conv3, precision switch from w4a8 to w4a8.
Json : Layer layer1.0.downsample.0, precision switch from w4a8 to w4a8.
Json : Layer layer1.1.conv1, precision switch from w4a8 to w4a8.
Json : Layer layer1.1.conv2, precision switch from w4a8 to w4a8.
Json : Layer layer1.1.conv3, precision switch from w4a8 to w4a8.
Json : Layer layer1.2.conv1, precision switch from w4a8 to w4a8.
Json : Layer layer1.2.conv2, precision switch from w4a8 to w4a8.
Json : Layer layer1.2.conv3, precision switch from w4a8 to w4a8.
Json : Layer layer2.0.conv1, precision switch from w4a8 to w4a8.
Json : Layer layer2.0.conv2, precision switch from w4a8 to w4a8.
Json : Layer layer2.0.conv3, precision switch from w4a8 to w4a8.
Json : Layer layer2.0.downsample.0, precision switch from w4a8 to w4a8.
Json : Layer layer2.1.conv1, precision switch from w4a8 to w4a8.
Json : Layer layer2.1.conv2, precision switch from w4a8 to w4a8.
Json : Layer layer2.1.conv3, precision switch from w4a8 to w4a8.
Json : Layer layer2.2.conv1, precision switch from w4a8 to w4a8.
Json : Layer layer2.2.conv2, precision switch from w4a8 to w4a8.
Json : Layer layer2.2.conv3, precision switch from w4a8 to w4a8.
Json : Layer layer2.3.conv1, precision switch from w4a8 to w4a8.
Json : Layer layer2.3.conv2, precision switch from w4a8 to w4a8.
Json : Layer layer2.3.conv3, precision switch from w4a8 to w4a8.
Json : Layer layer3.0.conv1, precision switch from w4a8 to w4a8.
Json : Layer layer3.0.conv2, precision switch from w4a8 to w4a8.
Json : Layer layer3.0.conv3, precision switch from w4a8 to w4a8.
Json : Layer layer3.0.downsample.0, precision switch from w4a8 to w4a8.
Json : Layer layer3.1.conv1, precision switch from w4a8 to w4a8.
Json : Layer layer3.1.conv2, precision switch from w4a8 to w4a8.
Json : Layer layer3.1.conv3, precision switch from w4a8 to w4a8.
Json : Layer layer3.2.conv1, precision switch from w4a8 to w4a8.
Json : Layer layer3.2.conv2, precision switch from w4a8 to w4a8.
Json : Layer layer3.2.conv3, precision switch from w4a8 to w4a8.
Json : Layer layer3.3.conv1, precision switch from w4a8 to w4a8.
Json : Layer layer3.3.conv2, precision switch from w4a8 to w4a8.
Json : Layer layer3.3.conv3, precision switch from w4a8 to w4a8.
Json : Layer layer3.4.conv1, precision switch from w4a8 to w4a8.
Json : Layer layer3.4.conv2, precision switch from w4a8 to w4a8.
Json : Layer layer3.4.conv3, precision switch from w4a8 to w4a8.
Json : Layer layer3.5.conv1, precision switch from w4a8 to w4a8.
Json : Layer layer3.5.conv2, precision switch from w4a8 to w4a8.
Json : Layer layer3.5.conv3, precision switch from w4a8 to w4a8.
Json : Layer layer4.0.conv1, precision switch from w4a8 to w4a8.
Json : Layer layer4.0.conv2, precision switch from w4a8 to w4a8.
Json : Layer layer4.0.conv3, precision switch from w4a8 to w4a8.
Json : Layer layer4.0.downsample.0, precision switch from w4a8 to w4a8.
Json : Layer layer4.1.conv1, precision switch from w4a8 to w4a8.
Json : Layer layer4.1.conv2, precision switch from w4a8 to w4a8.
Json : Layer layer4.1.conv3, precision switch from w4a8 to w4a8.
Json : Layer layer4.2.conv1, precision switch from w4a8 to w4a8.
Json : Layer layer4.2.conv2, precision switch from w4a8 to w4a8.
Json : Layer layer4.2.conv3, precision switch from w4a8 to w4a8.
Json : Layer fc, precision switch from w8a8 to w8a8.
step 3: 
Layer conv1, precision switch from w4a8 to w4a8.
Layer layer1.0.conv1, precision switch from w4a8 to w4a8.
Layer layer1.0.conv2, precision switch from w4a8 to w4a8.
Layer layer1.0.conv3, precision switch from w4a8 to w4a8.
Layer layer1.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer1.1.conv1, precision switch from w4a8 to w4a8.
Layer layer1.1.conv2, precision switch from w4a8 to w4a8.
Layer layer1.1.conv3, precision switch from w4a8 to w4a8.
Layer layer1.2.conv1, precision switch from w4a8 to w4a8.
Layer layer1.2.conv2, precision switch from w4a8 to w4a8.
Layer layer1.2.conv3, precision switch from w4a8 to w4a8.
Layer layer2.0.conv1, precision switch from w4a8 to w4a8.
Layer layer2.0.conv2, precision switch from w4a8 to w4a8.
Layer layer2.0.conv3, precision switch from w4a8 to w4a8.
Layer layer2.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer2.1.conv1, precision switch from w4a8 to w4a8.
Layer layer2.1.conv2, precision switch from w4a8 to w4a8.
Layer layer2.1.conv3, precision switch from w4a8 to w4a8.
Layer layer2.2.conv1, precision switch from w4a8 to w4a8.
Layer layer2.2.conv2, precision switch from w4a8 to w4a8.
Layer layer2.2.conv3, precision switch from w4a8 to w4a8.
Layer layer2.3.conv1, precision switch from w4a8 to w4a8.
Layer layer2.3.conv2, precision switch from w4a8 to w4a8.
Layer layer2.3.conv3, precision switch from w4a8 to w4a8.
Layer layer3.0.conv1, precision switch from w4a8 to w4a8.
Layer layer3.0.conv2, precision switch from w4a8 to w4a8.
Layer layer3.0.conv3, precision switch from w4a8 to w4a8.
Layer layer3.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer3.1.conv1, precision switch from w4a8 to w4a8.
Layer layer3.1.conv2, precision switch from w4a8 to w4a8.
Layer layer3.1.conv3, precision switch from w4a8 to w4a8.
Layer layer3.2.conv1, precision switch from w4a8 to w4a8.
Layer layer3.2.conv2, precision switch from w4a8 to w4a8.
Layer layer3.2.conv3, precision switch from w4a8 to w4a8.
Layer layer3.3.conv1, precision switch from w4a8 to w4a8.
Layer layer3.3.conv2, precision switch from w4a8 to w4a8.
Layer layer3.3.conv3, precision switch from w4a8 to w4a8.
Layer layer3.4.conv1, precision switch from w4a8 to w4a8.
Layer layer3.4.conv2, precision switch from w4a8 to w4a8.
Layer layer3.4.conv3, precision switch from w4a8 to w4a8.
Layer layer3.5.conv1, precision switch from w4a8 to w4a8.
Layer layer3.5.conv2, precision switch from w4a8 to w4a8.
Layer layer3.5.conv3, precision switch from w4a8 to w4a8.
Layer layer4.0.conv1, precision switch from w4a8 to w4a8.
Layer layer4.0.conv2, precision switch from w4a8 to w4a8.
Layer layer4.0.conv3, precision switch from w4a8 to w4a8.
Layer layer4.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer4.1.conv1, precision switch from w4a8 to w4a8.
Layer layer4.1.conv2, precision switch from w4a8 to w4a8.
Layer layer4.1.conv3, precision switch from w4a8 to w4a8.
Layer layer4.2.conv1, precision switch from w4a8 to w4a8.
Layer layer4.2.conv2, precision switch from w4a8 to w4a8.
Layer layer4.2.conv3, precision switch from w4a8 to w4a8.
Layer fc, precision switch from w4a8 to w4a8.
Input/outputs cached

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/resnet50_w4a8.adaquant/resnet.absorb_bn.measure_perC.before_adaquant.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/resnet50_w4a8.adaquant/resnet.absorb_bn.measure_perC.before_adaquant.onnx
Bernard calculate float point model accuracy before enabling quantization!
Bernard calculate fixed point model accuracy before training!

Optimize 0:conv1 for w4a8 bit of shape torch.Size([64, 3, 7, 7])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 6.894176e-05
MSE after  adaquant: 3.584085e-05
layer layer1.0.conv1's input scale is updated
layer layer1.0.downsample.0's input scale is updated
 End of training layer  conv1 better/total layers= 1 / 1 


Optimize 1:layer1.0.conv1 for w4a8 bit of shape torch.Size([64, 64, 1, 1])

MSE before adaquant: 3.419290e-03
MSE after  adaquant: 1.496203e-03
layer layer1.0.conv2's input scale is updated
 End of training layer  layer1.0.conv1 better/total layers= 2 / 2 


Optimize 2:layer1.0.conv2 for w4a8 bit of shape torch.Size([64, 64, 3, 3])

MSE before adaquant: 2.936999e-03
MSE after  adaquant: 9.972997e-04
layer layer1.0.conv3's input scale is updated
 End of training layer  layer1.0.conv2 better/total layers= 3 / 3 


Optimize 3:layer1.0.conv3 for w4a8 bit of shape torch.Size([256, 64, 1, 1])

MSE before adaquant: 3.198596e-03
MSE after  adaquant: 8.174929e-04
 End of training layer  layer1.0.conv3 better/total layers= 4 / 4 


Optimize 4:layer1.0.downsample.0 for w4a8 bit of shape torch.Size([256, 64, 1, 1])

MSE before adaquant: 1.484338e-02
MSE after  adaquant: 4.111572e-03
 End of training layer  layer1.0.downsample.0 better/total layers= 5 / 5 


Optimize 5:layer1.1.conv1 for w4a8 bit of shape torch.Size([64, 256, 1, 1])

MSE before adaquant: 1.503163e-03
MSE after  adaquant: 3.127059e-04
layer layer1.1.conv2's input scale is updated
 End of training layer  layer1.1.conv1 better/total layers= 6 / 6 


Optimize 6:layer1.1.conv2 for w4a8 bit of shape torch.Size([64, 64, 3, 3])

MSE before adaquant: 2.852533e-03
MSE after  adaquant: 9.278622e-04
layer layer1.1.conv3's input scale is updated
 End of training layer  layer1.1.conv2 better/total layers= 7 / 7 


Optimize 7:layer1.1.conv3 for w4a8 bit of shape torch.Size([256, 64, 1, 1])

MSE before adaquant: 9.069350e-04
MSE after  adaquant: 6.187970e-04
 End of training layer  layer1.1.conv3 better/total layers= 8 / 8 


Optimize 8:layer1.2.conv1 for w4a8 bit of shape torch.Size([64, 256, 1, 1])

MSE before adaquant: 1.785558e-03
MSE after  adaquant: 3.932838e-04
layer layer1.2.conv2's input scale is updated
 End of training layer  layer1.2.conv1 better/total layers= 9 / 9 


Optimize 9:layer1.2.conv2 for w4a8 bit of shape torch.Size([64, 64, 3, 3])

MSE before adaquant: 1.050353e-03
MSE after  adaquant: 8.243007e-04
layer layer1.2.conv3's input scale is updated
 End of training layer  layer1.2.conv2 better/total layers= 10 / 10 


Optimize 10:layer1.2.conv3 for w4a8 bit of shape torch.Size([256, 64, 1, 1])

MSE before adaquant: 6.543504e-04
MSE after  adaquant: 5.900505e-04
 End of training layer  layer1.2.conv3 better/total layers= 11 / 11 


Optimize 11:layer2.0.conv1 for w4a8 bit of shape torch.Size([128, 256, 1, 1])

MSE before adaquant: 1.841823e-03
MSE after  adaquant: 5.718878e-04
layer layer2.0.conv2's input scale is updated
 End of training layer  layer2.0.conv1 better/total layers= 12 / 12 


Optimize 12:layer2.0.conv2 for w4a8 bit of shape torch.Size([128, 128, 3, 3])

MSE before adaquant: 7.352613e-04
MSE after  adaquant: 7.177959e-04
layer layer2.0.conv3's input scale is updated
 End of training layer  layer2.0.conv2 better/total layers= 13 / 13 


Optimize 13:layer2.0.conv3 for w4a8 bit of shape torch.Size([512, 128, 1, 1])

MSE before adaquant: 1.851493e-03
MSE after  adaquant: 1.092541e-03
 End of training layer  layer2.0.conv3 better/total layers= 14 / 14 


Optimize 14:layer2.0.downsample.0 for w4a8 bit of shape torch.Size([512, 256, 1, 1])

MSE before adaquant: 2.690346e-03
MSE after  adaquant: 9.128285e-04
 End of training layer  layer2.0.downsample.0 better/total layers= 15 / 15 


Optimize 15:layer2.1.conv1 for w4a8 bit of shape torch.Size([128, 512, 1, 1])

MSE before adaquant: 6.143528e-04
MSE after  adaquant: 1.545307e-04
layer layer2.1.conv2's input scale is updated
 End of training layer  layer2.1.conv1 better/total layers= 16 / 16 


Optimize 16:layer2.1.conv2 for w4a8 bit of shape torch.Size([128, 128, 3, 3])

MSE before adaquant: 5.216096e-03
MSE after  adaquant: 8.544590e-04
layer layer2.1.conv3's input scale is updated
 End of training layer  layer2.1.conv2 better/total layers= 17 / 17 


Optimize 17:layer2.1.conv3 for w4a8 bit of shape torch.Size([512, 128, 1, 1])

MSE before adaquant: 1.253565e-03
MSE after  adaquant: 6.851429e-04
 End of training layer  layer2.1.conv3 better/total layers= 18 / 18 


Optimize 18:layer2.2.conv1 for w4a8 bit of shape torch.Size([128, 512, 1, 1])

MSE before adaquant: 1.158615e-03
MSE after  adaquant: 4.557812e-04
layer layer2.2.conv2's input scale is updated
 End of training layer  layer2.2.conv1 better/total layers= 19 / 19 


Optimize 19:layer2.2.conv2 for w4a8 bit of shape torch.Size([128, 128, 3, 3])

MSE before adaquant: 1.413234e-03
MSE after  adaquant: 6.323751e-04
layer layer2.2.conv3's input scale is updated
 End of training layer  layer2.2.conv2 better/total layers= 20 / 20 


Optimize 20:layer2.2.conv3 for w4a8 bit of shape torch.Size([512, 128, 1, 1])

MSE before adaquant: 9.275973e-04
MSE after  adaquant: 6.248811e-04
 End of training layer  layer2.2.conv3 better/total layers= 21 / 21 


Optimize 21:layer2.3.conv1 for w4a8 bit of shape torch.Size([128, 512, 1, 1])

MSE before adaquant: 8.778240e-04
MSE after  adaquant: 4.977181e-04
layer layer2.3.conv2's input scale is updated
 End of training layer  layer2.3.conv1 better/total layers= 22 / 22 


Optimize 22:layer2.3.conv2 for w4a8 bit of shape torch.Size([128, 128, 3, 3])

MSE before adaquant: 8.121958e-04
MSE after  adaquant: 5.374554e-04
layer layer2.3.conv3's input scale is updated
 End of training layer  layer2.3.conv2 better/total layers= 23 / 23 


Optimize 23:layer2.3.conv3 for w4a8 bit of shape torch.Size([512, 128, 1, 1])

MSE before adaquant: 8.528099e-04
MSE after  adaquant: 6.649015e-04
 End of training layer  layer2.3.conv3 better/total layers= 24 / 24 


Optimize 24:layer3.0.conv1 for w4a8 bit of shape torch.Size([256, 512, 1, 1])

MSE before adaquant: 1.333514e-03
MSE after  adaquant: 6.467956e-04
layer layer3.0.conv2's input scale is updated
 End of training layer  layer3.0.conv1 better/total layers= 25 / 25 


Optimize 25:layer3.0.conv2 for w4a8 bit of shape torch.Size([256, 256, 3, 3])

MSE before adaquant: 1.146788e-03
MSE after  adaquant: 6.625402e-04
layer layer3.0.conv3's input scale is updated
 End of training layer  layer3.0.conv2 better/total layers= 26 / 26 


Optimize 26:layer3.0.conv3 for w4a8 bit of shape torch.Size([1024, 256, 1, 1])

MSE before adaquant: 2.028993e-03
MSE after  adaquant: 1.027071e-03
 End of training layer  layer3.0.conv3 better/total layers= 27 / 27 


Optimize 27:layer3.0.downsample.0 for w4a8 bit of shape torch.Size([1024, 512, 1, 1])

MSE before adaquant: 1.149432e-03
MSE after  adaquant: 5.996107e-04
 End of training layer  layer3.0.downsample.0 better/total layers= 28 / 28 


Optimize 28:layer3.1.conv1 for w4a8 bit of shape torch.Size([256, 1024, 1, 1])

MSE before adaquant: 8.457868e-04
MSE after  adaquant: 3.168133e-04
layer layer3.1.conv2's input scale is updated
 End of training layer  layer3.1.conv1 better/total layers= 29 / 29 


Optimize 29:layer3.1.conv2 for w4a8 bit of shape torch.Size([256, 256, 3, 3])

MSE before adaquant: 1.190594e-03
MSE after  adaquant: 4.124536e-04
layer layer3.1.conv3's input scale is updated
 End of training layer  layer3.1.conv2 better/total layers= 30 / 30 


Optimize 30:layer3.1.conv3 for w4a8 bit of shape torch.Size([1024, 256, 1, 1])

MSE before adaquant: 1.313275e-03
MSE after  adaquant: 8.532571e-04
 End of training layer  layer3.1.conv3 better/total layers= 31 / 31 


Optimize 31:layer3.2.conv1 for w4a8 bit of shape torch.Size([256, 1024, 1, 1])

MSE before adaquant: 8.239037e-04
MSE after  adaquant: 3.426005e-04
layer layer3.2.conv2's input scale is updated
 End of training layer  layer3.2.conv1 better/total layers= 32 / 32 


Optimize 32:layer3.2.conv2 for w4a8 bit of shape torch.Size([256, 256, 3, 3])

MSE before adaquant: 5.106197e-04
MSE after  adaquant: 2.575208e-04
layer layer3.2.conv3's input scale is updated
 End of training layer  layer3.2.conv2 better/total layers= 33 / 33 


Optimize 33:layer3.2.conv3 for w4a8 bit of shape torch.Size([1024, 256, 1, 1])

MSE before adaquant: 7.529163e-04
MSE after  adaquant: 4.715945e-04
 End of training layer  layer3.2.conv3 better/total layers= 34 / 34 


Optimize 34:layer3.3.conv1 for w4a8 bit of shape torch.Size([256, 1024, 1, 1])

MSE before adaquant: 7.853715e-04
MSE after  adaquant: 3.477357e-04
layer layer3.3.conv2's input scale is updated
 End of training layer  layer3.3.conv1 better/total layers= 35 / 35 


Optimize 35:layer3.3.conv2 for w4a8 bit of shape torch.Size([256, 256, 3, 3])

MSE before adaquant: 7.935458e-04
MSE after  adaquant: 3.827807e-04
layer layer3.3.conv3's input scale is updated
 End of training layer  layer3.3.conv2 better/total layers= 36 / 36 


Optimize 36:layer3.3.conv3 for w4a8 bit of shape torch.Size([1024, 256, 1, 1])

MSE before adaquant: 9.240258e-04
MSE after  adaquant: 6.032264e-04
 End of training layer  layer3.3.conv3 better/total layers= 37 / 37 


Optimize 37:layer3.4.conv1 for w4a8 bit of shape torch.Size([256, 1024, 1, 1])

MSE before adaquant: 8.459002e-04
MSE after  adaquant: 4.226477e-04
layer layer3.4.conv2's input scale is updated
 End of training layer  layer3.4.conv1 better/total layers= 38 / 38 


Optimize 38:layer3.4.conv2 for w4a8 bit of shape torch.Size([256, 256, 3, 3])

MSE before adaquant: 1.047118e-03
MSE after  adaquant: 4.179328e-04
layer layer3.4.conv3's input scale is updated
 End of training layer  layer3.4.conv2 better/total layers= 39 / 39 


Optimize 39:layer3.4.conv3 for w4a8 bit of shape torch.Size([1024, 256, 1, 1])

MSE before adaquant: 1.195261e-03
MSE after  adaquant: 7.960934e-04
 End of training layer  layer3.4.conv3 better/total layers= 40 / 40 


Optimize 40:layer3.5.conv1 for w4a8 bit of shape torch.Size([256, 1024, 1, 1])

MSE before adaquant: 9.355588e-04
MSE after  adaquant: 4.458387e-04
layer layer3.5.conv2's input scale is updated
 End of training layer  layer3.5.conv1 better/total layers= 41 / 41 


Optimize 41:layer3.5.conv2 for w4a8 bit of shape torch.Size([256, 256, 3, 3])

MSE before adaquant: 1.377325e-03
MSE after  adaquant: 4.964999e-04
layer layer3.5.conv3's input scale is updated
 End of training layer  layer3.5.conv2 better/total layers= 42 / 42 


Optimize 42:layer3.5.conv3 for w4a8 bit of shape torch.Size([1024, 256, 1, 1])

MSE before adaquant: 1.345220e-03
MSE after  adaquant: 8.544315e-04
 End of training layer  layer3.5.conv3 better/total layers= 43 / 43 


Optimize 43:layer4.0.conv1 for w4a8 bit of shape torch.Size([512, 1024, 1, 1])

MSE before adaquant: 8.571494e-04
MSE after  adaquant: 5.033964e-04
layer layer4.0.conv2's input scale is updated
 End of training layer  layer4.0.conv1 better/total layers= 44 / 44 


Optimize 44:layer4.0.conv2 for w4a8 bit of shape torch.Size([512, 512, 3, 3])

MSE before adaquant: 7.200147e-04
MSE after  adaquant: 3.362574e-04
layer layer4.0.conv3's input scale is updated
 End of training layer  layer4.0.conv2 better/total layers= 45 / 45 


Optimize 45:layer4.0.conv3 for w4a8 bit of shape torch.Size([2048, 512, 1, 1])

MSE before adaquant: 1.694686e-02
MSE after  adaquant: 1.410714e-02
 End of training layer  layer4.0.conv3 better/total layers= 46 / 46 


Optimize 46:layer4.0.downsample.0 for w4a8 bit of shape torch.Size([2048, 1024, 1, 1])

MSE before adaquant: 1.073489e-02
MSE after  adaquant: 8.434291e-03
 End of training layer  layer4.0.downsample.0 better/total layers= 47 / 47 


Optimize 47:layer4.1.conv1 for w4a8 bit of shape torch.Size([512, 2048, 1, 1])

MSE before adaquant: 1.099315e-03
MSE after  adaquant: 2.928448e-04
layer layer4.1.conv2's input scale is updated
 End of training layer  layer4.1.conv1 better/total layers= 48 / 48 


Optimize 48:layer4.1.conv2 for w4a8 bit of shape torch.Size([512, 512, 3, 3])

MSE before adaquant: 5.465976e-04
MSE after  adaquant: 3.159188e-04
layer layer4.1.conv3's input scale is updated
 End of training layer  layer4.1.conv2 better/total layers= 49 / 49 


Optimize 49:layer4.1.conv3 for w4a8 bit of shape torch.Size([2048, 512, 1, 1])

MSE before adaquant: 1.441057e-02
MSE after  adaquant: 1.253615e-02
 End of training layer  layer4.1.conv3 better/total layers= 50 / 50 


Optimize 50:layer4.2.conv1 for w4a8 bit of shape torch.Size([512, 2048, 1, 1])

MSE before adaquant: 1.242290e-03
MSE after  adaquant: 5.543337e-04
layer layer4.2.conv2's input scale is updated
 End of training layer  layer4.2.conv1 better/total layers= 51 / 51 


Optimize 51:layer4.2.conv2 for w4a8 bit of shape torch.Size([512, 512, 3, 3])

MSE before adaquant: 7.043206e-04
MSE after  adaquant: 4.220321e-04
layer layer4.2.conv3's input scale is updated
 End of training layer  layer4.2.conv2 better/total layers= 52 / 52 


Optimize 52:layer4.2.conv3 for w4a8 bit of shape torch.Size([2048, 512, 1, 1])

MSE before adaquant: 8.002562e-02
MSE after  adaquant: 7.328673e-02
 End of training layer  layer4.2.conv3 better/total layers= 53 / 53 


Optimize 53:fc for w4a8 bit of shape torch.Size([1000, 2048])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.953785e-03
MSE after  adaquant: 1.161112e-03
 End of training layer  fc better/total layers= 54 / 54 

step 1: 
step 2: 
Layer conv1, precision switch from w8a8 to w8a8.
Layer layer1.0.conv1, precision switch from w8a8 to w8a8.
Layer layer1.0.conv2, precision switch from w8a8 to w8a8.
Layer layer1.0.conv3, precision switch from w8a8 to w8a8.
Layer layer1.0.downsample.0, precision switch from w8a8 to w8a8.
Layer layer1.1.conv1, precision switch from w8a8 to w8a8.
Layer layer1.1.conv2, precision switch from w8a8 to w8a8.
Layer layer1.1.conv3, precision switch from w8a8 to w8a8.
Layer layer1.2.conv1, precision switch from w8a8 to w8a8.
Layer layer1.2.conv2, precision switch from w8a8 to w8a8.
Layer layer1.2.conv3, precision switch from w8a8 to w8a8.
Layer layer2.0.conv1, precision switch from w8a8 to w8a8.
Layer layer2.0.conv2, precision switch from w8a8 to w8a8.
Layer layer2.0.conv3, precision switch from w8a8 to w8a8.
Layer layer2.0.downsample.0, precision switch from w8a8 to w8a8.
Layer layer2.1.conv1, precision switch from w8a8 to w8a8.
Layer layer2.1.conv2, precision switch from w8a8 to w8a8.
Layer layer2.1.conv3, precision switch from w8a8 to w8a8.
Layer layer2.2.conv1, precision switch from w8a8 to w8a8.
Layer layer2.2.conv2, precision switch from w8a8 to w8a8.
Layer layer2.2.conv3, precision switch from w8a8 to w8a8.
Layer layer2.3.conv1, precision switch from w8a8 to w8a8.
Layer layer2.3.conv2, precision switch from w8a8 to w8a8.
Layer layer2.3.conv3, precision switch from w8a8 to w8a8.
Layer layer3.0.conv1, precision switch from w8a8 to w8a8.
Layer layer3.0.conv2, precision switch from w8a8 to w8a8.
Layer layer3.0.conv3, precision switch from w8a8 to w8a8.
Layer layer3.0.downsample.0, precision switch from w8a8 to w8a8.
Layer layer3.1.conv1, precision switch from w8a8 to w8a8.
Layer layer3.1.conv2, precision switch from w8a8 to w8a8.
Layer layer3.1.conv3, precision switch from w8a8 to w8a8.
Layer layer3.2.conv1, precision switch from w8a8 to w8a8.
Layer layer3.2.conv2, precision switch from w8a8 to w8a8.
Layer layer3.2.conv3, precision switch from w8a8 to w8a8.
Layer layer3.3.conv1, precision switch from w8a8 to w8a8.
Layer layer3.3.conv2, precision switch from w8a8 to w8a8.
Layer layer3.3.conv3, precision switch from w8a8 to w8a8.
Layer layer3.4.conv1, precision switch from w8a8 to w8a8.
Layer layer3.4.conv2, precision switch from w8a8 to w8a8.
Layer layer3.4.conv3, precision switch from w8a8 to w8a8.
Layer layer3.5.conv1, precision switch from w8a8 to w8a8.
Layer layer3.5.conv2, precision switch from w8a8 to w8a8.
Layer layer3.5.conv3, precision switch from w8a8 to w8a8.
Layer layer4.0.conv1, precision switch from w8a8 to w8a8.
Layer layer4.0.conv2, precision switch from w8a8 to w8a8.
Layer layer4.0.conv3, precision switch from w8a8 to w8a8.
Layer layer4.0.downsample.0, precision switch from w8a8 to w8a8.
Layer layer4.1.conv1, precision switch from w8a8 to w8a8.
Layer layer4.1.conv2, precision switch from w8a8 to w8a8.
Layer layer4.1.conv3, precision switch from w8a8 to w8a8.
Layer layer4.2.conv1, precision switch from w8a8 to w8a8.
Layer layer4.2.conv2, precision switch from w8a8 to w8a8.
Layer layer4.2.conv3, precision switch from w8a8 to w8a8.
Layer fc, precision switch from w8a8 to w8a8.
read json file /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet_adaquant.piano.kdp530.scaled.onnx.json
Json : Layer conv1, precision switch from w8a8 to w8a8.
Json : Layer layer1.0.conv1, precision switch from w8a8 to w8a8.
Json : Layer layer1.0.conv2, precision switch from w8a8 to w8a8.
Json : Layer layer1.0.conv3, precision switch from w8a8 to w8a8.
Json : Layer layer1.0.downsample.0, precision switch from w8a8 to w8a8.
Json : Layer layer1.1.conv1, precision switch from w8a8 to w8a8.
Json : Layer layer1.1.conv2, precision switch from w8a8 to w8a8.
Json : Layer layer1.1.conv3, precision switch from w8a8 to w8a8.
Json : Layer layer1.2.conv1, precision switch from w8a8 to w8a8.
Json : Layer layer1.2.conv2, precision switch from w8a8 to w8a8.
Json : Layer layer1.2.conv3, precision switch from w8a8 to w8a8.
Json : Layer layer2.0.conv1, precision switch from w8a8 to w8a8.
Json : Layer layer2.0.conv2, precision switch from w8a8 to w8a8.
Json : Layer layer2.0.conv3, precision switch from w8a8 to w8a8.
Json : Layer layer2.0.downsample.0, precision switch from w8a8 to w8a8.
Json : Layer layer2.1.conv1, precision switch from w8a8 to w8a8.
Json : Layer layer2.1.conv2, precision switch from w8a8 to w8a8.
Json : Layer layer2.1.conv3, precision switch from w8a8 to w8a8.
Json : Layer layer2.2.conv1, precision switch from w8a8 to w8a8.
Json : Layer layer2.2.conv2, precision switch from w8a8 to w8a8.
Json : Layer layer2.2.conv3, precision switch from w8a8 to w8a8.
Json : Layer layer2.3.conv1, precision switch from w8a8 to w8a8.
Json : Layer layer2.3.conv2, precision switch from w8a8 to w8a8.
Json : Layer layer2.3.conv3, precision switch from w8a8 to w8a8.
Json : Layer layer3.0.conv1, precision switch from w8a8 to w8a8.
Json : Layer layer3.0.conv2, precision switch from w8a8 to w8a8.
Json : Layer layer3.0.conv3, precision switch from w8a8 to w8a8.
Json : Layer layer3.0.downsample.0, precision switch from w8a8 to w8a8.
Json : Layer layer3.1.conv1, precision switch from w8a8 to w8a8.
Json : Layer layer3.1.conv2, precision switch from w8a8 to w8a8.
Json : Layer layer3.1.conv3, precision switch from w8a8 to w8a8.
Json : Layer layer3.2.conv1, precision switch from w8a8 to w8a8.
Json : Layer layer3.2.conv2, precision switch from w8a8 to w8a8.
Json : Layer layer3.2.conv3, precision switch from w8a8 to w8a8.
Json : Layer layer3.3.conv1, precision switch from w8a8 to w8a8.
Json : Layer layer3.3.conv2, precision switch from w8a8 to w8a8.
Json : Layer layer3.3.conv3, precision switch from w8a8 to w8a8.
Json : Layer layer3.4.conv1, precision switch from w8a8 to w8a8.
Json : Layer layer3.4.conv2, precision switch from w8a8 to w8a8.
Json : Layer layer3.4.conv3, precision switch from w8a8 to w8a8.
Json : Layer layer3.5.conv1, precision switch from w8a8 to w8a8.
Json : Layer layer3.5.conv2, precision switch from w8a8 to w8a8.
Json : Layer layer3.5.conv3, precision switch from w8a8 to w8a8.
Json : Layer layer4.0.conv1, precision switch from w8a8 to w8a8.
Json : Layer layer4.0.conv2, precision switch from w8a8 to w8a8.
Json : Layer layer4.0.conv3, precision switch from w8a8 to w8a8.
Json : Layer layer4.0.downsample.0, precision switch from w8a8 to w8a8.
Json : Layer layer4.1.conv1, precision switch from w8a8 to w8a8.
Json : Layer layer4.1.conv2, precision switch from w8a8 to w8a8.
Json : Layer layer4.1.conv3, precision switch from w8a8 to w8a8.
Json : Layer layer4.2.conv1, precision switch from w8a8 to w8a8.
Json : Layer layer4.2.conv2, precision switch from w8a8 to w8a8.
Json : Layer layer4.2.conv3, precision switch from w8a8 to w8a8.
Json : Layer fc, precision switch from w8a8 to w8a8.
step 3: 
Layer conv1, precision switch from w8a8 to w8a8.
Layer layer1.0.conv1, precision switch from w8a8 to w8a8.
Layer layer1.0.conv2, precision switch from w8a8 to w8a8.
Layer layer1.0.conv3, precision switch from w8a8 to w8a8.
Layer layer1.0.downsample.0, precision switch from w8a8 to w8a8.
Layer layer1.1.conv1, precision switch from w8a8 to w8a8.
Layer layer1.1.conv2, precision switch from w8a8 to w8a8.
Layer layer1.1.conv3, precision switch from w8a8 to w8a8.
Layer layer1.2.conv1, precision switch from w8a8 to w8a8.
Layer layer1.2.conv2, precision switch from w8a8 to w8a8.
Layer layer1.2.conv3, precision switch from w8a8 to w8a8.
Layer layer2.0.conv1, precision switch from w8a8 to w8a8.
Layer layer2.0.conv2, precision switch from w8a8 to w8a8.
Layer layer2.0.conv3, precision switch from w8a8 to w8a8.
Layer layer2.0.downsample.0, precision switch from w8a8 to w8a8.
Layer layer2.1.conv1, precision switch from w8a8 to w8a8.
Layer layer2.1.conv2, precision switch from w8a8 to w8a8.
Layer layer2.1.conv3, precision switch from w8a8 to w8a8.
Layer layer2.2.conv1, precision switch from w8a8 to w8a8.
Layer layer2.2.conv2, precision switch from w8a8 to w8a8.
Layer layer2.2.conv3, precision switch from w8a8 to w8a8.
Layer layer2.3.conv1, precision switch from w8a8 to w8a8.
Layer layer2.3.conv2, precision switch from w8a8 to w8a8.
Layer layer2.3.conv3, precision switch from w8a8 to w8a8.
Layer layer3.0.conv1, precision switch from w8a8 to w8a8.
Layer layer3.0.conv2, precision switch from w8a8 to w8a8.
Layer layer3.0.conv3, precision switch from w8a8 to w8a8.
Layer layer3.0.downsample.0, precision switch from w8a8 to w8a8.
Layer layer3.1.conv1, precision switch from w8a8 to w8a8.
Layer layer3.1.conv2, precision switch from w8a8 to w8a8.
Layer layer3.1.conv3, precision switch from w8a8 to w8a8.
Layer layer3.2.conv1, precision switch from w8a8 to w8a8.
Layer layer3.2.conv2, precision switch from w8a8 to w8a8.
Layer layer3.2.conv3, precision switch from w8a8 to w8a8.
Layer layer3.3.conv1, precision switch from w8a8 to w8a8.
Layer layer3.3.conv2, precision switch from w8a8 to w8a8.
Layer layer3.3.conv3, precision switch from w8a8 to w8a8.
Layer layer3.4.conv1, precision switch from w8a8 to w8a8.
Layer layer3.4.conv2, precision switch from w8a8 to w8a8.
Layer layer3.4.conv3, precision switch from w8a8 to w8a8.
Layer layer3.5.conv1, precision switch from w8a8 to w8a8.
Layer layer3.5.conv2, precision switch from w8a8 to w8a8.
Layer layer3.5.conv3, precision switch from w8a8 to w8a8.
Layer layer4.0.conv1, precision switch from w8a8 to w8a8.
Layer layer4.0.conv2, precision switch from w8a8 to w8a8.
Layer layer4.0.conv3, precision switch from w8a8 to w8a8.
Layer layer4.0.downsample.0, precision switch from w8a8 to w8a8.
Layer layer4.1.conv1, precision switch from w8a8 to w8a8.
Layer layer4.1.conv2, precision switch from w8a8 to w8a8.
Layer layer4.1.conv3, precision switch from w8a8 to w8a8.
Layer layer4.2.conv1, precision switch from w8a8 to w8a8.
Layer layer4.2.conv2, precision switch from w8a8 to w8a8.
Layer layer4.2.conv3, precision switch from w8a8 to w8a8.
Layer fc, precision switch from w8a8 to w8a8.
Input/outputs cached

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.measure_perC.before_adaquant.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.measure_perC.before_adaquant.onnx
Bernard calculate float point model accuracy before enabling quantization!
Bernard calculate fixed point model accuracy before training!

Optimize 0:conv1 for w8a8 bit of shape torch.Size([64, 3, 7, 7])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 6.894176e-05
MSE after  adaquant: 3.584085e-05
layer layer1.0.conv1's input scale is updated
layer layer1.0.downsample.0's input scale is updated
 End of training layer  conv1 better/total layers= 1 / 1 


Optimize 1:layer1.0.conv1 for w8a8 bit of shape torch.Size([64, 64, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 8.952304e-05
MSE after  adaquant: 7.018115e-05
layer layer1.0.conv2's input scale is updated
 End of training layer  layer1.0.conv1 better/total layers= 2 / 2 


Optimize 2:layer1.0.conv2 for w8a8 bit of shape torch.Size([64, 64, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.393248e-05
MSE after  adaquant: 7.242925e-06
layer layer1.0.conv3's input scale is updated
 End of training layer  layer1.0.conv2 better/total layers= 3 / 3 


Optimize 3:layer1.0.conv3 for w8a8 bit of shape torch.Size([256, 64, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.680499e-05
MSE after  adaquant: 8.463949e-06
 End of training layer  layer1.0.conv3 better/total layers= 4 / 4 


Optimize 4:layer1.0.downsample.0 for w8a8 bit of shape torch.Size([256, 64, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.335342e-04
MSE after  adaquant: 1.161911e-04
 End of training layer  layer1.0.downsample.0 better/total layers= 5 / 5 


Optimize 5:layer1.1.conv1 for w8a8 bit of shape torch.Size([64, 256, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.752088e-05
MSE after  adaquant: 9.554663e-06
layer layer1.1.conv2's input scale is updated
 End of training layer  layer1.1.conv1 better/total layers= 6 / 6 


Optimize 6:layer1.1.conv2 for w8a8 bit of shape torch.Size([64, 64, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.208748e-05
MSE after  adaquant: 1.149543e-05
layer layer1.1.conv3's input scale is updated
 End of training layer  layer1.1.conv2 better/total layers= 7 / 7 


Optimize 7:layer1.1.conv3 for w8a8 bit of shape torch.Size([256, 64, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 9.330684e-06
MSE after  adaquant: 1.051855e-05
 End of training layer  layer1.1.conv3 better/total layers= 7 / 8 


Optimize 8:layer1.2.conv1 for w8a8 bit of shape torch.Size([64, 256, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.345095e-05
MSE after  adaquant: 8.256878e-06
layer layer1.2.conv2's input scale is updated
 End of training layer  layer1.2.conv1 better/total layers= 8 / 9 


Optimize 9:layer1.2.conv2 for w8a8 bit of shape torch.Size([64, 64, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 7.036676e-06
MSE after  adaquant: 1.440592e-05
layer layer1.2.conv3's input scale is updated
 End of training layer  layer1.2.conv2 better/total layers= 8 / 10 


Optimize 10:layer1.2.conv3 for w8a8 bit of shape torch.Size([256, 64, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.205502e-05
MSE after  adaquant: 1.820875e-05
 End of training layer  layer1.2.conv3 better/total layers= 9 / 11 


Optimize 11:layer2.0.conv1 for w8a8 bit of shape torch.Size([128, 256, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.914461e-05
MSE after  adaquant: 1.239370e-05
layer layer2.0.conv2's input scale is updated
 End of training layer  layer2.0.conv1 better/total layers= 10 / 12 


Optimize 12:layer2.0.conv2 for w8a8 bit of shape torch.Size([128, 128, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 5.826802e-06
MSE after  adaquant: 9.233429e-06
layer layer2.0.conv3's input scale is updated
 End of training layer  layer2.0.conv2 better/total layers= 10 / 13 


Optimize 13:layer2.0.conv3 for w8a8 bit of shape torch.Size([512, 128, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.104327e-05
MSE after  adaquant: 1.101977e-05
 End of training layer  layer2.0.conv3 better/total layers= 11 / 14 


Optimize 14:layer2.0.downsample.0 for w8a8 bit of shape torch.Size([512, 256, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.513706e-04
MSE after  adaquant: 1.305509e-04
 End of training layer  layer2.0.downsample.0 better/total layers= 12 / 15 


Optimize 15:layer2.1.conv1 for w8a8 bit of shape torch.Size([128, 512, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.773569e-05
MSE after  adaquant: 2.663812e-05
layer layer2.1.conv2's input scale is updated
 End of training layer  layer2.1.conv1 better/total layers= 13 / 16 


Optimize 16:layer2.1.conv2 for w8a8 bit of shape torch.Size([128, 128, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.763984e-04
MSE after  adaquant: 1.085995e-04
layer layer2.1.conv3's input scale is updated
 End of training layer  layer2.1.conv2 better/total layers= 14 / 17 


Optimize 17:layer2.1.conv3 for w8a8 bit of shape torch.Size([512, 128, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 7.283017e-05
MSE after  adaquant: 6.534543e-05
 End of training layer  layer2.1.conv3 better/total layers= 15 / 18 


Optimize 18:layer2.2.conv1 for w8a8 bit of shape torch.Size([128, 512, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.479386e-05
MSE after  adaquant: 1.201757e-05
layer layer2.2.conv2's input scale is updated
 End of training layer  layer2.2.conv1 better/total layers= 16 / 19 


Optimize 19:layer2.2.conv2 for w8a8 bit of shape torch.Size([128, 128, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 7.195886e-06
MSE after  adaquant: 9.046636e-06
layer layer2.2.conv3's input scale is updated
 End of training layer  layer2.2.conv2 better/total layers= 16 / 20 


Optimize 20:layer2.2.conv3 for w8a8 bit of shape torch.Size([512, 128, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 6.344233e-06
MSE after  adaquant: 6.041234e-06
 End of training layer  layer2.2.conv3 better/total layers= 17 / 21 


Optimize 21:layer2.3.conv1 for w8a8 bit of shape torch.Size([128, 512, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.095567e-05
MSE after  adaquant: 9.680135e-06
layer layer2.3.conv2's input scale is updated
 End of training layer  layer2.3.conv1 better/total layers= 18 / 22 


Optimize 22:layer2.3.conv2 for w8a8 bit of shape torch.Size([128, 128, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 5.561901e-06
MSE after  adaquant: 8.343331e-06
layer layer2.3.conv3's input scale is updated
 End of training layer  layer2.3.conv2 better/total layers= 18 / 23 


Optimize 23:layer2.3.conv3 for w8a8 bit of shape torch.Size([512, 128, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 5.850715e-06
MSE after  adaquant: 6.258571e-06
 End of training layer  layer2.3.conv3 better/total layers= 18 / 24 


Optimize 24:layer3.0.conv1 for w8a8 bit of shape torch.Size([256, 512, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.839897e-05
MSE after  adaquant: 2.338154e-05
layer layer3.0.conv2's input scale is updated
 End of training layer  layer3.0.conv1 better/total layers= 19 / 25 


Optimize 25:layer3.0.conv2 for w8a8 bit of shape torch.Size([256, 256, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.174706e-05
MSE after  adaquant: 1.133823e-05
layer layer3.0.conv3's input scale is updated
 End of training layer  layer3.0.conv2 better/total layers= 20 / 26 


Optimize 26:layer3.0.conv3 for w8a8 bit of shape torch.Size([1024, 256, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.176635e-05
MSE after  adaquant: 8.444254e-06
 End of training layer  layer3.0.conv3 better/total layers= 21 / 27 


Optimize 27:layer3.0.downsample.0 for w8a8 bit of shape torch.Size([1024, 512, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.104099e-05
MSE after  adaquant: 9.795317e-06
 End of training layer  layer3.0.downsample.0 better/total layers= 22 / 28 


Optimize 28:layer3.1.conv1 for w8a8 bit of shape torch.Size([256, 1024, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.992317e-06
MSE after  adaquant: 4.809876e-06
layer layer3.1.conv2's input scale is updated
 End of training layer  layer3.1.conv1 better/total layers= 23 / 29 


Optimize 29:layer3.1.conv2 for w8a8 bit of shape torch.Size([256, 256, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.018327e-05
MSE after  adaquant: 6.870624e-06
layer layer3.1.conv3's input scale is updated
 End of training layer  layer3.1.conv2 better/total layers= 24 / 30 


Optimize 30:layer3.1.conv3 for w8a8 bit of shape torch.Size([1024, 256, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.831730e-05
MSE after  adaquant: 1.609221e-05
 End of training layer  layer3.1.conv3 better/total layers= 25 / 31 


Optimize 31:layer3.2.conv1 for w8a8 bit of shape torch.Size([256, 1024, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.848526e-05
MSE after  adaquant: 1.185784e-05
layer layer3.2.conv2's input scale is updated
 End of training layer  layer3.2.conv1 better/total layers= 26 / 32 


Optimize 32:layer3.2.conv2 for w8a8 bit of shape torch.Size([256, 256, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.313799e-06
MSE after  adaquant: 2.767027e-06
layer layer3.2.conv3's input scale is updated
 End of training layer  layer3.2.conv2 better/total layers= 27 / 33 


Optimize 33:layer3.2.conv3 for w8a8 bit of shape torch.Size([1024, 256, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.840297e-06
MSE after  adaquant: 3.450709e-06
 End of training layer  layer3.2.conv3 better/total layers= 28 / 34 


Optimize 34:layer3.3.conv1 for w8a8 bit of shape torch.Size([256, 1024, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.538999e-05
MSE after  adaquant: 1.455085e-05
layer layer3.3.conv2's input scale is updated
 End of training layer  layer3.3.conv1 better/total layers= 29 / 35 


Optimize 35:layer3.3.conv2 for w8a8 bit of shape torch.Size([256, 256, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.121927e-06
MSE after  adaquant: 2.914983e-06
layer layer3.3.conv3's input scale is updated
 End of training layer  layer3.3.conv2 better/total layers= 30 / 36 


Optimize 36:layer3.3.conv3 for w8a8 bit of shape torch.Size([1024, 256, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 6.094047e-06
MSE after  adaquant: 5.286358e-06
 End of training layer  layer3.3.conv3 better/total layers= 31 / 37 


Optimize 37:layer3.4.conv1 for w8a8 bit of shape torch.Size([256, 1024, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 5.193723e-05
MSE after  adaquant: 2.800284e-05
layer layer3.4.conv2's input scale is updated
 End of training layer  layer3.4.conv1 better/total layers= 32 / 38 


Optimize 38:layer3.4.conv2 for w8a8 bit of shape torch.Size([256, 256, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.797995e-06
MSE after  adaquant: 3.589356e-06
layer layer3.4.conv3's input scale is updated
 End of training layer  layer3.4.conv2 better/total layers= 33 / 39 


Optimize 39:layer3.4.conv3 for w8a8 bit of shape torch.Size([1024, 256, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.644813e-05
MSE after  adaquant: 1.437187e-05
 End of training layer  layer3.4.conv3 better/total layers= 34 / 40 


Optimize 40:layer3.5.conv1 for w8a8 bit of shape torch.Size([256, 1024, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.051621e-04
MSE after  adaquant: 6.484700e-05
layer layer3.5.conv2's input scale is updated
 End of training layer  layer3.5.conv1 better/total layers= 35 / 41 


Optimize 41:layer3.5.conv2 for w8a8 bit of shape torch.Size([256, 256, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.015029e-05
MSE after  adaquant: 6.847268e-06
layer layer3.5.conv3's input scale is updated
 End of training layer  layer3.5.conv2 better/total layers= 36 / 42 


Optimize 42:layer3.5.conv3 for w8a8 bit of shape torch.Size([1024, 256, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.249019e-04
MSE after  adaquant: 1.041918e-04
 End of training layer  layer3.5.conv3 better/total layers= 37 / 43 


Optimize 43:layer4.0.conv1 for w8a8 bit of shape torch.Size([512, 1024, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.623014e-05
MSE after  adaquant: 1.195902e-05
layer layer4.0.conv2's input scale is updated
 End of training layer  layer4.0.conv1 better/total layers= 38 / 44 


Optimize 44:layer4.0.conv2 for w8a8 bit of shape torch.Size([512, 512, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 6.416613e-06
MSE after  adaquant: 4.571074e-06
layer layer4.0.conv3's input scale is updated
 End of training layer  layer4.0.conv2 better/total layers= 39 / 45 


Optimize 45:layer4.0.conv3 for w8a8 bit of shape torch.Size([2048, 512, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.703950e-04
MSE after  adaquant: 3.452569e-04
 End of training layer  layer4.0.conv3 better/total layers= 40 / 46 


Optimize 46:layer4.0.downsample.0 for w8a8 bit of shape torch.Size([2048, 1024, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.632684e-04
MSE after  adaquant: 1.495594e-04
 End of training layer  layer4.0.downsample.0 better/total layers= 41 / 47 


Optimize 47:layer4.1.conv1 for w8a8 bit of shape torch.Size([512, 2048, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.521364e-05
MSE after  adaquant: 8.140823e-06
layer layer4.1.conv2's input scale is updated
 End of training layer  layer4.1.conv1 better/total layers= 42 / 48 


Optimize 48:layer4.1.conv2 for w8a8 bit of shape torch.Size([512, 512, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 7.739873e-06
MSE after  adaquant: 6.413229e-06
layer layer4.1.conv3's input scale is updated
 End of training layer  layer4.1.conv2 better/total layers= 43 / 49 


Optimize 49:layer4.1.conv3 for w8a8 bit of shape torch.Size([2048, 512, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.996808e-04
MSE after  adaquant: 1.911059e-04
 End of training layer  layer4.1.conv3 better/total layers= 44 / 50 


Optimize 50:layer4.2.conv1 for w8a8 bit of shape torch.Size([512, 2048, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.145812e-05
MSE after  adaquant: 2.782805e-05
layer layer4.2.conv2's input scale is updated
 End of training layer  layer4.2.conv1 better/total layers= 45 / 51 


Optimize 51:layer4.2.conv2 for w8a8 bit of shape torch.Size([512, 512, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.078888e-05
MSE after  adaquant: 9.174657e-06
layer layer4.2.conv3's input scale is updated
 End of training layer  layer4.2.conv2 better/total layers= 46 / 52 


Optimize 52:layer4.2.conv3 for w8a8 bit of shape torch.Size([2048, 512, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 6.270983e-04
MSE after  adaquant: 5.932323e-04
 End of training layer  layer4.2.conv3 better/total layers= 47 / 53 


Optimize 53:fc for w8a8 bit of shape torch.Size([1000, 2048])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.953785e-03
MSE after  adaquant: 1.161112e-03
 End of training layer  fc better/total layers= 48 / 54 

step 4
Train: ########### All 8bit results ###########
Layer conv1, precision switch from w4a8 to w4a8.
Layer conv1, precision switch from w8a8 to w8a8.
finished 0 out of 54
Layer layer1.0.conv1, precision switch from w4a8 to w4a8.
Layer layer1.0.conv1, precision switch from w8a8 to w8a8.
finished 1 out of 54
Layer layer1.0.conv2, precision switch from w4a8 to w4a8.
Layer layer1.0.conv2, precision switch from w8a8 to w8a8.
finished 2 out of 54
Layer layer1.0.conv3, precision switch from w4a8 to w4a8.
Layer layer1.0.conv3, precision switch from w8a8 to w8a8.
finished 3 out of 54
Layer layer1.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer1.0.downsample.0, precision switch from w8a8 to w8a8.
finished 4 out of 54
Layer layer1.1.conv1, precision switch from w4a8 to w4a8.
Layer layer1.1.conv1, precision switch from w8a8 to w8a8.
finished 5 out of 54
Layer layer1.1.conv2, precision switch from w4a8 to w4a8.
Layer layer1.1.conv2, precision switch from w8a8 to w8a8.
finished 6 out of 54
Layer layer1.1.conv3, precision switch from w4a8 to w4a8.
Layer layer1.1.conv3, precision switch from w8a8 to w8a8.
finished 7 out of 54
Layer layer1.2.conv1, precision switch from w4a8 to w4a8.
Layer layer1.2.conv1, precision switch from w8a8 to w8a8.
finished 8 out of 54
Layer layer1.2.conv2, precision switch from w4a8 to w4a8.
Layer layer1.2.conv2, precision switch from w8a8 to w8a8.
finished 9 out of 54
Layer layer1.2.conv3, precision switch from w4a8 to w4a8.
Layer layer1.2.conv3, precision switch from w8a8 to w8a8.
finished 10 out of 54
Layer layer2.0.conv1, precision switch from w4a8 to w4a8.
Layer layer2.0.conv1, precision switch from w8a8 to w8a8.
finished 11 out of 54
Layer layer2.0.conv2, precision switch from w4a8 to w4a8.
Layer layer2.0.conv2, precision switch from w8a8 to w8a8.
finished 12 out of 54
Layer layer2.0.conv3, precision switch from w4a8 to w4a8.
Layer layer2.0.conv3, precision switch from w8a8 to w8a8.
finished 13 out of 54
Layer layer2.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer2.0.downsample.0, precision switch from w8a8 to w8a8.
finished 14 out of 54
Layer layer2.1.conv1, precision switch from w4a8 to w4a8.
Layer layer2.1.conv1, precision switch from w8a8 to w8a8.
finished 15 out of 54
Layer layer2.1.conv2, precision switch from w4a8 to w4a8.
Layer layer2.1.conv2, precision switch from w8a8 to w8a8.
finished 16 out of 54
Layer layer2.1.conv3, precision switch from w4a8 to w4a8.
Layer layer2.1.conv3, precision switch from w8a8 to w8a8.
finished 17 out of 54
Layer layer2.2.conv1, precision switch from w4a8 to w4a8.
Layer layer2.2.conv1, precision switch from w8a8 to w8a8.
finished 18 out of 54
Layer layer2.2.conv2, precision switch from w4a8 to w4a8.
Layer layer2.2.conv2, precision switch from w8a8 to w8a8.
finished 19 out of 54
Layer layer2.2.conv3, precision switch from w4a8 to w4a8.
Layer layer2.2.conv3, precision switch from w8a8 to w8a8.
finished 20 out of 54
Layer layer2.3.conv1, precision switch from w4a8 to w4a8.
Layer layer2.3.conv1, precision switch from w8a8 to w8a8.
finished 21 out of 54
Layer layer2.3.conv2, precision switch from w4a8 to w4a8.
Layer layer2.3.conv2, precision switch from w8a8 to w8a8.
finished 22 out of 54
Layer layer2.3.conv3, precision switch from w4a8 to w4a8.
Layer layer2.3.conv3, precision switch from w8a8 to w8a8.
finished 23 out of 54
Layer layer3.0.conv1, precision switch from w4a8 to w4a8.
Layer layer3.0.conv1, precision switch from w8a8 to w8a8.
finished 24 out of 54
Layer layer3.0.conv2, precision switch from w4a8 to w4a8.
Layer layer3.0.conv2, precision switch from w8a8 to w8a8.
finished 25 out of 54
Layer layer3.0.conv3, precision switch from w4a8 to w4a8.
Layer layer3.0.conv3, precision switch from w8a8 to w8a8.
finished 26 out of 54
Layer layer3.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer3.0.downsample.0, precision switch from w8a8 to w8a8.
finished 27 out of 54
Layer layer3.1.conv1, precision switch from w4a8 to w4a8.
Layer layer3.1.conv1, precision switch from w8a8 to w8a8.
finished 28 out of 54
Layer layer3.1.conv2, precision switch from w4a8 to w4a8.
Layer layer3.1.conv2, precision switch from w8a8 to w8a8.
finished 29 out of 54
Layer layer3.1.conv3, precision switch from w4a8 to w4a8.
Layer layer3.1.conv3, precision switch from w8a8 to w8a8.
finished 30 out of 54
Layer layer3.2.conv1, precision switch from w4a8 to w4a8.
Layer layer3.2.conv1, precision switch from w8a8 to w8a8.
finished 31 out of 54
Layer layer3.2.conv2, precision switch from w4a8 to w4a8.
Layer layer3.2.conv2, precision switch from w8a8 to w8a8.
finished 32 out of 54
Layer layer3.2.conv3, precision switch from w4a8 to w4a8.
Layer layer3.2.conv3, precision switch from w8a8 to w8a8.
finished 33 out of 54
Layer layer3.3.conv1, precision switch from w4a8 to w4a8.
Layer layer3.3.conv1, precision switch from w8a8 to w8a8.
finished 34 out of 54
Layer layer3.3.conv2, precision switch from w4a8 to w4a8.
Layer layer3.3.conv2, precision switch from w8a8 to w8a8.
finished 35 out of 54
Layer layer3.3.conv3, precision switch from w4a8 to w4a8.
Layer layer3.3.conv3, precision switch from w8a8 to w8a8.
finished 36 out of 54
Layer layer3.4.conv1, precision switch from w4a8 to w4a8.
Layer layer3.4.conv1, precision switch from w8a8 to w8a8.
finished 37 out of 54
Layer layer3.4.conv2, precision switch from w4a8 to w4a8.
Layer layer3.4.conv2, precision switch from w8a8 to w8a8.
finished 38 out of 54
Layer layer3.4.conv3, precision switch from w4a8 to w4a8.
Layer layer3.4.conv3, precision switch from w8a8 to w8a8.
finished 39 out of 54
Layer layer3.5.conv1, precision switch from w4a8 to w4a8.
Layer layer3.5.conv1, precision switch from w8a8 to w8a8.
finished 40 out of 54
Layer layer3.5.conv2, precision switch from w4a8 to w4a8.
Layer layer3.5.conv2, precision switch from w8a8 to w8a8.
finished 41 out of 54
Layer layer3.5.conv3, precision switch from w4a8 to w4a8.
Layer layer3.5.conv3, precision switch from w8a8 to w8a8.
finished 42 out of 54
Layer layer4.0.conv1, precision switch from w4a8 to w4a8.
Layer layer4.0.conv1, precision switch from w8a8 to w8a8.
finished 43 out of 54
Layer layer4.0.conv2, precision switch from w4a8 to w4a8.
Layer layer4.0.conv2, precision switch from w8a8 to w8a8.
finished 44 out of 54
Layer layer4.0.conv3, precision switch from w4a8 to w4a8.
Layer layer4.0.conv3, precision switch from w8a8 to w8a8.
finished 45 out of 54
Layer layer4.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer4.0.downsample.0, precision switch from w8a8 to w8a8.
finished 46 out of 54
Layer layer4.1.conv1, precision switch from w4a8 to w4a8.
Layer layer4.1.conv1, precision switch from w8a8 to w8a8.
finished 47 out of 54
Layer layer4.1.conv2, precision switch from w4a8 to w4a8.
Layer layer4.1.conv2, precision switch from w8a8 to w8a8.
finished 48 out of 54
Layer layer4.1.conv3, precision switch from w4a8 to w4a8.
Layer layer4.1.conv3, precision switch from w8a8 to w8a8.
finished 49 out of 54
Layer layer4.2.conv1, precision switch from w4a8 to w4a8.
Layer layer4.2.conv1, precision switch from w8a8 to w8a8.
finished 50 out of 54
Layer layer4.2.conv2, precision switch from w4a8 to w4a8.
Layer layer4.2.conv2, precision switch from w8a8 to w8a8.
finished 51 out of 54
Layer layer4.2.conv3, precision switch from w4a8 to w4a8.
Layer layer4.2.conv3, precision switch from w8a8 to w8a8.
finished 52 out of 54
Layer fc, precision switch from w4a8 to w4a8.
step 5
Found K = 41
Final Solution:  {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [4, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [4, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [4, 8], 'layer2.1.conv1': [4, 8], 'layer2.1.conv2': [4, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [4, 8], 'layer2.2.conv2': [4, 8], 'layer2.2.conv3': [4, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [4, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [4, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [4, 8], 'layer3.1.conv2': [4, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [4, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [4, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [4, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [4, 8], 'layer4.0.conv1': [4, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Policy:  ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Achieved compression:  0.1321497475533474
Expected acc:  1.0947336941585546
Params % in int 4 = 0.9428020195732207
Params % in int 8 = 0.057197980426779295
Layer conv1, precision switch from w4a8 to w4a8.
Layer layer1.0.conv1, precision switch from w4a8 to w4a8.
Layer layer1.0.conv2, precision switch from w4a8 to w4a8.
Layer layer1.0.conv3, precision switch from w4a8 to w4a8.
Layer layer1.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer1.1.conv1, precision switch from w4a8 to w4a8.
Layer layer1.1.conv2, precision switch from w4a8 to w4a8.
Layer layer1.1.conv3, precision switch from w4a8 to w4a8.
Layer layer1.2.conv1, precision switch from w4a8 to w4a8.
Layer layer1.2.conv2, precision switch from w4a8 to w4a8.
Layer layer1.2.conv3, precision switch from w4a8 to w4a8.
Layer layer2.0.conv1, precision switch from w4a8 to w4a8.
Layer layer2.0.conv2, precision switch from w4a8 to w4a8.
Layer layer2.0.conv3, precision switch from w4a8 to w4a8.
Layer layer2.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer2.1.conv1, precision switch from w4a8 to w4a8.
Layer layer2.1.conv2, precision switch from w4a8 to w4a8.
Layer layer2.1.conv3, precision switch from w4a8 to w4a8.
Layer layer2.2.conv1, precision switch from w4a8 to w4a8.
Layer layer2.2.conv2, precision switch from w4a8 to w4a8.
Layer layer2.2.conv3, precision switch from w4a8 to w4a8.
Layer layer2.3.conv1, precision switch from w4a8 to w4a8.
Layer layer2.3.conv2, precision switch from w4a8 to w4a8.
Layer layer2.3.conv3, precision switch from w4a8 to w4a8.
Layer layer3.0.conv1, precision switch from w4a8 to w4a8.
Layer layer3.0.conv2, precision switch from w4a8 to w4a8.
Layer layer3.0.conv3, precision switch from w4a8 to w4a8.
Layer layer3.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer3.1.conv1, precision switch from w4a8 to w4a8.
Layer layer3.1.conv2, precision switch from w4a8 to w4a8.
Layer layer3.1.conv3, precision switch from w4a8 to w4a8.
Layer layer3.2.conv1, precision switch from w4a8 to w4a8.
Layer layer3.2.conv2, precision switch from w4a8 to w4a8.
Layer layer3.2.conv3, precision switch from w4a8 to w4a8.
Layer layer3.3.conv1, precision switch from w4a8 to w4a8.
Layer layer3.3.conv2, precision switch from w4a8 to w4a8.
Layer layer3.3.conv3, precision switch from w4a8 to w4a8.
Layer layer3.4.conv1, precision switch from w4a8 to w4a8.
Layer layer3.4.conv2, precision switch from w4a8 to w4a8.
Layer layer3.4.conv3, precision switch from w4a8 to w4a8.
Layer layer3.5.conv1, precision switch from w4a8 to w4a8.
Layer layer3.5.conv2, precision switch from w4a8 to w4a8.
Layer layer3.5.conv3, precision switch from w4a8 to w4a8.
Layer layer4.0.conv1, precision switch from w4a8 to w4a8.
Layer layer4.0.conv2, precision switch from w4a8 to w4a8.
Layer layer4.0.conv3, precision switch from w4a8 to w4a8.
Layer layer4.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer4.1.conv1, precision switch from w4a8 to w4a8.
Layer layer4.1.conv2, precision switch from w4a8 to w4a8.
Layer layer4.1.conv3, precision switch from w4a8 to w4a8.
Layer layer4.2.conv1, precision switch from w4a8 to w4a8.
Layer layer4.2.conv2, precision switch from w4a8 to w4a8.
Layer layer4.2.conv3, precision switch from w4a8 to w4a8.
Layer fc, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/resnet50_w4a8.adaquant/resnet.absorb_bn.measure_perC.adaquant
Layer conv1, precision switch from w8a8 to w8a8.
switched layer conv1 to w8a8
Layer layer1.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv1 to w8a8
Layer layer1.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv2 to w8a8
Layer layer1.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv3 to w8a8
Layer layer1.0.downsample.0, precision switch from w8a8 to w8a8.
switched layer layer1.0.downsample.0 to w8a8
Layer layer1.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.1.conv1 to w8a8
Layer layer1.1.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.1.conv2 to w8a8
Layer layer1.1.conv3, precision switch from w4a8 to w4a8.
switched layer layer1.1.conv3 to w4a8
Layer layer1.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv1 to w8a8
Layer layer1.2.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv2 to w8a8
Layer layer1.2.conv3, precision switch from w4a8 to w4a8.
switched layer layer1.2.conv3 to w4a8
Layer layer2.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.0.conv1 to w8a8
Layer layer2.0.conv2, precision switch from w4a8 to w4a8.
switched layer layer2.0.conv2 to w4a8
Layer layer2.0.conv3, precision switch from w4a8 to w4a8.
switched layer layer2.0.conv3 to w4a8
Layer layer2.0.downsample.0, precision switch from w4a8 to w4a8.
switched layer layer2.0.downsample.0 to w4a8
Layer layer2.1.conv1, precision switch from w4a8 to w4a8.
switched layer layer2.1.conv1 to w4a8
Layer layer2.1.conv2, precision switch from w4a8 to w4a8.
switched layer layer2.1.conv2 to w4a8
Layer layer2.1.conv3, precision switch from w4a8 to w4a8.
switched layer layer2.1.conv3 to w4a8
Layer layer2.2.conv1, precision switch from w4a8 to w4a8.
switched layer layer2.2.conv1 to w4a8
Layer layer2.2.conv2, precision switch from w4a8 to w4a8.
switched layer layer2.2.conv2 to w4a8
Layer layer2.2.conv3, precision switch from w4a8 to w4a8.
switched layer layer2.2.conv3 to w4a8
Layer layer2.3.conv1, precision switch from w4a8 to w4a8.
switched layer layer2.3.conv1 to w4a8
Layer layer2.3.conv2, precision switch from w4a8 to w4a8.
switched layer layer2.3.conv2 to w4a8
Layer layer2.3.conv3, precision switch from w8a8 to w8a8.
switched layer layer2.3.conv3 to w8a8
Layer layer3.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.0.conv1 to w8a8
Layer layer3.0.conv2, precision switch from w4a8 to w4a8.
switched layer layer3.0.conv2 to w4a8
Layer layer3.0.conv3, precision switch from w4a8 to w4a8.
switched layer layer3.0.conv3 to w4a8
Layer layer3.0.downsample.0, precision switch from w4a8 to w4a8.
switched layer layer3.0.downsample.0 to w4a8
Layer layer3.1.conv1, precision switch from w4a8 to w4a8.
switched layer layer3.1.conv1 to w4a8
Layer layer3.1.conv2, precision switch from w4a8 to w4a8.
switched layer layer3.1.conv2 to w4a8
Layer layer3.1.conv3, precision switch from w4a8 to w4a8.
switched layer layer3.1.conv3 to w4a8
Layer layer3.2.conv1, precision switch from w4a8 to w4a8.
switched layer layer3.2.conv1 to w4a8
Layer layer3.2.conv2, precision switch from w4a8 to w4a8.
switched layer layer3.2.conv2 to w4a8
Layer layer3.2.conv3, precision switch from w4a8 to w4a8.
switched layer layer3.2.conv3 to w4a8
Layer layer3.3.conv1, precision switch from w4a8 to w4a8.
switched layer layer3.3.conv1 to w4a8
Layer layer3.3.conv2, precision switch from w4a8 to w4a8.
switched layer layer3.3.conv2 to w4a8
Layer layer3.3.conv3, precision switch from w4a8 to w4a8.
switched layer layer3.3.conv3 to w4a8
Layer layer3.4.conv1, precision switch from w4a8 to w4a8.
switched layer layer3.4.conv1 to w4a8
Layer layer3.4.conv2, precision switch from w4a8 to w4a8.
switched layer layer3.4.conv2 to w4a8
Layer layer3.4.conv3, precision switch from w4a8 to w4a8.
switched layer layer3.4.conv3 to w4a8
Layer layer3.5.conv1, precision switch from w4a8 to w4a8.
switched layer layer3.5.conv1 to w4a8
Layer layer3.5.conv2, precision switch from w4a8 to w4a8.
switched layer layer3.5.conv2 to w4a8
Layer layer3.5.conv3, precision switch from w4a8 to w4a8.
switched layer layer3.5.conv3 to w4a8
Layer layer4.0.conv1, precision switch from w4a8 to w4a8.
switched layer layer4.0.conv1 to w4a8
Layer layer4.0.conv2, precision switch from w4a8 to w4a8.
switched layer layer4.0.conv2 to w4a8
Layer layer4.0.conv3, precision switch from w4a8 to w4a8.
switched layer layer4.0.conv3 to w4a8
Layer layer4.0.downsample.0, precision switch from w4a8 to w4a8.
switched layer layer4.0.downsample.0 to w4a8
Layer layer4.1.conv1, precision switch from w4a8 to w4a8.
switched layer layer4.1.conv1 to w4a8
Layer layer4.1.conv2, precision switch from w4a8 to w4a8.
switched layer layer4.1.conv2 to w4a8
Layer layer4.1.conv3, precision switch from w4a8 to w4a8.
switched layer layer4.1.conv3 to w4a8
Layer layer4.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer4.2.conv1 to w8a8
Layer layer4.2.conv2, precision switch from w4a8 to w4a8.
switched layer layer4.2.conv2 to w4a8
Layer layer4.2.conv3, precision switch from w4a8 to w4a8.
switched layer layer4.2.conv3 to w4a8
Layer fc, precision switch from w4a8 to w4a8.
switched layer fc to w4a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.13_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.13_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.1321497475533474, expected loss 1.0947336941585546, actual acc 72.00000012207032, actual loss 1.0885665616989135
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [4, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [4, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [4, 8], 'layer2.1.conv1': [4, 8], 'layer2.1.conv2': [4, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [4, 8], 'layer2.2.conv2': [4, 8], 'layer2.2.conv3': [4, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [4, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [4, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [4, 8], 'layer3.1.conv2': [4, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [4, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [4, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [4, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [4, 8], 'layer4.0.conv1': [4, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Found K = 29
Final Solution:  {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [4, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [4, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [4, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [4, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [4, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Policy:  ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Achieved compression:  0.14243252349961294
Expected acc:  1.0426541119441988
Params % in int 4 = 0.8605398120030965
Params % in int 8 = 0.13946018799690352
Layer conv1, precision switch from w4a8 to w4a8.
Layer layer1.0.conv1, precision switch from w4a8 to w4a8.
Layer layer1.0.conv2, precision switch from w4a8 to w4a8.
Layer layer1.0.conv3, precision switch from w4a8 to w4a8.
Layer layer1.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer1.1.conv1, precision switch from w4a8 to w4a8.
Layer layer1.1.conv2, precision switch from w4a8 to w4a8.
Layer layer1.1.conv3, precision switch from w4a8 to w4a8.
Layer layer1.2.conv1, precision switch from w4a8 to w4a8.
Layer layer1.2.conv2, precision switch from w4a8 to w4a8.
Layer layer1.2.conv3, precision switch from w4a8 to w4a8.
Layer layer2.0.conv1, precision switch from w4a8 to w4a8.
Layer layer2.0.conv2, precision switch from w4a8 to w4a8.
Layer layer2.0.conv3, precision switch from w4a8 to w4a8.
Layer layer2.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer2.1.conv1, precision switch from w4a8 to w4a8.
Layer layer2.1.conv2, precision switch from w4a8 to w4a8.
Layer layer2.1.conv3, precision switch from w4a8 to w4a8.
Layer layer2.2.conv1, precision switch from w4a8 to w4a8.
Layer layer2.2.conv2, precision switch from w4a8 to w4a8.
Layer layer2.2.conv3, precision switch from w4a8 to w4a8.
Layer layer2.3.conv1, precision switch from w4a8 to w4a8.
Layer layer2.3.conv2, precision switch from w4a8 to w4a8.
Layer layer2.3.conv3, precision switch from w4a8 to w4a8.
Layer layer3.0.conv1, precision switch from w4a8 to w4a8.
Layer layer3.0.conv2, precision switch from w4a8 to w4a8.
Layer layer3.0.conv3, precision switch from w4a8 to w4a8.
Layer layer3.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer3.1.conv1, precision switch from w4a8 to w4a8.
Layer layer3.1.conv2, precision switch from w4a8 to w4a8.
Layer layer3.1.conv3, precision switch from w4a8 to w4a8.
Layer layer3.2.conv1, precision switch from w4a8 to w4a8.
Layer layer3.2.conv2, precision switch from w4a8 to w4a8.
Layer layer3.2.conv3, precision switch from w4a8 to w4a8.
Layer layer3.3.conv1, precision switch from w4a8 to w4a8.
Layer layer3.3.conv2, precision switch from w4a8 to w4a8.
Layer layer3.3.conv3, precision switch from w4a8 to w4a8.
Layer layer3.4.conv1, precision switch from w4a8 to w4a8.
Layer layer3.4.conv2, precision switch from w4a8 to w4a8.
Layer layer3.4.conv3, precision switch from w4a8 to w4a8.
Layer layer3.5.conv1, precision switch from w4a8 to w4a8.
Layer layer3.5.conv2, precision switch from w4a8 to w4a8.
Layer layer3.5.conv3, precision switch from w4a8 to w4a8.
Layer layer4.0.conv1, precision switch from w4a8 to w4a8.
Layer layer4.0.conv2, precision switch from w4a8 to w4a8.
Layer layer4.0.conv3, precision switch from w4a8 to w4a8.
Layer layer4.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer4.1.conv1, precision switch from w4a8 to w4a8.
Layer layer4.1.conv2, precision switch from w4a8 to w4a8.
Layer layer4.1.conv3, precision switch from w4a8 to w4a8.
Layer layer4.2.conv1, precision switch from w4a8 to w4a8.
Layer layer4.2.conv2, precision switch from w4a8 to w4a8.
Layer layer4.2.conv3, precision switch from w4a8 to w4a8.
Layer fc, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/resnet50_w4a8.adaquant/resnet.absorb_bn.measure_perC.adaquant
Layer conv1, precision switch from w8a8 to w8a8.
switched layer conv1 to w8a8
Layer layer1.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv1 to w8a8
Layer layer1.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv2 to w8a8
Layer layer1.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv3 to w8a8
Layer layer1.0.downsample.0, precision switch from w8a8 to w8a8.
switched layer layer1.0.downsample.0 to w8a8
Layer layer1.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.1.conv1 to w8a8
Layer layer1.1.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.1.conv2 to w8a8
Layer layer1.1.conv3, precision switch from w4a8 to w4a8.
switched layer layer1.1.conv3 to w4a8
Layer layer1.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv1 to w8a8
Layer layer1.2.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv2 to w8a8
Layer layer1.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv3 to w8a8
Layer layer2.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.0.conv1 to w8a8
Layer layer2.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.0.conv2 to w8a8
Layer layer2.0.conv3, precision switch from w4a8 to w4a8.
switched layer layer2.0.conv3 to w4a8
Layer layer2.0.downsample.0, precision switch from w8a8 to w8a8.
switched layer layer2.0.downsample.0 to w8a8
Layer layer2.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.1.conv1 to w8a8
Layer layer2.1.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.1.conv2 to w8a8
Layer layer2.1.conv3, precision switch from w4a8 to w4a8.
switched layer layer2.1.conv3 to w4a8
Layer layer2.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.2.conv1 to w8a8
Layer layer2.2.conv2, precision switch from w4a8 to w4a8.
switched layer layer2.2.conv2 to w4a8
Layer layer2.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer2.2.conv3 to w8a8
Layer layer2.3.conv1, precision switch from w4a8 to w4a8.
switched layer layer2.3.conv1 to w4a8
Layer layer2.3.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.3.conv2 to w8a8
Layer layer2.3.conv3, precision switch from w8a8 to w8a8.
switched layer layer2.3.conv3 to w8a8
Layer layer3.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.0.conv1 to w8a8
Layer layer3.0.conv2, precision switch from w4a8 to w4a8.
switched layer layer3.0.conv2 to w4a8
Layer layer3.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.0.conv3 to w8a8
Layer layer3.0.downsample.0, precision switch from w4a8 to w4a8.
switched layer layer3.0.downsample.0 to w4a8
Layer layer3.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.1.conv1 to w8a8
Layer layer3.1.conv2, precision switch from w4a8 to w4a8.
switched layer layer3.1.conv2 to w4a8
Layer layer3.1.conv3, precision switch from w4a8 to w4a8.
switched layer layer3.1.conv3 to w4a8
Layer layer3.2.conv1, precision switch from w4a8 to w4a8.
switched layer layer3.2.conv1 to w4a8
Layer layer3.2.conv2, precision switch from w4a8 to w4a8.
switched layer layer3.2.conv2 to w4a8
Layer layer3.2.conv3, precision switch from w4a8 to w4a8.
switched layer layer3.2.conv3 to w4a8
Layer layer3.3.conv1, precision switch from w4a8 to w4a8.
switched layer layer3.3.conv1 to w4a8
Layer layer3.3.conv2, precision switch from w4a8 to w4a8.
switched layer layer3.3.conv2 to w4a8
Layer layer3.3.conv3, precision switch from w4a8 to w4a8.
switched layer layer3.3.conv3 to w4a8
Layer layer3.4.conv1, precision switch from w4a8 to w4a8.
switched layer layer3.4.conv1 to w4a8
Layer layer3.4.conv2, precision switch from w4a8 to w4a8.
switched layer layer3.4.conv2 to w4a8
Layer layer3.4.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.4.conv3 to w8a8
Layer layer3.5.conv1, precision switch from w4a8 to w4a8.
switched layer layer3.5.conv1 to w4a8
Layer layer3.5.conv2, precision switch from w4a8 to w4a8.
switched layer layer3.5.conv2 to w4a8
Layer layer3.5.conv3, precision switch from w4a8 to w4a8.
switched layer layer3.5.conv3 to w4a8
Layer layer4.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer4.0.conv1 to w8a8
Layer layer4.0.conv2, precision switch from w4a8 to w4a8.
switched layer layer4.0.conv2 to w4a8
Layer layer4.0.conv3, precision switch from w4a8 to w4a8.
switched layer layer4.0.conv3 to w4a8
Layer layer4.0.downsample.0, precision switch from w4a8 to w4a8.
switched layer layer4.0.downsample.0 to w4a8
Layer layer4.1.conv1, precision switch from w4a8 to w4a8.
switched layer layer4.1.conv1 to w4a8
Layer layer4.1.conv2, precision switch from w4a8 to w4a8.
switched layer layer4.1.conv2 to w4a8
Layer layer4.1.conv3, precision switch from w4a8 to w4a8.
switched layer layer4.1.conv3 to w4a8
Layer layer4.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer4.2.conv1 to w8a8
Layer layer4.2.conv2, precision switch from w4a8 to w4a8.
switched layer layer4.2.conv2 to w4a8
Layer layer4.2.conv3, precision switch from w4a8 to w4a8.
switched layer layer4.2.conv3 to w4a8
Layer fc, precision switch from w4a8 to w4a8.
switched layer fc to w4a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.14_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.14_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.1321497475533474, expected loss 1.0947336941585546, actual acc 72.00000012207032, actual loss 1.0885665616989135
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [4, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [4, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [4, 8], 'layer2.1.conv1': [4, 8], 'layer2.1.conv2': [4, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [4, 8], 'layer2.2.conv2': [4, 8], 'layer2.2.conv3': [4, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [4, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [4, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [4, 8], 'layer3.1.conv2': [4, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [4, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [4, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [4, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [4, 8], 'layer4.0.conv1': [4, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14243252349961294, expected loss 1.0426541119441988, actual acc 74.19999981689453, actual loss 1.017282751083374
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [4, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [4, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [4, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [4, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [4, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Found K = 24
Final Solution:  {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Policy:  ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Achieved compression:  0.15151028663967547
Expected acc:  1.0241225868091584
Params % in int 4 = 0.7879177068825962
Params % in int 8 = 0.21208229311740381
Layer conv1, precision switch from w4a8 to w4a8.
Layer layer1.0.conv1, precision switch from w4a8 to w4a8.
Layer layer1.0.conv2, precision switch from w4a8 to w4a8.
Layer layer1.0.conv3, precision switch from w4a8 to w4a8.
Layer layer1.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer1.1.conv1, precision switch from w4a8 to w4a8.
Layer layer1.1.conv2, precision switch from w4a8 to w4a8.
Layer layer1.1.conv3, precision switch from w4a8 to w4a8.
Layer layer1.2.conv1, precision switch from w4a8 to w4a8.
Layer layer1.2.conv2, precision switch from w4a8 to w4a8.
Layer layer1.2.conv3, precision switch from w4a8 to w4a8.
Layer layer2.0.conv1, precision switch from w4a8 to w4a8.
Layer layer2.0.conv2, precision switch from w4a8 to w4a8.
Layer layer2.0.conv3, precision switch from w4a8 to w4a8.
Layer layer2.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer2.1.conv1, precision switch from w4a8 to w4a8.
Layer layer2.1.conv2, precision switch from w4a8 to w4a8.
Layer layer2.1.conv3, precision switch from w4a8 to w4a8.
Layer layer2.2.conv1, precision switch from w4a8 to w4a8.
Layer layer2.2.conv2, precision switch from w4a8 to w4a8.
Layer layer2.2.conv3, precision switch from w4a8 to w4a8.
Layer layer2.3.conv1, precision switch from w4a8 to w4a8.
Layer layer2.3.conv2, precision switch from w4a8 to w4a8.
Layer layer2.3.conv3, precision switch from w4a8 to w4a8.
Layer layer3.0.conv1, precision switch from w4a8 to w4a8.
Layer layer3.0.conv2, precision switch from w4a8 to w4a8.
Layer layer3.0.conv3, precision switch from w4a8 to w4a8.
Layer layer3.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer3.1.conv1, precision switch from w4a8 to w4a8.
Layer layer3.1.conv2, precision switch from w4a8 to w4a8.
Layer layer3.1.conv3, precision switch from w4a8 to w4a8.
Layer layer3.2.conv1, precision switch from w4a8 to w4a8.
Layer layer3.2.conv2, precision switch from w4a8 to w4a8.
Layer layer3.2.conv3, precision switch from w4a8 to w4a8.
Layer layer3.3.conv1, precision switch from w4a8 to w4a8.
Layer layer3.3.conv2, precision switch from w4a8 to w4a8.
Layer layer3.3.conv3, precision switch from w4a8 to w4a8.
Layer layer3.4.conv1, precision switch from w4a8 to w4a8.
Layer layer3.4.conv2, precision switch from w4a8 to w4a8.
Layer layer3.4.conv3, precision switch from w4a8 to w4a8.
Layer layer3.5.conv1, precision switch from w4a8 to w4a8.
Layer layer3.5.conv2, precision switch from w4a8 to w4a8.
Layer layer3.5.conv3, precision switch from w4a8 to w4a8.
Layer layer4.0.conv1, precision switch from w4a8 to w4a8.
Layer layer4.0.conv2, precision switch from w4a8 to w4a8.
Layer layer4.0.conv3, precision switch from w4a8 to w4a8.
Layer layer4.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer4.1.conv1, precision switch from w4a8 to w4a8.
Layer layer4.1.conv2, precision switch from w4a8 to w4a8.
Layer layer4.1.conv3, precision switch from w4a8 to w4a8.
Layer layer4.2.conv1, precision switch from w4a8 to w4a8.
Layer layer4.2.conv2, precision switch from w4a8 to w4a8.
Layer layer4.2.conv3, precision switch from w4a8 to w4a8.
Layer fc, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/resnet50_w4a8.adaquant/resnet.absorb_bn.measure_perC.adaquant
Layer conv1, precision switch from w8a8 to w8a8.
switched layer conv1 to w8a8
Layer layer1.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv1 to w8a8
Layer layer1.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv2 to w8a8
Layer layer1.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv3 to w8a8
Layer layer1.0.downsample.0, precision switch from w8a8 to w8a8.
switched layer layer1.0.downsample.0 to w8a8
Layer layer1.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.1.conv1 to w8a8
Layer layer1.1.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.1.conv2 to w8a8
Layer layer1.1.conv3, precision switch from w4a8 to w4a8.
switched layer layer1.1.conv3 to w4a8
Layer layer1.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv1 to w8a8
Layer layer1.2.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv2 to w8a8
Layer layer1.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv3 to w8a8
Layer layer2.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.0.conv1 to w8a8
Layer layer2.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.0.conv2 to w8a8
Layer layer2.0.conv3, precision switch from w4a8 to w4a8.
switched layer layer2.0.conv3 to w4a8
Layer layer2.0.downsample.0, precision switch from w8a8 to w8a8.
switched layer layer2.0.downsample.0 to w8a8
Layer layer2.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.1.conv1 to w8a8
Layer layer2.1.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.1.conv2 to w8a8
Layer layer2.1.conv3, precision switch from w4a8 to w4a8.
switched layer layer2.1.conv3 to w4a8
Layer layer2.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.2.conv1 to w8a8
Layer layer2.2.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.2.conv2 to w8a8
Layer layer2.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer2.2.conv3 to w8a8
Layer layer2.3.conv1, precision switch from w4a8 to w4a8.
switched layer layer2.3.conv1 to w4a8
Layer layer2.3.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.3.conv2 to w8a8
Layer layer2.3.conv3, precision switch from w8a8 to w8a8.
switched layer layer2.3.conv3 to w8a8
Layer layer3.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.0.conv1 to w8a8
Layer layer3.0.conv2, precision switch from w4a8 to w4a8.
switched layer layer3.0.conv2 to w4a8
Layer layer3.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.0.conv3 to w8a8
Layer layer3.0.downsample.0, precision switch from w4a8 to w4a8.
switched layer layer3.0.downsample.0 to w4a8
Layer layer3.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.1.conv1 to w8a8
Layer layer3.1.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.1.conv2 to w8a8
Layer layer3.1.conv3, precision switch from w4a8 to w4a8.
switched layer layer3.1.conv3 to w4a8
Layer layer3.2.conv1, precision switch from w4a8 to w4a8.
switched layer layer3.2.conv1 to w4a8
Layer layer3.2.conv2, precision switch from w4a8 to w4a8.
switched layer layer3.2.conv2 to w4a8
Layer layer3.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.2.conv3 to w8a8
Layer layer3.3.conv1, precision switch from w4a8 to w4a8.
switched layer layer3.3.conv1 to w4a8
Layer layer3.3.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.3.conv2 to w8a8
Layer layer3.3.conv3, precision switch from w4a8 to w4a8.
switched layer layer3.3.conv3 to w4a8
Layer layer3.4.conv1, precision switch from w4a8 to w4a8.
switched layer layer3.4.conv1 to w4a8
Layer layer3.4.conv2, precision switch from w4a8 to w4a8.
switched layer layer3.4.conv2 to w4a8
Layer layer3.4.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.4.conv3 to w8a8
Layer layer3.5.conv1, precision switch from w4a8 to w4a8.
switched layer layer3.5.conv1 to w4a8
Layer layer3.5.conv2, precision switch from w4a8 to w4a8.
switched layer layer3.5.conv2 to w4a8
Layer layer3.5.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.5.conv3 to w8a8
Layer layer4.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer4.0.conv1 to w8a8
Layer layer4.0.conv2, precision switch from w4a8 to w4a8.
switched layer layer4.0.conv2 to w4a8
Layer layer4.0.conv3, precision switch from w4a8 to w4a8.
switched layer layer4.0.conv3 to w4a8
Layer layer4.0.downsample.0, precision switch from w4a8 to w4a8.
switched layer layer4.0.downsample.0 to w4a8
Layer layer4.1.conv1, precision switch from w4a8 to w4a8.
switched layer layer4.1.conv1 to w4a8
Layer layer4.1.conv2, precision switch from w4a8 to w4a8.
switched layer layer4.1.conv2 to w4a8
Layer layer4.1.conv3, precision switch from w4a8 to w4a8.
switched layer layer4.1.conv3 to w4a8
Layer layer4.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer4.2.conv1 to w8a8
Layer layer4.2.conv2, precision switch from w4a8 to w4a8.
switched layer layer4.2.conv2 to w4a8
Layer layer4.2.conv3, precision switch from w4a8 to w4a8.
switched layer layer4.2.conv3 to w4a8
Layer fc, precision switch from w4a8 to w4a8.
switched layer fc to w4a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.15_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.15_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.1321497475533474, expected loss 1.0947336941585546, actual acc 72.00000012207032, actual loss 1.0885665616989135
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [4, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [4, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [4, 8], 'layer2.1.conv1': [4, 8], 'layer2.1.conv2': [4, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [4, 8], 'layer2.2.conv2': [4, 8], 'layer2.2.conv3': [4, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [4, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [4, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [4, 8], 'layer3.1.conv2': [4, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [4, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [4, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [4, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [4, 8], 'layer4.0.conv1': [4, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14243252349961294, expected loss 1.0426541119441988, actual acc 74.19999981689453, actual loss 1.017282751083374
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [4, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [4, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [4, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [4, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [4, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.15151028663967547, expected loss 1.0241225868091584, actual acc 75.60000042724609, actual loss 0.9947649512290955
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Found K = 21
Final Solution:  {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Policy:  ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Achieved compression:  0.16468509332082817
Expected acc:  1.008980658613205
Params % in int 4 = 0.6825192534333745
Params % in int 8 = 0.3174807465666255
Layer conv1, precision switch from w4a8 to w4a8.
Layer layer1.0.conv1, precision switch from w4a8 to w4a8.
Layer layer1.0.conv2, precision switch from w4a8 to w4a8.
Layer layer1.0.conv3, precision switch from w4a8 to w4a8.
Layer layer1.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer1.1.conv1, precision switch from w4a8 to w4a8.
Layer layer1.1.conv2, precision switch from w4a8 to w4a8.
Layer layer1.1.conv3, precision switch from w4a8 to w4a8.
Layer layer1.2.conv1, precision switch from w4a8 to w4a8.
Layer layer1.2.conv2, precision switch from w4a8 to w4a8.
Layer layer1.2.conv3, precision switch from w4a8 to w4a8.
Layer layer2.0.conv1, precision switch from w4a8 to w4a8.
Layer layer2.0.conv2, precision switch from w4a8 to w4a8.
Layer layer2.0.conv3, precision switch from w4a8 to w4a8.
Layer layer2.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer2.1.conv1, precision switch from w4a8 to w4a8.
Layer layer2.1.conv2, precision switch from w4a8 to w4a8.
Layer layer2.1.conv3, precision switch from w4a8 to w4a8.
Layer layer2.2.conv1, precision switch from w4a8 to w4a8.
Layer layer2.2.conv2, precision switch from w4a8 to w4a8.
Layer layer2.2.conv3, precision switch from w4a8 to w4a8.
Layer layer2.3.conv1, precision switch from w4a8 to w4a8.
Layer layer2.3.conv2, precision switch from w4a8 to w4a8.
Layer layer2.3.conv3, precision switch from w4a8 to w4a8.
Layer layer3.0.conv1, precision switch from w4a8 to w4a8.
Layer layer3.0.conv2, precision switch from w4a8 to w4a8.
Layer layer3.0.conv3, precision switch from w4a8 to w4a8.
Layer layer3.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer3.1.conv1, precision switch from w4a8 to w4a8.
Layer layer3.1.conv2, precision switch from w4a8 to w4a8.
Layer layer3.1.conv3, precision switch from w4a8 to w4a8.
Layer layer3.2.conv1, precision switch from w4a8 to w4a8.
Layer layer3.2.conv2, precision switch from w4a8 to w4a8.
Layer layer3.2.conv3, precision switch from w4a8 to w4a8.
Layer layer3.3.conv1, precision switch from w4a8 to w4a8.
Layer layer3.3.conv2, precision switch from w4a8 to w4a8.
Layer layer3.3.conv3, precision switch from w4a8 to w4a8.
Layer layer3.4.conv1, precision switch from w4a8 to w4a8.
Layer layer3.4.conv2, precision switch from w4a8 to w4a8.
Layer layer3.4.conv3, precision switch from w4a8 to w4a8.
Layer layer3.5.conv1, precision switch from w4a8 to w4a8.
Layer layer3.5.conv2, precision switch from w4a8 to w4a8.
Layer layer3.5.conv3, precision switch from w4a8 to w4a8.
Layer layer4.0.conv1, precision switch from w4a8 to w4a8.
Layer layer4.0.conv2, precision switch from w4a8 to w4a8.
Layer layer4.0.conv3, precision switch from w4a8 to w4a8.
Layer layer4.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer4.1.conv1, precision switch from w4a8 to w4a8.
Layer layer4.1.conv2, precision switch from w4a8 to w4a8.
Layer layer4.1.conv3, precision switch from w4a8 to w4a8.
Layer layer4.2.conv1, precision switch from w4a8 to w4a8.
Layer layer4.2.conv2, precision switch from w4a8 to w4a8.
Layer layer4.2.conv3, precision switch from w4a8 to w4a8.
Layer fc, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/resnet50_w4a8.adaquant/resnet.absorb_bn.measure_perC.adaquant
Layer conv1, precision switch from w8a8 to w8a8.
switched layer conv1 to w8a8
Layer layer1.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv1 to w8a8
Layer layer1.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv2 to w8a8
Layer layer1.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv3 to w8a8
Layer layer1.0.downsample.0, precision switch from w8a8 to w8a8.
switched layer layer1.0.downsample.0 to w8a8
Layer layer1.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.1.conv1 to w8a8
Layer layer1.1.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.1.conv2 to w8a8
Layer layer1.1.conv3, precision switch from w4a8 to w4a8.
switched layer layer1.1.conv3 to w4a8
Layer layer1.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv1 to w8a8
Layer layer1.2.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv2 to w8a8
Layer layer1.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv3 to w8a8
Layer layer2.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.0.conv1 to w8a8
Layer layer2.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.0.conv2 to w8a8
Layer layer2.0.conv3, precision switch from w4a8 to w4a8.
switched layer layer2.0.conv3 to w4a8
Layer layer2.0.downsample.0, precision switch from w8a8 to w8a8.
switched layer layer2.0.downsample.0 to w8a8
Layer layer2.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.1.conv1 to w8a8
Layer layer2.1.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.1.conv2 to w8a8
Layer layer2.1.conv3, precision switch from w4a8 to w4a8.
switched layer layer2.1.conv3 to w4a8
Layer layer2.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.2.conv1 to w8a8
Layer layer2.2.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.2.conv2 to w8a8
Layer layer2.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer2.2.conv3 to w8a8
Layer layer2.3.conv1, precision switch from w4a8 to w4a8.
switched layer layer2.3.conv1 to w4a8
Layer layer2.3.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.3.conv2 to w8a8
Layer layer2.3.conv3, precision switch from w8a8 to w8a8.
switched layer layer2.3.conv3 to w8a8
Layer layer3.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.0.conv1 to w8a8
Layer layer3.0.conv2, precision switch from w4a8 to w4a8.
switched layer layer3.0.conv2 to w4a8
Layer layer3.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.0.conv3 to w8a8
Layer layer3.0.downsample.0, precision switch from w4a8 to w4a8.
switched layer layer3.0.downsample.0 to w4a8
Layer layer3.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.1.conv1 to w8a8
Layer layer3.1.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.1.conv2 to w8a8
Layer layer3.1.conv3, precision switch from w4a8 to w4a8.
switched layer layer3.1.conv3 to w4a8
Layer layer3.2.conv1, precision switch from w4a8 to w4a8.
switched layer layer3.2.conv1 to w4a8
Layer layer3.2.conv2, precision switch from w4a8 to w4a8.
switched layer layer3.2.conv2 to w4a8
Layer layer3.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.2.conv3 to w8a8
Layer layer3.3.conv1, precision switch from w4a8 to w4a8.
switched layer layer3.3.conv1 to w4a8
Layer layer3.3.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.3.conv2 to w8a8
Layer layer3.3.conv3, precision switch from w4a8 to w4a8.
switched layer layer3.3.conv3 to w4a8
Layer layer3.4.conv1, precision switch from w4a8 to w4a8.
switched layer layer3.4.conv1 to w4a8
Layer layer3.4.conv2, precision switch from w4a8 to w4a8.
switched layer layer3.4.conv2 to w4a8
Layer layer3.4.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.4.conv3 to w8a8
Layer layer3.5.conv1, precision switch from w4a8 to w4a8.
switched layer layer3.5.conv1 to w4a8
Layer layer3.5.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.5.conv2 to w8a8
Layer layer3.5.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.5.conv3 to w8a8
Layer layer4.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer4.0.conv1 to w8a8
Layer layer4.0.conv2, precision switch from w4a8 to w4a8.
switched layer layer4.0.conv2 to w4a8
Layer layer4.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer4.0.conv3 to w8a8
Layer layer4.0.downsample.0, precision switch from w4a8 to w4a8.
switched layer layer4.0.downsample.0 to w4a8
Layer layer4.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer4.1.conv1 to w8a8
Layer layer4.1.conv2, precision switch from w4a8 to w4a8.
switched layer layer4.1.conv2 to w4a8
Layer layer4.1.conv3, precision switch from w4a8 to w4a8.
switched layer layer4.1.conv3 to w4a8
Layer layer4.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer4.2.conv1 to w8a8
Layer layer4.2.conv2, precision switch from w4a8 to w4a8.
switched layer layer4.2.conv2 to w4a8
Layer layer4.2.conv3, precision switch from w4a8 to w4a8.
switched layer layer4.2.conv3 to w4a8
Layer fc, precision switch from w4a8 to w4a8.
switched layer fc to w4a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.16_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.16_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.1321497475533474, expected loss 1.0947336941585546, actual acc 72.00000012207032, actual loss 1.0885665616989135
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [4, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [4, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [4, 8], 'layer2.1.conv1': [4, 8], 'layer2.1.conv2': [4, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [4, 8], 'layer2.2.conv2': [4, 8], 'layer2.2.conv3': [4, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [4, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [4, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [4, 8], 'layer3.1.conv2': [4, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [4, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [4, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [4, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [4, 8], 'layer4.0.conv1': [4, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14243252349961294, expected loss 1.0426541119441988, actual acc 74.19999981689453, actual loss 1.017282751083374
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [4, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [4, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [4, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [4, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [4, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.15151028663967547, expected loss 1.0241225868091584, actual acc 75.60000042724609, actual loss 0.9947649512290955
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16468509332082817, expected loss 1.008980658613205, actual acc 75.50000042724609, actual loss 0.968271390914917
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Found K = 18
Final Solution:  {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Policy:  ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Achieved compression:  0.17014781804228174
Expected acc:  1.003960534893036
Params % in int 4 = 0.638817455661746
Params % in int 8 = 0.361182544338254
Layer conv1, precision switch from w4a8 to w4a8.
Layer layer1.0.conv1, precision switch from w4a8 to w4a8.
Layer layer1.0.conv2, precision switch from w4a8 to w4a8.
Layer layer1.0.conv3, precision switch from w4a8 to w4a8.
Layer layer1.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer1.1.conv1, precision switch from w4a8 to w4a8.
Layer layer1.1.conv2, precision switch from w4a8 to w4a8.
Layer layer1.1.conv3, precision switch from w4a8 to w4a8.
Layer layer1.2.conv1, precision switch from w4a8 to w4a8.
Layer layer1.2.conv2, precision switch from w4a8 to w4a8.
Layer layer1.2.conv3, precision switch from w4a8 to w4a8.
Layer layer2.0.conv1, precision switch from w4a8 to w4a8.
Layer layer2.0.conv2, precision switch from w4a8 to w4a8.
Layer layer2.0.conv3, precision switch from w4a8 to w4a8.
Layer layer2.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer2.1.conv1, precision switch from w4a8 to w4a8.
Layer layer2.1.conv2, precision switch from w4a8 to w4a8.
Layer layer2.1.conv3, precision switch from w4a8 to w4a8.
Layer layer2.2.conv1, precision switch from w4a8 to w4a8.
Layer layer2.2.conv2, precision switch from w4a8 to w4a8.
Layer layer2.2.conv3, precision switch from w4a8 to w4a8.
Layer layer2.3.conv1, precision switch from w4a8 to w4a8.
Layer layer2.3.conv2, precision switch from w4a8 to w4a8.
Layer layer2.3.conv3, precision switch from w4a8 to w4a8.
Layer layer3.0.conv1, precision switch from w4a8 to w4a8.
Layer layer3.0.conv2, precision switch from w4a8 to w4a8.
Layer layer3.0.conv3, precision switch from w4a8 to w4a8.
Layer layer3.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer3.1.conv1, precision switch from w4a8 to w4a8.
Layer layer3.1.conv2, precision switch from w4a8 to w4a8.
Layer layer3.1.conv3, precision switch from w4a8 to w4a8.
Layer layer3.2.conv1, precision switch from w4a8 to w4a8.
Layer layer3.2.conv2, precision switch from w4a8 to w4a8.
Layer layer3.2.conv3, precision switch from w4a8 to w4a8.
Layer layer3.3.conv1, precision switch from w4a8 to w4a8.
Layer layer3.3.conv2, precision switch from w4a8 to w4a8.
Layer layer3.3.conv3, precision switch from w4a8 to w4a8.
Layer layer3.4.conv1, precision switch from w4a8 to w4a8.
Layer layer3.4.conv2, precision switch from w4a8 to w4a8.
Layer layer3.4.conv3, precision switch from w4a8 to w4a8.
Layer layer3.5.conv1, precision switch from w4a8 to w4a8.
Layer layer3.5.conv2, precision switch from w4a8 to w4a8.
Layer layer3.5.conv3, precision switch from w4a8 to w4a8.
Layer layer4.0.conv1, precision switch from w4a8 to w4a8.
Layer layer4.0.conv2, precision switch from w4a8 to w4a8.
Layer layer4.0.conv3, precision switch from w4a8 to w4a8.
Layer layer4.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer4.1.conv1, precision switch from w4a8 to w4a8.
Layer layer4.1.conv2, precision switch from w4a8 to w4a8.
Layer layer4.1.conv3, precision switch from w4a8 to w4a8.
Layer layer4.2.conv1, precision switch from w4a8 to w4a8.
Layer layer4.2.conv2, precision switch from w4a8 to w4a8.
Layer layer4.2.conv3, precision switch from w4a8 to w4a8.
Layer fc, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/resnet50_w4a8.adaquant/resnet.absorb_bn.measure_perC.adaquant
Layer conv1, precision switch from w8a8 to w8a8.
switched layer conv1 to w8a8
Layer layer1.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv1 to w8a8
Layer layer1.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv2 to w8a8
Layer layer1.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv3 to w8a8
Layer layer1.0.downsample.0, precision switch from w8a8 to w8a8.
switched layer layer1.0.downsample.0 to w8a8
Layer layer1.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.1.conv1 to w8a8
Layer layer1.1.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.1.conv2 to w8a8
Layer layer1.1.conv3, precision switch from w4a8 to w4a8.
switched layer layer1.1.conv3 to w4a8
Layer layer1.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv1 to w8a8
Layer layer1.2.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv2 to w8a8
Layer layer1.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv3 to w8a8
Layer layer2.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.0.conv1 to w8a8
Layer layer2.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.0.conv2 to w8a8
Layer layer2.0.conv3, precision switch from w4a8 to w4a8.
switched layer layer2.0.conv3 to w4a8
Layer layer2.0.downsample.0, precision switch from w8a8 to w8a8.
switched layer layer2.0.downsample.0 to w8a8
Layer layer2.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.1.conv1 to w8a8
Layer layer2.1.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.1.conv2 to w8a8
Layer layer2.1.conv3, precision switch from w4a8 to w4a8.
switched layer layer2.1.conv3 to w4a8
Layer layer2.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.2.conv1 to w8a8
Layer layer2.2.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.2.conv2 to w8a8
Layer layer2.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer2.2.conv3 to w8a8
Layer layer2.3.conv1, precision switch from w4a8 to w4a8.
switched layer layer2.3.conv1 to w4a8
Layer layer2.3.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.3.conv2 to w8a8
Layer layer2.3.conv3, precision switch from w8a8 to w8a8.
switched layer layer2.3.conv3 to w8a8
Layer layer3.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.0.conv1 to w8a8
Layer layer3.0.conv2, precision switch from w4a8 to w4a8.
switched layer layer3.0.conv2 to w4a8
Layer layer3.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.0.conv3 to w8a8
Layer layer3.0.downsample.0, precision switch from w4a8 to w4a8.
switched layer layer3.0.downsample.0 to w4a8
Layer layer3.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.1.conv1 to w8a8
Layer layer3.1.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.1.conv2 to w8a8
Layer layer3.1.conv3, precision switch from w4a8 to w4a8.
switched layer layer3.1.conv3 to w4a8
Layer layer3.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.2.conv1 to w8a8
Layer layer3.2.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.2.conv2 to w8a8
Layer layer3.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.2.conv3 to w8a8
Layer layer3.3.conv1, precision switch from w4a8 to w4a8.
switched layer layer3.3.conv1 to w4a8
Layer layer3.3.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.3.conv2 to w8a8
Layer layer3.3.conv3, precision switch from w4a8 to w4a8.
switched layer layer3.3.conv3 to w4a8
Layer layer3.4.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.4.conv1 to w8a8
Layer layer3.4.conv2, precision switch from w4a8 to w4a8.
switched layer layer3.4.conv2 to w4a8
Layer layer3.4.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.4.conv3 to w8a8
Layer layer3.5.conv1, precision switch from w4a8 to w4a8.
switched layer layer3.5.conv1 to w4a8
Layer layer3.5.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.5.conv2 to w8a8
Layer layer3.5.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.5.conv3 to w8a8
Layer layer4.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer4.0.conv1 to w8a8
Layer layer4.0.conv2, precision switch from w4a8 to w4a8.
switched layer layer4.0.conv2 to w4a8
Layer layer4.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer4.0.conv3 to w8a8
Layer layer4.0.downsample.0, precision switch from w4a8 to w4a8.
switched layer layer4.0.downsample.0 to w4a8
Layer layer4.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer4.1.conv1 to w8a8
Layer layer4.1.conv2, precision switch from w4a8 to w4a8.
switched layer layer4.1.conv2 to w4a8
Layer layer4.1.conv3, precision switch from w4a8 to w4a8.
switched layer layer4.1.conv3 to w4a8
Layer layer4.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer4.2.conv1 to w8a8
Layer layer4.2.conv2, precision switch from w4a8 to w4a8.
switched layer layer4.2.conv2 to w4a8
Layer layer4.2.conv3, precision switch from w4a8 to w4a8.
switched layer layer4.2.conv3 to w4a8
Layer fc, precision switch from w4a8 to w4a8.
switched layer fc to w4a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.17_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.17_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.1321497475533474, expected loss 1.0947336941585546, actual acc 72.00000012207032, actual loss 1.0885665616989135
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [4, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [4, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [4, 8], 'layer2.1.conv1': [4, 8], 'layer2.1.conv2': [4, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [4, 8], 'layer2.2.conv2': [4, 8], 'layer2.2.conv3': [4, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [4, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [4, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [4, 8], 'layer3.1.conv2': [4, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [4, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [4, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [4, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [4, 8], 'layer4.0.conv1': [4, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14243252349961294, expected loss 1.0426541119441988, actual acc 74.19999981689453, actual loss 1.017282751083374
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [4, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [4, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [4, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [4, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [4, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.15151028663967547, expected loss 1.0241225868091584, actual acc 75.60000042724609, actual loss 0.9947649512290955
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16468509332082817, expected loss 1.008980658613205, actual acc 75.50000042724609, actual loss 0.968271390914917
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.17014781804228174, expected loss 1.003960534893036, actual acc 76.30000006103515, actual loss 0.95357763671875
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Found K = 14
Final Solution:  {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [8, 8], 'fc': [4, 8]}
Policy:  ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8']
Achieved compression:  0.1900706964381712
Expected acc:  0.9942879706249236
Params % in int 4 = 0.4794344284946303
Params % in int 8 = 0.5205655715053698
Layer conv1, precision switch from w4a8 to w4a8.
Layer layer1.0.conv1, precision switch from w4a8 to w4a8.
Layer layer1.0.conv2, precision switch from w4a8 to w4a8.
Layer layer1.0.conv3, precision switch from w4a8 to w4a8.
Layer layer1.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer1.1.conv1, precision switch from w4a8 to w4a8.
Layer layer1.1.conv2, precision switch from w4a8 to w4a8.
Layer layer1.1.conv3, precision switch from w4a8 to w4a8.
Layer layer1.2.conv1, precision switch from w4a8 to w4a8.
Layer layer1.2.conv2, precision switch from w4a8 to w4a8.
Layer layer1.2.conv3, precision switch from w4a8 to w4a8.
Layer layer2.0.conv1, precision switch from w4a8 to w4a8.
Layer layer2.0.conv2, precision switch from w4a8 to w4a8.
Layer layer2.0.conv3, precision switch from w4a8 to w4a8.
Layer layer2.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer2.1.conv1, precision switch from w4a8 to w4a8.
Layer layer2.1.conv2, precision switch from w4a8 to w4a8.
Layer layer2.1.conv3, precision switch from w4a8 to w4a8.
Layer layer2.2.conv1, precision switch from w4a8 to w4a8.
Layer layer2.2.conv2, precision switch from w4a8 to w4a8.
Layer layer2.2.conv3, precision switch from w4a8 to w4a8.
Layer layer2.3.conv1, precision switch from w4a8 to w4a8.
Layer layer2.3.conv2, precision switch from w4a8 to w4a8.
Layer layer2.3.conv3, precision switch from w4a8 to w4a8.
Layer layer3.0.conv1, precision switch from w4a8 to w4a8.
Layer layer3.0.conv2, precision switch from w4a8 to w4a8.
Layer layer3.0.conv3, precision switch from w4a8 to w4a8.
Layer layer3.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer3.1.conv1, precision switch from w4a8 to w4a8.
Layer layer3.1.conv2, precision switch from w4a8 to w4a8.
Layer layer3.1.conv3, precision switch from w4a8 to w4a8.
Layer layer3.2.conv1, precision switch from w4a8 to w4a8.
Layer layer3.2.conv2, precision switch from w4a8 to w4a8.
Layer layer3.2.conv3, precision switch from w4a8 to w4a8.
Layer layer3.3.conv1, precision switch from w4a8 to w4a8.
Layer layer3.3.conv2, precision switch from w4a8 to w4a8.
Layer layer3.3.conv3, precision switch from w4a8 to w4a8.
Layer layer3.4.conv1, precision switch from w4a8 to w4a8.
Layer layer3.4.conv2, precision switch from w4a8 to w4a8.
Layer layer3.4.conv3, precision switch from w4a8 to w4a8.
Layer layer3.5.conv1, precision switch from w4a8 to w4a8.
Layer layer3.5.conv2, precision switch from w4a8 to w4a8.
Layer layer3.5.conv3, precision switch from w4a8 to w4a8.
Layer layer4.0.conv1, precision switch from w4a8 to w4a8.
Layer layer4.0.conv2, precision switch from w4a8 to w4a8.
Layer layer4.0.conv3, precision switch from w4a8 to w4a8.
Layer layer4.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer4.1.conv1, precision switch from w4a8 to w4a8.
Layer layer4.1.conv2, precision switch from w4a8 to w4a8.
Layer layer4.1.conv3, precision switch from w4a8 to w4a8.
Layer layer4.2.conv1, precision switch from w4a8 to w4a8.
Layer layer4.2.conv2, precision switch from w4a8 to w4a8.
Layer layer4.2.conv3, precision switch from w4a8 to w4a8.
Layer fc, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/resnet50_w4a8.adaquant/resnet.absorb_bn.measure_perC.adaquant
Layer conv1, precision switch from w8a8 to w8a8.
switched layer conv1 to w8a8
Layer layer1.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv1 to w8a8
Layer layer1.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv2 to w8a8
Layer layer1.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv3 to w8a8
Layer layer1.0.downsample.0, precision switch from w8a8 to w8a8.
switched layer layer1.0.downsample.0 to w8a8
Layer layer1.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.1.conv1 to w8a8
Layer layer1.1.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.1.conv2 to w8a8
Layer layer1.1.conv3, precision switch from w4a8 to w4a8.
switched layer layer1.1.conv3 to w4a8
Layer layer1.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv1 to w8a8
Layer layer1.2.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv2 to w8a8
Layer layer1.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv3 to w8a8
Layer layer2.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.0.conv1 to w8a8
Layer layer2.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.0.conv2 to w8a8
Layer layer2.0.conv3, precision switch from w4a8 to w4a8.
switched layer layer2.0.conv3 to w4a8
Layer layer2.0.downsample.0, precision switch from w8a8 to w8a8.
switched layer layer2.0.downsample.0 to w8a8
Layer layer2.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.1.conv1 to w8a8
Layer layer2.1.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.1.conv2 to w8a8
Layer layer2.1.conv3, precision switch from w8a8 to w8a8.
switched layer layer2.1.conv3 to w8a8
Layer layer2.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.2.conv1 to w8a8
Layer layer2.2.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.2.conv2 to w8a8
Layer layer2.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer2.2.conv3 to w8a8
Layer layer2.3.conv1, precision switch from w4a8 to w4a8.
switched layer layer2.3.conv1 to w4a8
Layer layer2.3.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.3.conv2 to w8a8
Layer layer2.3.conv3, precision switch from w8a8 to w8a8.
switched layer layer2.3.conv3 to w8a8
Layer layer3.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.0.conv1 to w8a8
Layer layer3.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.0.conv2 to w8a8
Layer layer3.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.0.conv3 to w8a8
Layer layer3.0.downsample.0, precision switch from w4a8 to w4a8.
switched layer layer3.0.downsample.0 to w4a8
Layer layer3.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.1.conv1 to w8a8
Layer layer3.1.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.1.conv2 to w8a8
Layer layer3.1.conv3, precision switch from w4a8 to w4a8.
switched layer layer3.1.conv3 to w4a8
Layer layer3.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.2.conv1 to w8a8
Layer layer3.2.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.2.conv2 to w8a8
Layer layer3.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.2.conv3 to w8a8
Layer layer3.3.conv1, precision switch from w4a8 to w4a8.
switched layer layer3.3.conv1 to w4a8
Layer layer3.3.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.3.conv2 to w8a8
Layer layer3.3.conv3, precision switch from w4a8 to w4a8.
switched layer layer3.3.conv3 to w4a8
Layer layer3.4.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.4.conv1 to w8a8
Layer layer3.4.conv2, precision switch from w4a8 to w4a8.
switched layer layer3.4.conv2 to w4a8
Layer layer3.4.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.4.conv3 to w8a8
Layer layer3.5.conv1, precision switch from w4a8 to w4a8.
switched layer layer3.5.conv1 to w4a8
Layer layer3.5.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.5.conv2 to w8a8
Layer layer3.5.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.5.conv3 to w8a8
Layer layer4.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer4.0.conv1 to w8a8
Layer layer4.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer4.0.conv2 to w8a8
Layer layer4.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer4.0.conv3 to w8a8
Layer layer4.0.downsample.0, precision switch from w4a8 to w4a8.
switched layer layer4.0.downsample.0 to w4a8
Layer layer4.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer4.1.conv1 to w8a8
Layer layer4.1.conv2, precision switch from w4a8 to w4a8.
switched layer layer4.1.conv2 to w4a8
Layer layer4.1.conv3, precision switch from w4a8 to w4a8.
switched layer layer4.1.conv3 to w4a8
Layer layer4.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer4.2.conv1 to w8a8
Layer layer4.2.conv2, precision switch from w4a8 to w4a8.
switched layer layer4.2.conv2 to w4a8
Layer layer4.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer4.2.conv3 to w8a8
Layer fc, precision switch from w4a8 to w4a8.
switched layer fc to w4a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.18_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.18_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.1321497475533474, expected loss 1.0947336941585546, actual acc 72.00000012207032, actual loss 1.0885665616989135
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [4, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [4, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [4, 8], 'layer2.1.conv1': [4, 8], 'layer2.1.conv2': [4, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [4, 8], 'layer2.2.conv2': [4, 8], 'layer2.2.conv3': [4, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [4, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [4, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [4, 8], 'layer3.1.conv2': [4, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [4, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [4, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [4, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [4, 8], 'layer4.0.conv1': [4, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14243252349961294, expected loss 1.0426541119441988, actual acc 74.19999981689453, actual loss 1.017282751083374
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [4, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [4, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [4, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [4, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [4, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.15151028663967547, expected loss 1.0241225868091584, actual acc 75.60000042724609, actual loss 0.9947649512290955
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16468509332082817, expected loss 1.008980658613205, actual acc 75.50000042724609, actual loss 0.968271390914917
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.17014781804228174, expected loss 1.003960534893036, actual acc 76.30000006103515, actual loss 0.95357763671875
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.1900706964381712, expected loss 0.9942879706249236, actual acc 76.49999908447266, actual loss 0.9332769351005554
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [8, 8], 'fc': [4, 8]}
Found K = 14
Final Solution:  {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [8, 8], 'fc': [4, 8]}
Policy:  ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8']
Achieved compression:  0.1900706964381712
Expected acc:  0.9942879706249236
Params % in int 4 = 0.4794344284946303
Params % in int 8 = 0.5205655715053698
Layer conv1, precision switch from w4a8 to w4a8.
Layer layer1.0.conv1, precision switch from w4a8 to w4a8.
Layer layer1.0.conv2, precision switch from w4a8 to w4a8.
Layer layer1.0.conv3, precision switch from w4a8 to w4a8.
Layer layer1.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer1.1.conv1, precision switch from w4a8 to w4a8.
Layer layer1.1.conv2, precision switch from w4a8 to w4a8.
Layer layer1.1.conv3, precision switch from w4a8 to w4a8.
Layer layer1.2.conv1, precision switch from w4a8 to w4a8.
Layer layer1.2.conv2, precision switch from w4a8 to w4a8.
Layer layer1.2.conv3, precision switch from w4a8 to w4a8.
Layer layer2.0.conv1, precision switch from w4a8 to w4a8.
Layer layer2.0.conv2, precision switch from w4a8 to w4a8.
Layer layer2.0.conv3, precision switch from w4a8 to w4a8.
Layer layer2.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer2.1.conv1, precision switch from w4a8 to w4a8.
Layer layer2.1.conv2, precision switch from w4a8 to w4a8.
Layer layer2.1.conv3, precision switch from w4a8 to w4a8.
Layer layer2.2.conv1, precision switch from w4a8 to w4a8.
Layer layer2.2.conv2, precision switch from w4a8 to w4a8.
Layer layer2.2.conv3, precision switch from w4a8 to w4a8.
Layer layer2.3.conv1, precision switch from w4a8 to w4a8.
Layer layer2.3.conv2, precision switch from w4a8 to w4a8.
Layer layer2.3.conv3, precision switch from w4a8 to w4a8.
Layer layer3.0.conv1, precision switch from w4a8 to w4a8.
Layer layer3.0.conv2, precision switch from w4a8 to w4a8.
Layer layer3.0.conv3, precision switch from w4a8 to w4a8.
Layer layer3.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer3.1.conv1, precision switch from w4a8 to w4a8.
Layer layer3.1.conv2, precision switch from w4a8 to w4a8.
Layer layer3.1.conv3, precision switch from w4a8 to w4a8.
Layer layer3.2.conv1, precision switch from w4a8 to w4a8.
Layer layer3.2.conv2, precision switch from w4a8 to w4a8.
Layer layer3.2.conv3, precision switch from w4a8 to w4a8.
Layer layer3.3.conv1, precision switch from w4a8 to w4a8.
Layer layer3.3.conv2, precision switch from w4a8 to w4a8.
Layer layer3.3.conv3, precision switch from w4a8 to w4a8.
Layer layer3.4.conv1, precision switch from w4a8 to w4a8.
Layer layer3.4.conv2, precision switch from w4a8 to w4a8.
Layer layer3.4.conv3, precision switch from w4a8 to w4a8.
Layer layer3.5.conv1, precision switch from w4a8 to w4a8.
Layer layer3.5.conv2, precision switch from w4a8 to w4a8.
Layer layer3.5.conv3, precision switch from w4a8 to w4a8.
Layer layer4.0.conv1, precision switch from w4a8 to w4a8.
Layer layer4.0.conv2, precision switch from w4a8 to w4a8.
Layer layer4.0.conv3, precision switch from w4a8 to w4a8.
Layer layer4.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer4.1.conv1, precision switch from w4a8 to w4a8.
Layer layer4.1.conv2, precision switch from w4a8 to w4a8.
Layer layer4.1.conv3, precision switch from w4a8 to w4a8.
Layer layer4.2.conv1, precision switch from w4a8 to w4a8.
Layer layer4.2.conv2, precision switch from w4a8 to w4a8.
Layer layer4.2.conv3, precision switch from w4a8 to w4a8.
Layer fc, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/resnet50_w4a8.adaquant/resnet.absorb_bn.measure_perC.adaquant
Layer conv1, precision switch from w8a8 to w8a8.
switched layer conv1 to w8a8
Layer layer1.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv1 to w8a8
Layer layer1.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv2 to w8a8
Layer layer1.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv3 to w8a8
Layer layer1.0.downsample.0, precision switch from w8a8 to w8a8.
switched layer layer1.0.downsample.0 to w8a8
Layer layer1.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.1.conv1 to w8a8
Layer layer1.1.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.1.conv2 to w8a8
Layer layer1.1.conv3, precision switch from w4a8 to w4a8.
switched layer layer1.1.conv3 to w4a8
Layer layer1.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv1 to w8a8
Layer layer1.2.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv2 to w8a8
Layer layer1.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv3 to w8a8
Layer layer2.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.0.conv1 to w8a8
Layer layer2.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.0.conv2 to w8a8
Layer layer2.0.conv3, precision switch from w4a8 to w4a8.
switched layer layer2.0.conv3 to w4a8
Layer layer2.0.downsample.0, precision switch from w8a8 to w8a8.
switched layer layer2.0.downsample.0 to w8a8
Layer layer2.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.1.conv1 to w8a8
Layer layer2.1.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.1.conv2 to w8a8
Layer layer2.1.conv3, precision switch from w8a8 to w8a8.
switched layer layer2.1.conv3 to w8a8
Layer layer2.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.2.conv1 to w8a8
Layer layer2.2.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.2.conv2 to w8a8
Layer layer2.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer2.2.conv3 to w8a8
Layer layer2.3.conv1, precision switch from w4a8 to w4a8.
switched layer layer2.3.conv1 to w4a8
Layer layer2.3.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.3.conv2 to w8a8
Layer layer2.3.conv3, precision switch from w8a8 to w8a8.
switched layer layer2.3.conv3 to w8a8
Layer layer3.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.0.conv1 to w8a8
Layer layer3.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.0.conv2 to w8a8
Layer layer3.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.0.conv3 to w8a8
Layer layer3.0.downsample.0, precision switch from w4a8 to w4a8.
switched layer layer3.0.downsample.0 to w4a8
Layer layer3.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.1.conv1 to w8a8
Layer layer3.1.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.1.conv2 to w8a8
Layer layer3.1.conv3, precision switch from w4a8 to w4a8.
switched layer layer3.1.conv3 to w4a8
Layer layer3.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.2.conv1 to w8a8
Layer layer3.2.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.2.conv2 to w8a8
Layer layer3.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.2.conv3 to w8a8
Layer layer3.3.conv1, precision switch from w4a8 to w4a8.
switched layer layer3.3.conv1 to w4a8
Layer layer3.3.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.3.conv2 to w8a8
Layer layer3.3.conv3, precision switch from w4a8 to w4a8.
switched layer layer3.3.conv3 to w4a8
Layer layer3.4.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.4.conv1 to w8a8
Layer layer3.4.conv2, precision switch from w4a8 to w4a8.
switched layer layer3.4.conv2 to w4a8
Layer layer3.4.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.4.conv3 to w8a8
Layer layer3.5.conv1, precision switch from w4a8 to w4a8.
switched layer layer3.5.conv1 to w4a8
Layer layer3.5.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.5.conv2 to w8a8
Layer layer3.5.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.5.conv3 to w8a8
Layer layer4.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer4.0.conv1 to w8a8
Layer layer4.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer4.0.conv2 to w8a8
Layer layer4.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer4.0.conv3 to w8a8
Layer layer4.0.downsample.0, precision switch from w4a8 to w4a8.
switched layer layer4.0.downsample.0 to w4a8
Layer layer4.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer4.1.conv1 to w8a8
Layer layer4.1.conv2, precision switch from w4a8 to w4a8.
switched layer layer4.1.conv2 to w4a8
Layer layer4.1.conv3, precision switch from w4a8 to w4a8.
switched layer layer4.1.conv3 to w4a8
Layer layer4.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer4.2.conv1 to w8a8
Layer layer4.2.conv2, precision switch from w4a8 to w4a8.
switched layer layer4.2.conv2 to w4a8
Layer layer4.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer4.2.conv3 to w8a8
Layer fc, precision switch from w4a8 to w4a8.
switched layer fc to w4a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.19_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.19_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.1321497475533474, expected loss 1.0947336941585546, actual acc 72.00000012207032, actual loss 1.0885665616989135
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [4, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [4, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [4, 8], 'layer2.1.conv1': [4, 8], 'layer2.1.conv2': [4, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [4, 8], 'layer2.2.conv2': [4, 8], 'layer2.2.conv3': [4, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [4, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [4, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [4, 8], 'layer3.1.conv2': [4, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [4, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [4, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [4, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [4, 8], 'layer4.0.conv1': [4, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14243252349961294, expected loss 1.0426541119441988, actual acc 74.19999981689453, actual loss 1.017282751083374
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [4, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [4, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [4, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [4, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [4, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.15151028663967547, expected loss 1.0241225868091584, actual acc 75.60000042724609, actual loss 0.9947649512290955
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16468509332082817, expected loss 1.008980658613205, actual acc 75.50000042724609, actual loss 0.968271390914917
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.17014781804228174, expected loss 1.003960534893036, actual acc 76.30000006103515, actual loss 0.95357763671875
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.1900706964381712, expected loss 0.9942879706249236, actual acc 76.49999908447266, actual loss 0.9332769351005554
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [8, 8], 'fc': [4, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.1900706964381712, expected loss 0.9942879706249236, actual acc 76.49999908447266, actual loss 0.9332769351005554
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [8, 8], 'fc': [4, 8]}
Found K = 12
Final Solution:  {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [8, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [8, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [8, 8], 'fc': [4, 8]}
Policy:  ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8']
Achieved compression:  0.20163881937771994
Expected acc:  0.9919000714645384
Params % in int 4 = 0.3868894449782405
Params % in int 8 = 0.6131105550217595
Layer conv1, precision switch from w4a8 to w4a8.
Layer layer1.0.conv1, precision switch from w4a8 to w4a8.
Layer layer1.0.conv2, precision switch from w4a8 to w4a8.
Layer layer1.0.conv3, precision switch from w4a8 to w4a8.
Layer layer1.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer1.1.conv1, precision switch from w4a8 to w4a8.
Layer layer1.1.conv2, precision switch from w4a8 to w4a8.
Layer layer1.1.conv3, precision switch from w4a8 to w4a8.
Layer layer1.2.conv1, precision switch from w4a8 to w4a8.
Layer layer1.2.conv2, precision switch from w4a8 to w4a8.
Layer layer1.2.conv3, precision switch from w4a8 to w4a8.
Layer layer2.0.conv1, precision switch from w4a8 to w4a8.
Layer layer2.0.conv2, precision switch from w4a8 to w4a8.
Layer layer2.0.conv3, precision switch from w4a8 to w4a8.
Layer layer2.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer2.1.conv1, precision switch from w4a8 to w4a8.
Layer layer2.1.conv2, precision switch from w4a8 to w4a8.
Layer layer2.1.conv3, precision switch from w4a8 to w4a8.
Layer layer2.2.conv1, precision switch from w4a8 to w4a8.
Layer layer2.2.conv2, precision switch from w4a8 to w4a8.
Layer layer2.2.conv3, precision switch from w4a8 to w4a8.
Layer layer2.3.conv1, precision switch from w4a8 to w4a8.
Layer layer2.3.conv2, precision switch from w4a8 to w4a8.
Layer layer2.3.conv3, precision switch from w4a8 to w4a8.
Layer layer3.0.conv1, precision switch from w4a8 to w4a8.
Layer layer3.0.conv2, precision switch from w4a8 to w4a8.
Layer layer3.0.conv3, precision switch from w4a8 to w4a8.
Layer layer3.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer3.1.conv1, precision switch from w4a8 to w4a8.
Layer layer3.1.conv2, precision switch from w4a8 to w4a8.
Layer layer3.1.conv3, precision switch from w4a8 to w4a8.
Layer layer3.2.conv1, precision switch from w4a8 to w4a8.
Layer layer3.2.conv2, precision switch from w4a8 to w4a8.
Layer layer3.2.conv3, precision switch from w4a8 to w4a8.
Layer layer3.3.conv1, precision switch from w4a8 to w4a8.
Layer layer3.3.conv2, precision switch from w4a8 to w4a8.
Layer layer3.3.conv3, precision switch from w4a8 to w4a8.
Layer layer3.4.conv1, precision switch from w4a8 to w4a8.
Layer layer3.4.conv2, precision switch from w4a8 to w4a8.
Layer layer3.4.conv3, precision switch from w4a8 to w4a8.
Layer layer3.5.conv1, precision switch from w4a8 to w4a8.
Layer layer3.5.conv2, precision switch from w4a8 to w4a8.
Layer layer3.5.conv3, precision switch from w4a8 to w4a8.
Layer layer4.0.conv1, precision switch from w4a8 to w4a8.
Layer layer4.0.conv2, precision switch from w4a8 to w4a8.
Layer layer4.0.conv3, precision switch from w4a8 to w4a8.
Layer layer4.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer4.1.conv1, precision switch from w4a8 to w4a8.
Layer layer4.1.conv2, precision switch from w4a8 to w4a8.
Layer layer4.1.conv3, precision switch from w4a8 to w4a8.
Layer layer4.2.conv1, precision switch from w4a8 to w4a8.
Layer layer4.2.conv2, precision switch from w4a8 to w4a8.
Layer layer4.2.conv3, precision switch from w4a8 to w4a8.
Layer fc, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/resnet50_w4a8.adaquant/resnet.absorb_bn.measure_perC.adaquant
Layer conv1, precision switch from w8a8 to w8a8.
switched layer conv1 to w8a8
Layer layer1.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv1 to w8a8
Layer layer1.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv2 to w8a8
Layer layer1.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv3 to w8a8
Layer layer1.0.downsample.0, precision switch from w8a8 to w8a8.
switched layer layer1.0.downsample.0 to w8a8
Layer layer1.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.1.conv1 to w8a8
Layer layer1.1.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.1.conv2 to w8a8
Layer layer1.1.conv3, precision switch from w4a8 to w4a8.
switched layer layer1.1.conv3 to w4a8
Layer layer1.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv1 to w8a8
Layer layer1.2.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv2 to w8a8
Layer layer1.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv3 to w8a8
Layer layer2.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.0.conv1 to w8a8
Layer layer2.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.0.conv2 to w8a8
Layer layer2.0.conv3, precision switch from w4a8 to w4a8.
switched layer layer2.0.conv3 to w4a8
Layer layer2.0.downsample.0, precision switch from w8a8 to w8a8.
switched layer layer2.0.downsample.0 to w8a8
Layer layer2.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.1.conv1 to w8a8
Layer layer2.1.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.1.conv2 to w8a8
Layer layer2.1.conv3, precision switch from w8a8 to w8a8.
switched layer layer2.1.conv3 to w8a8
Layer layer2.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.2.conv1 to w8a8
Layer layer2.2.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.2.conv2 to w8a8
Layer layer2.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer2.2.conv3 to w8a8
Layer layer2.3.conv1, precision switch from w4a8 to w4a8.
switched layer layer2.3.conv1 to w4a8
Layer layer2.3.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.3.conv2 to w8a8
Layer layer2.3.conv3, precision switch from w8a8 to w8a8.
switched layer layer2.3.conv3 to w8a8
Layer layer3.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.0.conv1 to w8a8
Layer layer3.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.0.conv2 to w8a8
Layer layer3.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.0.conv3 to w8a8
Layer layer3.0.downsample.0, precision switch from w4a8 to w4a8.
switched layer layer3.0.downsample.0 to w4a8
Layer layer3.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.1.conv1 to w8a8
Layer layer3.1.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.1.conv2 to w8a8
Layer layer3.1.conv3, precision switch from w4a8 to w4a8.
switched layer layer3.1.conv3 to w4a8
Layer layer3.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.2.conv1 to w8a8
Layer layer3.2.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.2.conv2 to w8a8
Layer layer3.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.2.conv3 to w8a8
Layer layer3.3.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.3.conv1 to w8a8
Layer layer3.3.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.3.conv2 to w8a8
Layer layer3.3.conv3, precision switch from w4a8 to w4a8.
switched layer layer3.3.conv3 to w4a8
Layer layer3.4.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.4.conv1 to w8a8
Layer layer3.4.conv2, precision switch from w4a8 to w4a8.
switched layer layer3.4.conv2 to w4a8
Layer layer3.4.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.4.conv3 to w8a8
Layer layer3.5.conv1, precision switch from w4a8 to w4a8.
switched layer layer3.5.conv1 to w4a8
Layer layer3.5.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.5.conv2 to w8a8
Layer layer3.5.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.5.conv3 to w8a8
Layer layer4.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer4.0.conv1 to w8a8
Layer layer4.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer4.0.conv2 to w8a8
Layer layer4.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer4.0.conv3 to w8a8
Layer layer4.0.downsample.0, precision switch from w8a8 to w8a8.
switched layer layer4.0.downsample.0 to w8a8
Layer layer4.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer4.1.conv1 to w8a8
Layer layer4.1.conv2, precision switch from w4a8 to w4a8.
switched layer layer4.1.conv2 to w4a8
Layer layer4.1.conv3, precision switch from w4a8 to w4a8.
switched layer layer4.1.conv3 to w4a8
Layer layer4.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer4.2.conv1 to w8a8
Layer layer4.2.conv2, precision switch from w4a8 to w4a8.
switched layer layer4.2.conv2 to w4a8
Layer layer4.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer4.2.conv3 to w8a8
Layer fc, precision switch from w4a8 to w4a8.
switched layer fc to w4a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.20_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.20_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.1321497475533474, expected loss 1.0947336941585546, actual acc 72.00000012207032, actual loss 1.0885665616989135
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [4, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [4, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [4, 8], 'layer2.1.conv1': [4, 8], 'layer2.1.conv2': [4, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [4, 8], 'layer2.2.conv2': [4, 8], 'layer2.2.conv3': [4, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [4, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [4, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [4, 8], 'layer3.1.conv2': [4, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [4, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [4, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [4, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [4, 8], 'layer4.0.conv1': [4, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14243252349961294, expected loss 1.0426541119441988, actual acc 74.19999981689453, actual loss 1.017282751083374
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [4, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [4, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [4, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [4, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [4, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.15151028663967547, expected loss 1.0241225868091584, actual acc 75.60000042724609, actual loss 0.9947649512290955
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16468509332082817, expected loss 1.008980658613205, actual acc 75.50000042724609, actual loss 0.968271390914917
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.17014781804228174, expected loss 1.003960534893036, actual acc 76.30000006103515, actual loss 0.95357763671875
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.1900706964381712, expected loss 0.9942879706249236, actual acc 76.49999908447266, actual loss 0.9332769351005554
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [8, 8], 'fc': [4, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.1900706964381712, expected loss 0.9942879706249236, actual acc 76.49999908447266, actual loss 0.9332769351005554
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [8, 8], 'fc': [4, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.20163881937771994, expected loss 0.9919000714645384, actual acc 76.60000006103516, actual loss 0.9274097137451172
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [8, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [8, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [8, 8], 'fc': [4, 8]}
Found K = 6
Final Solution:  {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [8, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [8, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [8, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [8, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [8, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [8, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [8, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [8, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [8, 8], 'fc': [4, 8]}
Policy:  ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8']
Achieved compression:  0.21007390902114087
Expected acc:  0.9917300798473357
Params % in int 4 = 0.319408727830873
Params % in int 8 = 0.680591272169127
Layer conv1, precision switch from w4a8 to w4a8.
Layer layer1.0.conv1, precision switch from w4a8 to w4a8.
Layer layer1.0.conv2, precision switch from w4a8 to w4a8.
Layer layer1.0.conv3, precision switch from w4a8 to w4a8.
Layer layer1.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer1.1.conv1, precision switch from w4a8 to w4a8.
Layer layer1.1.conv2, precision switch from w4a8 to w4a8.
Layer layer1.1.conv3, precision switch from w4a8 to w4a8.
Layer layer1.2.conv1, precision switch from w4a8 to w4a8.
Layer layer1.2.conv2, precision switch from w4a8 to w4a8.
Layer layer1.2.conv3, precision switch from w4a8 to w4a8.
Layer layer2.0.conv1, precision switch from w4a8 to w4a8.
Layer layer2.0.conv2, precision switch from w4a8 to w4a8.
Layer layer2.0.conv3, precision switch from w4a8 to w4a8.
Layer layer2.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer2.1.conv1, precision switch from w4a8 to w4a8.
Layer layer2.1.conv2, precision switch from w4a8 to w4a8.
Layer layer2.1.conv3, precision switch from w4a8 to w4a8.
Layer layer2.2.conv1, precision switch from w4a8 to w4a8.
Layer layer2.2.conv2, precision switch from w4a8 to w4a8.
Layer layer2.2.conv3, precision switch from w4a8 to w4a8.
Layer layer2.3.conv1, precision switch from w4a8 to w4a8.
Layer layer2.3.conv2, precision switch from w4a8 to w4a8.
Layer layer2.3.conv3, precision switch from w4a8 to w4a8.
Layer layer3.0.conv1, precision switch from w4a8 to w4a8.
Layer layer3.0.conv2, precision switch from w4a8 to w4a8.
Layer layer3.0.conv3, precision switch from w4a8 to w4a8.
Layer layer3.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer3.1.conv1, precision switch from w4a8 to w4a8.
Layer layer3.1.conv2, precision switch from w4a8 to w4a8.
Layer layer3.1.conv3, precision switch from w4a8 to w4a8.
Layer layer3.2.conv1, precision switch from w4a8 to w4a8.
Layer layer3.2.conv2, precision switch from w4a8 to w4a8.
Layer layer3.2.conv3, precision switch from w4a8 to w4a8.
Layer layer3.3.conv1, precision switch from w4a8 to w4a8.
Layer layer3.3.conv2, precision switch from w4a8 to w4a8.
Layer layer3.3.conv3, precision switch from w4a8 to w4a8.
Layer layer3.4.conv1, precision switch from w4a8 to w4a8.
Layer layer3.4.conv2, precision switch from w4a8 to w4a8.
Layer layer3.4.conv3, precision switch from w4a8 to w4a8.
Layer layer3.5.conv1, precision switch from w4a8 to w4a8.
Layer layer3.5.conv2, precision switch from w4a8 to w4a8.
Layer layer3.5.conv3, precision switch from w4a8 to w4a8.
Layer layer4.0.conv1, precision switch from w4a8 to w4a8.
Layer layer4.0.conv2, precision switch from w4a8 to w4a8.
Layer layer4.0.conv3, precision switch from w4a8 to w4a8.
Layer layer4.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer4.1.conv1, precision switch from w4a8 to w4a8.
Layer layer4.1.conv2, precision switch from w4a8 to w4a8.
Layer layer4.1.conv3, precision switch from w4a8 to w4a8.
Layer layer4.2.conv1, precision switch from w4a8 to w4a8.
Layer layer4.2.conv2, precision switch from w4a8 to w4a8.
Layer layer4.2.conv3, precision switch from w4a8 to w4a8.
Layer fc, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/resnet50_w4a8.adaquant/resnet.absorb_bn.measure_perC.adaquant
Layer conv1, precision switch from w8a8 to w8a8.
switched layer conv1 to w8a8
Layer layer1.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv1 to w8a8
Layer layer1.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv2 to w8a8
Layer layer1.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv3 to w8a8
Layer layer1.0.downsample.0, precision switch from w8a8 to w8a8.
switched layer layer1.0.downsample.0 to w8a8
Layer layer1.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.1.conv1 to w8a8
Layer layer1.1.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.1.conv2 to w8a8
Layer layer1.1.conv3, precision switch from w8a8 to w8a8.
switched layer layer1.1.conv3 to w8a8
Layer layer1.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv1 to w8a8
Layer layer1.2.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv2 to w8a8
Layer layer1.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv3 to w8a8
Layer layer2.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.0.conv1 to w8a8
Layer layer2.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.0.conv2 to w8a8
Layer layer2.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer2.0.conv3 to w8a8
Layer layer2.0.downsample.0, precision switch from w8a8 to w8a8.
switched layer layer2.0.downsample.0 to w8a8
Layer layer2.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.1.conv1 to w8a8
Layer layer2.1.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.1.conv2 to w8a8
Layer layer2.1.conv3, precision switch from w8a8 to w8a8.
switched layer layer2.1.conv3 to w8a8
Layer layer2.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.2.conv1 to w8a8
Layer layer2.2.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.2.conv2 to w8a8
Layer layer2.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer2.2.conv3 to w8a8
Layer layer2.3.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.3.conv1 to w8a8
Layer layer2.3.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.3.conv2 to w8a8
Layer layer2.3.conv3, precision switch from w8a8 to w8a8.
switched layer layer2.3.conv3 to w8a8
Layer layer3.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.0.conv1 to w8a8
Layer layer3.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.0.conv2 to w8a8
Layer layer3.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.0.conv3 to w8a8
Layer layer3.0.downsample.0, precision switch from w4a8 to w4a8.
switched layer layer3.0.downsample.0 to w4a8
Layer layer3.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.1.conv1 to w8a8
Layer layer3.1.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.1.conv2 to w8a8
Layer layer3.1.conv3, precision switch from w4a8 to w4a8.
switched layer layer3.1.conv3 to w4a8
Layer layer3.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.2.conv1 to w8a8
Layer layer3.2.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.2.conv2 to w8a8
Layer layer3.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.2.conv3 to w8a8
Layer layer3.3.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.3.conv1 to w8a8
Layer layer3.3.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.3.conv2 to w8a8
Layer layer3.3.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.3.conv3 to w8a8
Layer layer3.4.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.4.conv1 to w8a8
Layer layer3.4.conv2, precision switch from w4a8 to w4a8.
switched layer layer3.4.conv2 to w4a8
Layer layer3.4.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.4.conv3 to w8a8
Layer layer3.5.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.5.conv1 to w8a8
Layer layer3.5.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.5.conv2 to w8a8
Layer layer3.5.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.5.conv3 to w8a8
Layer layer4.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer4.0.conv1 to w8a8
Layer layer4.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer4.0.conv2 to w8a8
Layer layer4.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer4.0.conv3 to w8a8
Layer layer4.0.downsample.0, precision switch from w8a8 to w8a8.
switched layer layer4.0.downsample.0 to w8a8
Layer layer4.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer4.1.conv1 to w8a8
Layer layer4.1.conv2, precision switch from w4a8 to w4a8.
switched layer layer4.1.conv2 to w4a8
Layer layer4.1.conv3, precision switch from w8a8 to w8a8.
switched layer layer4.1.conv3 to w8a8
Layer layer4.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer4.2.conv1 to w8a8
Layer layer4.2.conv2, precision switch from w4a8 to w4a8.
switched layer layer4.2.conv2 to w4a8
Layer layer4.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer4.2.conv3 to w8a8
Layer fc, precision switch from w4a8 to w4a8.
switched layer fc to w4a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.21_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.21_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.1321497475533474, expected loss 1.0947336941585546, actual acc 72.00000012207032, actual loss 1.0885665616989135
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [4, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [4, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [4, 8], 'layer2.1.conv1': [4, 8], 'layer2.1.conv2': [4, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [4, 8], 'layer2.2.conv2': [4, 8], 'layer2.2.conv3': [4, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [4, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [4, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [4, 8], 'layer3.1.conv2': [4, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [4, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [4, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [4, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [4, 8], 'layer4.0.conv1': [4, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14243252349961294, expected loss 1.0426541119441988, actual acc 74.19999981689453, actual loss 1.017282751083374
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [4, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [4, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [4, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [4, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [4, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.15151028663967547, expected loss 1.0241225868091584, actual acc 75.60000042724609, actual loss 0.9947649512290955
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16468509332082817, expected loss 1.008980658613205, actual acc 75.50000042724609, actual loss 0.968271390914917
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.17014781804228174, expected loss 1.003960534893036, actual acc 76.30000006103515, actual loss 0.95357763671875
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.1900706964381712, expected loss 0.9942879706249236, actual acc 76.49999908447266, actual loss 0.9332769351005554
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [8, 8], 'fc': [4, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.1900706964381712, expected loss 0.9942879706249236, actual acc 76.49999908447266, actual loss 0.9332769351005554
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [8, 8], 'fc': [4, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.20163881937771994, expected loss 0.9919000714645384, actual acc 76.60000006103516, actual loss 0.9274097137451172
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [8, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [8, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [8, 8], 'fc': [4, 8]}
Compression thr 0.21, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.21_loss, compression 0.21007390902114087, expected loss 0.9917300798473357, actual acc 77.49999969482423, actual loss 0.9088918318748475
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [8, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [8, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [8, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [8, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [8, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [8, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [8, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [8, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [8, 8], 'fc': [4, 8]}
Found K = 2
Final Solution:  {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [8, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [8, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [8, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [8, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [8, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [8, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [8, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [8, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [8, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [8, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [8, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [8, 8], 'fc': [8, 8]}
Policy:  ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8']
Achieved compression:  0.22686375412090257
Expected acc:  0.9917260798473357
Params % in int 4 = 0.18508996703277952
Params % in int 8 = 0.8149100329672204
Layer conv1, precision switch from w4a8 to w4a8.
Layer layer1.0.conv1, precision switch from w4a8 to w4a8.
Layer layer1.0.conv2, precision switch from w4a8 to w4a8.
Layer layer1.0.conv3, precision switch from w4a8 to w4a8.
Layer layer1.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer1.1.conv1, precision switch from w4a8 to w4a8.
Layer layer1.1.conv2, precision switch from w4a8 to w4a8.
Layer layer1.1.conv3, precision switch from w4a8 to w4a8.
Layer layer1.2.conv1, precision switch from w4a8 to w4a8.
Layer layer1.2.conv2, precision switch from w4a8 to w4a8.
Layer layer1.2.conv3, precision switch from w4a8 to w4a8.
Layer layer2.0.conv1, precision switch from w4a8 to w4a8.
Layer layer2.0.conv2, precision switch from w4a8 to w4a8.
Layer layer2.0.conv3, precision switch from w4a8 to w4a8.
Layer layer2.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer2.1.conv1, precision switch from w4a8 to w4a8.
Layer layer2.1.conv2, precision switch from w4a8 to w4a8.
Layer layer2.1.conv3, precision switch from w4a8 to w4a8.
Layer layer2.2.conv1, precision switch from w4a8 to w4a8.
Layer layer2.2.conv2, precision switch from w4a8 to w4a8.
Layer layer2.2.conv3, precision switch from w4a8 to w4a8.
Layer layer2.3.conv1, precision switch from w4a8 to w4a8.
Layer layer2.3.conv2, precision switch from w4a8 to w4a8.
Layer layer2.3.conv3, precision switch from w4a8 to w4a8.
Layer layer3.0.conv1, precision switch from w4a8 to w4a8.
Layer layer3.0.conv2, precision switch from w4a8 to w4a8.
Layer layer3.0.conv3, precision switch from w4a8 to w4a8.
Layer layer3.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer3.1.conv1, precision switch from w4a8 to w4a8.
Layer layer3.1.conv2, precision switch from w4a8 to w4a8.
Layer layer3.1.conv3, precision switch from w4a8 to w4a8.
Layer layer3.2.conv1, precision switch from w4a8 to w4a8.
Layer layer3.2.conv2, precision switch from w4a8 to w4a8.
Layer layer3.2.conv3, precision switch from w4a8 to w4a8.
Layer layer3.3.conv1, precision switch from w4a8 to w4a8.
Layer layer3.3.conv2, precision switch from w4a8 to w4a8.
Layer layer3.3.conv3, precision switch from w4a8 to w4a8.
Layer layer3.4.conv1, precision switch from w4a8 to w4a8.
Layer layer3.4.conv2, precision switch from w4a8 to w4a8.
Layer layer3.4.conv3, precision switch from w4a8 to w4a8.
Layer layer3.5.conv1, precision switch from w4a8 to w4a8.
Layer layer3.5.conv2, precision switch from w4a8 to w4a8.
Layer layer3.5.conv3, precision switch from w4a8 to w4a8.
Layer layer4.0.conv1, precision switch from w4a8 to w4a8.
Layer layer4.0.conv2, precision switch from w4a8 to w4a8.
Layer layer4.0.conv3, precision switch from w4a8 to w4a8.
Layer layer4.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer4.1.conv1, precision switch from w4a8 to w4a8.
Layer layer4.1.conv2, precision switch from w4a8 to w4a8.
Layer layer4.1.conv3, precision switch from w4a8 to w4a8.
Layer layer4.2.conv1, precision switch from w4a8 to w4a8.
Layer layer4.2.conv2, precision switch from w4a8 to w4a8.
Layer layer4.2.conv3, precision switch from w4a8 to w4a8.
Layer fc, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/resnet50_w4a8.adaquant/resnet.absorb_bn.measure_perC.adaquant
Layer conv1, precision switch from w8a8 to w8a8.
switched layer conv1 to w8a8
Layer layer1.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv1 to w8a8
Layer layer1.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv2 to w8a8
Layer layer1.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv3 to w8a8
Layer layer1.0.downsample.0, precision switch from w8a8 to w8a8.
switched layer layer1.0.downsample.0 to w8a8
Layer layer1.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.1.conv1 to w8a8
Layer layer1.1.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.1.conv2 to w8a8
Layer layer1.1.conv3, precision switch from w8a8 to w8a8.
switched layer layer1.1.conv3 to w8a8
Layer layer1.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv1 to w8a8
Layer layer1.2.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv2 to w8a8
Layer layer1.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv3 to w8a8
Layer layer2.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.0.conv1 to w8a8
Layer layer2.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.0.conv2 to w8a8
Layer layer2.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer2.0.conv3 to w8a8
Layer layer2.0.downsample.0, precision switch from w8a8 to w8a8.
switched layer layer2.0.downsample.0 to w8a8
Layer layer2.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.1.conv1 to w8a8
Layer layer2.1.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.1.conv2 to w8a8
Layer layer2.1.conv3, precision switch from w8a8 to w8a8.
switched layer layer2.1.conv3 to w8a8
Layer layer2.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.2.conv1 to w8a8
Layer layer2.2.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.2.conv2 to w8a8
Layer layer2.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer2.2.conv3 to w8a8
Layer layer2.3.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.3.conv1 to w8a8
Layer layer2.3.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.3.conv2 to w8a8
Layer layer2.3.conv3, precision switch from w8a8 to w8a8.
switched layer layer2.3.conv3 to w8a8
Layer layer3.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.0.conv1 to w8a8
Layer layer3.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.0.conv2 to w8a8
Layer layer3.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.0.conv3 to w8a8
Layer layer3.0.downsample.0, precision switch from w8a8 to w8a8.
switched layer layer3.0.downsample.0 to w8a8
Layer layer3.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.1.conv1 to w8a8
Layer layer3.1.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.1.conv2 to w8a8
Layer layer3.1.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.1.conv3 to w8a8
Layer layer3.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.2.conv1 to w8a8
Layer layer3.2.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.2.conv2 to w8a8
Layer layer3.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.2.conv3 to w8a8
Layer layer3.3.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.3.conv1 to w8a8
Layer layer3.3.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.3.conv2 to w8a8
Layer layer3.3.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.3.conv3 to w8a8
Layer layer3.4.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.4.conv1 to w8a8
Layer layer3.4.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.4.conv2 to w8a8
Layer layer3.4.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.4.conv3 to w8a8
Layer layer3.5.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.5.conv1 to w8a8
Layer layer3.5.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.5.conv2 to w8a8
Layer layer3.5.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.5.conv3 to w8a8
Layer layer4.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer4.0.conv1 to w8a8
Layer layer4.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer4.0.conv2 to w8a8
Layer layer4.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer4.0.conv3 to w8a8
Layer layer4.0.downsample.0, precision switch from w8a8 to w8a8.
switched layer layer4.0.downsample.0 to w8a8
Layer layer4.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer4.1.conv1 to w8a8
Layer layer4.1.conv2, precision switch from w4a8 to w4a8.
switched layer layer4.1.conv2 to w4a8
Layer layer4.1.conv3, precision switch from w8a8 to w8a8.
switched layer layer4.1.conv3 to w8a8
Layer layer4.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer4.2.conv1 to w8a8
Layer layer4.2.conv2, precision switch from w4a8 to w4a8.
switched layer layer4.2.conv2 to w4a8
Layer layer4.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer4.2.conv3 to w8a8
Layer fc, precision switch from w8a8 to w8a8.
switched layer fc to w8a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.22_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.22_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.1321497475533474, expected loss 1.0947336941585546, actual acc 72.00000012207032, actual loss 1.0885665616989135
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [4, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [4, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [4, 8], 'layer2.1.conv1': [4, 8], 'layer2.1.conv2': [4, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [4, 8], 'layer2.2.conv2': [4, 8], 'layer2.2.conv3': [4, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [4, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [4, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [4, 8], 'layer3.1.conv2': [4, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [4, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [4, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [4, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [4, 8], 'layer4.0.conv1': [4, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14243252349961294, expected loss 1.0426541119441988, actual acc 74.19999981689453, actual loss 1.017282751083374
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [4, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [4, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [4, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [4, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [4, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.15151028663967547, expected loss 1.0241225868091584, actual acc 75.60000042724609, actual loss 0.9947649512290955
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16468509332082817, expected loss 1.008980658613205, actual acc 75.50000042724609, actual loss 0.968271390914917
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.17014781804228174, expected loss 1.003960534893036, actual acc 76.30000006103515, actual loss 0.95357763671875
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.1900706964381712, expected loss 0.9942879706249236, actual acc 76.49999908447266, actual loss 0.9332769351005554
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [8, 8], 'fc': [4, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.1900706964381712, expected loss 0.9942879706249236, actual acc 76.49999908447266, actual loss 0.9332769351005554
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [8, 8], 'fc': [4, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.20163881937771994, expected loss 0.9919000714645384, actual acc 76.60000006103516, actual loss 0.9274097137451172
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [8, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [8, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [8, 8], 'fc': [4, 8]}
Compression thr 0.21, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.21_loss, compression 0.21007390902114087, expected loss 0.9917300798473357, actual acc 77.49999969482423, actual loss 0.9088918318748475
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [8, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [8, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [8, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [8, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [8, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [8, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [8, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [8, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [8, 8], 'fc': [4, 8]}
Compression thr 0.22, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.22_loss, compression 0.22686375412090257, expected loss 0.9917260798473357, actual acc 77.39999969482422, actual loss 0.9056235027313232
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [8, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [8, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [8, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [8, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [8, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [8, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [8, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [8, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [8, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [8, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [8, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [8, 8], 'fc': [8, 8]}
Found K = 1
Final Solution:  {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [8, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [8, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [8, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [8, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [8, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [8, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [8, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [8, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [8, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [8, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [8, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [8, 8], 'layer4.2.conv3': [8, 8], 'fc': [8, 8]}
Policy:  ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Achieved compression:  0.23843187706045127
Expected acc:  0.9917250798473358
Params % in int 4 = 0.09254498351638976
Params % in int 8 = 0.9074550164836103
Layer conv1, precision switch from w4a8 to w4a8.
Layer layer1.0.conv1, precision switch from w4a8 to w4a8.
Layer layer1.0.conv2, precision switch from w4a8 to w4a8.
Layer layer1.0.conv3, precision switch from w4a8 to w4a8.
Layer layer1.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer1.1.conv1, precision switch from w4a8 to w4a8.
Layer layer1.1.conv2, precision switch from w4a8 to w4a8.
Layer layer1.1.conv3, precision switch from w4a8 to w4a8.
Layer layer1.2.conv1, precision switch from w4a8 to w4a8.
Layer layer1.2.conv2, precision switch from w4a8 to w4a8.
Layer layer1.2.conv3, precision switch from w4a8 to w4a8.
Layer layer2.0.conv1, precision switch from w4a8 to w4a8.
Layer layer2.0.conv2, precision switch from w4a8 to w4a8.
Layer layer2.0.conv3, precision switch from w4a8 to w4a8.
Layer layer2.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer2.1.conv1, precision switch from w4a8 to w4a8.
Layer layer2.1.conv2, precision switch from w4a8 to w4a8.
Layer layer2.1.conv3, precision switch from w4a8 to w4a8.
Layer layer2.2.conv1, precision switch from w4a8 to w4a8.
Layer layer2.2.conv2, precision switch from w4a8 to w4a8.
Layer layer2.2.conv3, precision switch from w4a8 to w4a8.
Layer layer2.3.conv1, precision switch from w4a8 to w4a8.
Layer layer2.3.conv2, precision switch from w4a8 to w4a8.
Layer layer2.3.conv3, precision switch from w4a8 to w4a8.
Layer layer3.0.conv1, precision switch from w4a8 to w4a8.
Layer layer3.0.conv2, precision switch from w4a8 to w4a8.
Layer layer3.0.conv3, precision switch from w4a8 to w4a8.
Layer layer3.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer3.1.conv1, precision switch from w4a8 to w4a8.
Layer layer3.1.conv2, precision switch from w4a8 to w4a8.
Layer layer3.1.conv3, precision switch from w4a8 to w4a8.
Layer layer3.2.conv1, precision switch from w4a8 to w4a8.
Layer layer3.2.conv2, precision switch from w4a8 to w4a8.
Layer layer3.2.conv3, precision switch from w4a8 to w4a8.
Layer layer3.3.conv1, precision switch from w4a8 to w4a8.
Layer layer3.3.conv2, precision switch from w4a8 to w4a8.
Layer layer3.3.conv3, precision switch from w4a8 to w4a8.
Layer layer3.4.conv1, precision switch from w4a8 to w4a8.
Layer layer3.4.conv2, precision switch from w4a8 to w4a8.
Layer layer3.4.conv3, precision switch from w4a8 to w4a8.
Layer layer3.5.conv1, precision switch from w4a8 to w4a8.
Layer layer3.5.conv2, precision switch from w4a8 to w4a8.
Layer layer3.5.conv3, precision switch from w4a8 to w4a8.
Layer layer4.0.conv1, precision switch from w4a8 to w4a8.
Layer layer4.0.conv2, precision switch from w4a8 to w4a8.
Layer layer4.0.conv3, precision switch from w4a8 to w4a8.
Layer layer4.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer4.1.conv1, precision switch from w4a8 to w4a8.
Layer layer4.1.conv2, precision switch from w4a8 to w4a8.
Layer layer4.1.conv3, precision switch from w4a8 to w4a8.
Layer layer4.2.conv1, precision switch from w4a8 to w4a8.
Layer layer4.2.conv2, precision switch from w4a8 to w4a8.
Layer layer4.2.conv3, precision switch from w4a8 to w4a8.
Layer fc, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/resnet50_w4a8.adaquant/resnet.absorb_bn.measure_perC.adaquant
Layer conv1, precision switch from w8a8 to w8a8.
switched layer conv1 to w8a8
Layer layer1.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv1 to w8a8
Layer layer1.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv2 to w8a8
Layer layer1.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv3 to w8a8
Layer layer1.0.downsample.0, precision switch from w8a8 to w8a8.
switched layer layer1.0.downsample.0 to w8a8
Layer layer1.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.1.conv1 to w8a8
Layer layer1.1.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.1.conv2 to w8a8
Layer layer1.1.conv3, precision switch from w8a8 to w8a8.
switched layer layer1.1.conv3 to w8a8
Layer layer1.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv1 to w8a8
Layer layer1.2.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv2 to w8a8
Layer layer1.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv3 to w8a8
Layer layer2.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.0.conv1 to w8a8
Layer layer2.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.0.conv2 to w8a8
Layer layer2.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer2.0.conv3 to w8a8
Layer layer2.0.downsample.0, precision switch from w8a8 to w8a8.
switched layer layer2.0.downsample.0 to w8a8
Layer layer2.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.1.conv1 to w8a8
Layer layer2.1.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.1.conv2 to w8a8
Layer layer2.1.conv3, precision switch from w8a8 to w8a8.
switched layer layer2.1.conv3 to w8a8
Layer layer2.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.2.conv1 to w8a8
Layer layer2.2.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.2.conv2 to w8a8
Layer layer2.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer2.2.conv3 to w8a8
Layer layer2.3.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.3.conv1 to w8a8
Layer layer2.3.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.3.conv2 to w8a8
Layer layer2.3.conv3, precision switch from w8a8 to w8a8.
switched layer layer2.3.conv3 to w8a8
Layer layer3.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.0.conv1 to w8a8
Layer layer3.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.0.conv2 to w8a8
Layer layer3.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.0.conv3 to w8a8
Layer layer3.0.downsample.0, precision switch from w8a8 to w8a8.
switched layer layer3.0.downsample.0 to w8a8
Layer layer3.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.1.conv1 to w8a8
Layer layer3.1.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.1.conv2 to w8a8
Layer layer3.1.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.1.conv3 to w8a8
Layer layer3.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.2.conv1 to w8a8
Layer layer3.2.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.2.conv2 to w8a8
Layer layer3.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.2.conv3 to w8a8
Layer layer3.3.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.3.conv1 to w8a8
Layer layer3.3.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.3.conv2 to w8a8
Layer layer3.3.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.3.conv3 to w8a8
Layer layer3.4.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.4.conv1 to w8a8
Layer layer3.4.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.4.conv2 to w8a8
Layer layer3.4.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.4.conv3 to w8a8
Layer layer3.5.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.5.conv1 to w8a8
Layer layer3.5.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.5.conv2 to w8a8
Layer layer3.5.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.5.conv3 to w8a8
Layer layer4.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer4.0.conv1 to w8a8
Layer layer4.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer4.0.conv2 to w8a8
Layer layer4.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer4.0.conv3 to w8a8
Layer layer4.0.downsample.0, precision switch from w8a8 to w8a8.
switched layer layer4.0.downsample.0 to w8a8
Layer layer4.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer4.1.conv1 to w8a8
Layer layer4.1.conv2, precision switch from w4a8 to w4a8.
switched layer layer4.1.conv2 to w4a8
Layer layer4.1.conv3, precision switch from w8a8 to w8a8.
switched layer layer4.1.conv3 to w8a8
Layer layer4.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer4.2.conv1 to w8a8
Layer layer4.2.conv2, precision switch from w8a8 to w8a8.
switched layer layer4.2.conv2 to w8a8
Layer layer4.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer4.2.conv3 to w8a8
Layer fc, precision switch from w8a8 to w8a8.
switched layer fc to w8a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.23_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.23_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.1321497475533474, expected loss 1.0947336941585546, actual acc 72.00000012207032, actual loss 1.0885665616989135
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [4, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [4, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [4, 8], 'layer2.1.conv1': [4, 8], 'layer2.1.conv2': [4, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [4, 8], 'layer2.2.conv2': [4, 8], 'layer2.2.conv3': [4, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [4, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [4, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [4, 8], 'layer3.1.conv2': [4, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [4, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [4, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [4, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [4, 8], 'layer4.0.conv1': [4, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14243252349961294, expected loss 1.0426541119441988, actual acc 74.19999981689453, actual loss 1.017282751083374
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [4, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [4, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [4, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [4, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [4, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.15151028663967547, expected loss 1.0241225868091584, actual acc 75.60000042724609, actual loss 0.9947649512290955
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16468509332082817, expected loss 1.008980658613205, actual acc 75.50000042724609, actual loss 0.968271390914917
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.17014781804228174, expected loss 1.003960534893036, actual acc 76.30000006103515, actual loss 0.95357763671875
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.1900706964381712, expected loss 0.9942879706249236, actual acc 76.49999908447266, actual loss 0.9332769351005554
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [8, 8], 'fc': [4, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.1900706964381712, expected loss 0.9942879706249236, actual acc 76.49999908447266, actual loss 0.9332769351005554
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [8, 8], 'fc': [4, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.20163881937771994, expected loss 0.9919000714645384, actual acc 76.60000006103516, actual loss 0.9274097137451172
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [8, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [8, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [8, 8], 'fc': [4, 8]}
Compression thr 0.21, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.21_loss, compression 0.21007390902114087, expected loss 0.9917300798473357, actual acc 77.49999969482423, actual loss 0.9088918318748475
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [8, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [8, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [8, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [8, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [8, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [8, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [8, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [8, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [8, 8], 'fc': [4, 8]}
Compression thr 0.22, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.22_loss, compression 0.22686375412090257, expected loss 0.9917260798473357, actual acc 77.39999969482422, actual loss 0.9056235027313232
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [8, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [8, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [8, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [8, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [8, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [8, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [8, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [8, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [8, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [8, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [8, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [8, 8], 'fc': [8, 8]}
Compression thr 0.23, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.23_loss, compression 0.23843187706045127, expected loss 0.9917250798473358, actual acc 78.00000030517577, actual loss 0.9064894299507141
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [8, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [8, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [8, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [8, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [8, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [8, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [8, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [8, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [8, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [8, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [8, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [8, 8], 'layer4.2.conv3': [8, 8], 'fc': [8, 8]}
Found K = 0
Final Solution:  {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [8, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [8, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [8, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [8, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [8, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [8, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [8, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [8, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [8, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [8, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [8, 8], 'layer4.1.conv3': [8, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [8, 8], 'layer4.2.conv3': [8, 8], 'fc': [8, 8]}
Policy:  ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Achieved compression:  0.25
Expected acc:  0.9917240798473358
Params % in int 4 = 0.0
Params % in int 8 = 1.0
Layer conv1, precision switch from w4a8 to w4a8.
Layer layer1.0.conv1, precision switch from w4a8 to w4a8.
Layer layer1.0.conv2, precision switch from w4a8 to w4a8.
Layer layer1.0.conv3, precision switch from w4a8 to w4a8.
Layer layer1.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer1.1.conv1, precision switch from w4a8 to w4a8.
Layer layer1.1.conv2, precision switch from w4a8 to w4a8.
Layer layer1.1.conv3, precision switch from w4a8 to w4a8.
Layer layer1.2.conv1, precision switch from w4a8 to w4a8.
Layer layer1.2.conv2, precision switch from w4a8 to w4a8.
Layer layer1.2.conv3, precision switch from w4a8 to w4a8.
Layer layer2.0.conv1, precision switch from w4a8 to w4a8.
Layer layer2.0.conv2, precision switch from w4a8 to w4a8.
Layer layer2.0.conv3, precision switch from w4a8 to w4a8.
Layer layer2.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer2.1.conv1, precision switch from w4a8 to w4a8.
Layer layer2.1.conv2, precision switch from w4a8 to w4a8.
Layer layer2.1.conv3, precision switch from w4a8 to w4a8.
Layer layer2.2.conv1, precision switch from w4a8 to w4a8.
Layer layer2.2.conv2, precision switch from w4a8 to w4a8.
Layer layer2.2.conv3, precision switch from w4a8 to w4a8.
Layer layer2.3.conv1, precision switch from w4a8 to w4a8.
Layer layer2.3.conv2, precision switch from w4a8 to w4a8.
Layer layer2.3.conv3, precision switch from w4a8 to w4a8.
Layer layer3.0.conv1, precision switch from w4a8 to w4a8.
Layer layer3.0.conv2, precision switch from w4a8 to w4a8.
Layer layer3.0.conv3, precision switch from w4a8 to w4a8.
Layer layer3.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer3.1.conv1, precision switch from w4a8 to w4a8.
Layer layer3.1.conv2, precision switch from w4a8 to w4a8.
Layer layer3.1.conv3, precision switch from w4a8 to w4a8.
Layer layer3.2.conv1, precision switch from w4a8 to w4a8.
Layer layer3.2.conv2, precision switch from w4a8 to w4a8.
Layer layer3.2.conv3, precision switch from w4a8 to w4a8.
Layer layer3.3.conv1, precision switch from w4a8 to w4a8.
Layer layer3.3.conv2, precision switch from w4a8 to w4a8.
Layer layer3.3.conv3, precision switch from w4a8 to w4a8.
Layer layer3.4.conv1, precision switch from w4a8 to w4a8.
Layer layer3.4.conv2, precision switch from w4a8 to w4a8.
Layer layer3.4.conv3, precision switch from w4a8 to w4a8.
Layer layer3.5.conv1, precision switch from w4a8 to w4a8.
Layer layer3.5.conv2, precision switch from w4a8 to w4a8.
Layer layer3.5.conv3, precision switch from w4a8 to w4a8.
Layer layer4.0.conv1, precision switch from w4a8 to w4a8.
Layer layer4.0.conv2, precision switch from w4a8 to w4a8.
Layer layer4.0.conv3, precision switch from w4a8 to w4a8.
Layer layer4.0.downsample.0, precision switch from w4a8 to w4a8.
Layer layer4.1.conv1, precision switch from w4a8 to w4a8.
Layer layer4.1.conv2, precision switch from w4a8 to w4a8.
Layer layer4.1.conv3, precision switch from w4a8 to w4a8.
Layer layer4.2.conv1, precision switch from w4a8 to w4a8.
Layer layer4.2.conv2, precision switch from w4a8 to w4a8.
Layer layer4.2.conv3, precision switch from w4a8 to w4a8.
Layer fc, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/resnet50_w4a8.adaquant/resnet.absorb_bn.measure_perC.adaquant
Layer conv1, precision switch from w8a8 to w8a8.
switched layer conv1 to w8a8
Layer layer1.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv1 to w8a8
Layer layer1.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv2 to w8a8
Layer layer1.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer1.0.conv3 to w8a8
Layer layer1.0.downsample.0, precision switch from w8a8 to w8a8.
switched layer layer1.0.downsample.0 to w8a8
Layer layer1.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.1.conv1 to w8a8
Layer layer1.1.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.1.conv2 to w8a8
Layer layer1.1.conv3, precision switch from w8a8 to w8a8.
switched layer layer1.1.conv3 to w8a8
Layer layer1.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv1 to w8a8
Layer layer1.2.conv2, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv2 to w8a8
Layer layer1.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer1.2.conv3 to w8a8
Layer layer2.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.0.conv1 to w8a8
Layer layer2.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.0.conv2 to w8a8
Layer layer2.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer2.0.conv3 to w8a8
Layer layer2.0.downsample.0, precision switch from w8a8 to w8a8.
switched layer layer2.0.downsample.0 to w8a8
Layer layer2.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.1.conv1 to w8a8
Layer layer2.1.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.1.conv2 to w8a8
Layer layer2.1.conv3, precision switch from w8a8 to w8a8.
switched layer layer2.1.conv3 to w8a8
Layer layer2.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.2.conv1 to w8a8
Layer layer2.2.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.2.conv2 to w8a8
Layer layer2.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer2.2.conv3 to w8a8
Layer layer2.3.conv1, precision switch from w8a8 to w8a8.
switched layer layer2.3.conv1 to w8a8
Layer layer2.3.conv2, precision switch from w8a8 to w8a8.
switched layer layer2.3.conv2 to w8a8
Layer layer2.3.conv3, precision switch from w8a8 to w8a8.
switched layer layer2.3.conv3 to w8a8
Layer layer3.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.0.conv1 to w8a8
Layer layer3.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.0.conv2 to w8a8
Layer layer3.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.0.conv3 to w8a8
Layer layer3.0.downsample.0, precision switch from w8a8 to w8a8.
switched layer layer3.0.downsample.0 to w8a8
Layer layer3.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.1.conv1 to w8a8
Layer layer3.1.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.1.conv2 to w8a8
Layer layer3.1.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.1.conv3 to w8a8
Layer layer3.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.2.conv1 to w8a8
Layer layer3.2.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.2.conv2 to w8a8
Layer layer3.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.2.conv3 to w8a8
Layer layer3.3.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.3.conv1 to w8a8
Layer layer3.3.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.3.conv2 to w8a8
Layer layer3.3.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.3.conv3 to w8a8
Layer layer3.4.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.4.conv1 to w8a8
Layer layer3.4.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.4.conv2 to w8a8
Layer layer3.4.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.4.conv3 to w8a8
Layer layer3.5.conv1, precision switch from w8a8 to w8a8.
switched layer layer3.5.conv1 to w8a8
Layer layer3.5.conv2, precision switch from w8a8 to w8a8.
switched layer layer3.5.conv2 to w8a8
Layer layer3.5.conv3, precision switch from w8a8 to w8a8.
switched layer layer3.5.conv3 to w8a8
Layer layer4.0.conv1, precision switch from w8a8 to w8a8.
switched layer layer4.0.conv1 to w8a8
Layer layer4.0.conv2, precision switch from w8a8 to w8a8.
switched layer layer4.0.conv2 to w8a8
Layer layer4.0.conv3, precision switch from w8a8 to w8a8.
switched layer layer4.0.conv3 to w8a8
Layer layer4.0.downsample.0, precision switch from w8a8 to w8a8.
switched layer layer4.0.downsample.0 to w8a8
Layer layer4.1.conv1, precision switch from w8a8 to w8a8.
switched layer layer4.1.conv1 to w8a8
Layer layer4.1.conv2, precision switch from w8a8 to w8a8.
switched layer layer4.1.conv2 to w8a8
Layer layer4.1.conv3, precision switch from w8a8 to w8a8.
switched layer layer4.1.conv3 to w8a8
Layer layer4.2.conv1, precision switch from w8a8 to w8a8.
switched layer layer4.2.conv1 to w8a8
Layer layer4.2.conv2, precision switch from w8a8 to w8a8.
switched layer layer4.2.conv2 to w8a8
Layer layer4.2.conv3, precision switch from w8a8 to w8a8.
switched layer layer4.2.conv3 to w8a8
Layer fc, precision switch from w8a8 to w8a8.
switched layer fc to w8a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.24_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.24_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.1321497475533474, expected loss 1.0947336941585546, actual acc 72.00000012207032, actual loss 1.0885665616989135
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [4, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [4, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [4, 8], 'layer2.1.conv1': [4, 8], 'layer2.1.conv2': [4, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [4, 8], 'layer2.2.conv2': [4, 8], 'layer2.2.conv3': [4, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [4, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [4, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [4, 8], 'layer3.1.conv2': [4, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [4, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [4, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [4, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [4, 8], 'layer4.0.conv1': [4, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14243252349961294, expected loss 1.0426541119441988, actual acc 74.19999981689453, actual loss 1.017282751083374
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [4, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [4, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [4, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [4, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [4, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.15151028663967547, expected loss 1.0241225868091584, actual acc 75.60000042724609, actual loss 0.9947649512290955
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [4, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [4, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [4, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16468509332082817, expected loss 1.008980658613205, actual acc 75.50000042724609, actual loss 0.968271390914917
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [4, 8], 'layer3.2.conv2': [4, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [4, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.17014781804228174, expected loss 1.003960534893036, actual acc 76.30000006103515, actual loss 0.95357763671875
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [4, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [4, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [4, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [4, 8], 'fc': [4, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.1900706964381712, expected loss 0.9942879706249236, actual acc 76.49999908447266, actual loss 0.9332769351005554
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [8, 8], 'fc': [4, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.1900706964381712, expected loss 0.9942879706249236, actual acc 76.49999908447266, actual loss 0.9332769351005554
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [4, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [4, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [8, 8], 'fc': [4, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.20163881937771994, expected loss 0.9919000714645384, actual acc 76.60000006103516, actual loss 0.9274097137451172
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [4, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [4, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [4, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [8, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [4, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [4, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [8, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [4, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [8, 8], 'fc': [4, 8]}
Compression thr 0.21, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.21_loss, compression 0.21007390902114087, expected loss 0.9917300798473357, actual acc 77.49999969482423, actual loss 0.9088918318748475
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [8, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [8, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [8, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [4, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [4, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [8, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [8, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [4, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [8, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [8, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [8, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [8, 8], 'fc': [4, 8]}
Compression thr 0.22, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.22_loss, compression 0.22686375412090257, expected loss 0.9917260798473357, actual acc 77.39999969482422, actual loss 0.9056235027313232
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [8, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [8, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [8, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [8, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [8, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [8, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [8, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [8, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [8, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [8, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [8, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [4, 8], 'layer4.2.conv3': [8, 8], 'fc': [8, 8]}
Compression thr 0.23, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.23_loss, compression 0.23843187706045127, expected loss 0.9917250798473358, actual acc 78.00000030517577, actual loss 0.9064894299507141
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [8, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [8, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [8, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [8, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [8, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [8, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [8, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [8, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [8, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [8, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [4, 8], 'layer4.1.conv3': [8, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [8, 8], 'layer4.2.conv3': [8, 8], 'fc': [8, 8]}
Compression thr 0.24, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.24_loss, compression 0.25, expected loss 0.9917240798473358, actual acc 78.20000030517578, actual loss 0.9015433168411255
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'conv1': [8, 8], 'layer1.0.conv1': [8, 8], 'layer1.0.conv2': [8, 8], 'layer1.0.conv3': [8, 8], 'layer1.0.downsample.0': [8, 8], 'layer1.1.conv1': [8, 8], 'layer1.1.conv2': [8, 8], 'layer1.1.conv3': [8, 8], 'layer1.2.conv1': [8, 8], 'layer1.2.conv2': [8, 8], 'layer1.2.conv3': [8, 8], 'layer2.0.conv1': [8, 8], 'layer2.0.conv2': [8, 8], 'layer2.0.conv3': [8, 8], 'layer2.0.downsample.0': [8, 8], 'layer2.1.conv1': [8, 8], 'layer2.1.conv2': [8, 8], 'layer2.1.conv3': [8, 8], 'layer2.2.conv1': [8, 8], 'layer2.2.conv2': [8, 8], 'layer2.2.conv3': [8, 8], 'layer2.3.conv1': [8, 8], 'layer2.3.conv2': [8, 8], 'layer2.3.conv3': [8, 8], 'layer3.0.conv1': [8, 8], 'layer3.0.conv2': [8, 8], 'layer3.0.conv3': [8, 8], 'layer3.0.downsample.0': [8, 8], 'layer3.1.conv1': [8, 8], 'layer3.1.conv2': [8, 8], 'layer3.1.conv3': [8, 8], 'layer3.2.conv1': [8, 8], 'layer3.2.conv2': [8, 8], 'layer3.2.conv3': [8, 8], 'layer3.3.conv1': [8, 8], 'layer3.3.conv2': [8, 8], 'layer3.3.conv3': [8, 8], 'layer3.4.conv1': [8, 8], 'layer3.4.conv2': [8, 8], 'layer3.4.conv3': [8, 8], 'layer3.5.conv1': [8, 8], 'layer3.5.conv2': [8, 8], 'layer3.5.conv3': [8, 8], 'layer4.0.conv1': [8, 8], 'layer4.0.conv2': [8, 8], 'layer4.0.conv3': [8, 8], 'layer4.0.downsample.0': [8, 8], 'layer4.1.conv1': [8, 8], 'layer4.1.conv2': [8, 8], 'layer4.1.conv3': [8, 8], 'layer4.2.conv1': [8, 8], 'layer4.2.conv2': [8, 8], 'layer4.2.conv3': [8, 8], 'fc': [8, 8]}
Compression thr 0.13, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.13_loss, actual_compression 0.1321497475533474, expected loss 1.0947336941585546, actual acc 72.00000012207032, actual loss 1.0885665616989135
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Compression thr 0.14, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.14_loss, actual_compression 0.14243252349961294, expected loss 1.0426541119441988, actual acc 74.19999981689453, actual loss 1.017282751083374
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Compression thr 0.15000000000000002, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.15_loss, actual_compression 0.15151028663967547, expected loss 1.0241225868091584, actual acc 75.60000042724609, actual loss 0.9947649512290955
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Compression thr 0.16000000000000003, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.16_loss, actual_compression 0.16468509332082817, expected loss 1.008980658613205, actual acc 75.50000042724609, actual loss 0.968271390914917
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Compression thr 0.17000000000000004, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.17_loss, actual_compression 0.17014781804228174, expected loss 1.003960534893036, actual acc 76.30000006103515, actual loss 0.95357763671875
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Compression thr 0.18000000000000005, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.18_loss, actual_compression 0.1900706964381712, expected loss 0.9942879706249236, actual acc 76.49999908447266, actual loss 0.9332769351005554
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8']
Compression thr 0.19000000000000006, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.19_loss, actual_compression 0.1900706964381712, expected loss 0.9942879706249236, actual acc 76.49999908447266, actual loss 0.9332769351005554
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8']
Compression thr 0.20000000000000007, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.20_loss, actual_compression 0.20163881937771994, expected loss 0.9919000714645384, actual acc 76.60000006103516, actual loss 0.9274097137451172
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8']
Compression thr 0.21000000000000008, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.21_loss, actual_compression 0.21007390902114087, expected loss 0.9917300798473357, actual acc 77.49999969482423, actual loss 0.9088918318748475
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8']
Compression thr 0.22000000000000008, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.22_loss, actual_compression 0.22686375412090257, expected loss 0.9917260798473357, actual acc 77.39999969482422, actual loss 0.9056235027313232
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8']
Compression thr 0.2300000000000001, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.23_loss, actual_compression 0.23843187706045127, expected loss 0.9917250798473358, actual acc 78.00000030517577, actual loss 0.9064894299507141
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Compression thr 0.2400000000000001, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/resnet50_w8a8.adaquant/resnet.absorb_bn.mixed-ip-results.comp_0.24_loss, actual_compression 0.25, expected loss 0.9917240798473358, actual acc 78.20000030517578, actual loss 0.9015433168411255
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
