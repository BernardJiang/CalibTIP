step 1: 
step 2: 
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
read json file /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenetv2_adaquant.piano.kdp530.scaled.onnx.json
Json : Layer features.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.1.conv.1, precision switch from w8a8 to w8a8.
Json : Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.2.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.7.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.9.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.10.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.11.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.14.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.17.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.18.0, precision switch from w4a8 to w4a8.
Json : Layer classifier.1, precision switch from w8a8 to w8a8.
step 3: 
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
Input/outputs cached

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.before_adaquant.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.before_adaquant.onnx
Bernard calculate float point model accuracy before enabling quantization!
Bernard calculate fixed point model accuracy before training!

Optimize 0:features.0.0 for w8a8 bit of shape torch.Size([32, 3, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 1.631438e-05
MSE after  adaquant: 9.272825e-06
 End of training layer  features.0.0 better/total layers= 1 / 1 


Optimize 1:features.1.conv.0.0 for w4a8 bit of shape torch.Size([32, 1, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 9.646802e-04
MSE after  adaquant: 5.647871e-04
 End of training layer  features.1.conv.0.0 better/total layers= 2 / 2 


Optimize 2:features.1.conv.1 for w4a8 bit of shape torch.Size([16, 32, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 6.543267e-02
MSE after  adaquant: 2.088248e-02
 End of training layer  features.1.conv.1 better/total layers= 3 / 3 


Optimize 3:features.2.conv.0.0 for w4a8 bit of shape torch.Size([96, 16, 1, 1])

MSE before adaquant: 7.833323e-04
MSE after  adaquant: 6.677258e-04
 End of training layer  features.2.conv.0.0 better/total layers= 4 / 4 


Optimize 4:features.2.conv.1.0 for w4a8 bit of shape torch.Size([96, 1, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 6.436574e-05
MSE after  adaquant: 5.477600e-05
 End of training layer  features.2.conv.1.0 better/total layers= 5 / 5 


Optimize 5:features.2.conv.2 for w4a8 bit of shape torch.Size([24, 96, 1, 1])

MSE before adaquant: 1.396683e-01
MSE after  adaquant: 3.638500e-02
 End of training layer  features.2.conv.2 better/total layers= 6 / 6 


Optimize 6:features.3.conv.0.0 for w4a8 bit of shape torch.Size([144, 24, 1, 1])

MSE before adaquant: 5.149049e-04
MSE after  adaquant: 4.100840e-04
 End of training layer  features.3.conv.0.0 better/total layers= 7 / 7 


Optimize 7:features.3.conv.1.0 for w4a8 bit of shape torch.Size([144, 1, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 4.446507e-05
MSE after  adaquant: 3.614749e-05
 End of training layer  features.3.conv.1.0 better/total layers= 8 / 8 


Optimize 8:features.3.conv.2 for w4a8 bit of shape torch.Size([24, 144, 1, 1])

MSE before adaquant: 6.502376e-02
MSE after  adaquant: 2.189207e-02
 End of training layer  features.3.conv.2 better/total layers= 9 / 9 


Optimize 9:features.4.conv.0.0 for w4a8 bit of shape torch.Size([144, 24, 1, 1])

MSE before adaquant: 6.803544e-04
MSE after  adaquant: 4.721921e-04
 End of training layer  features.4.conv.0.0 better/total layers= 10 / 10 


Optimize 10:features.4.conv.1.0 for w4a8 bit of shape torch.Size([144, 1, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 1.610835e-05
MSE after  adaquant: 1.502425e-05
 End of training layer  features.4.conv.1.0 better/total layers= 11 / 11 


Optimize 11:features.4.conv.2 for w4a8 bit of shape torch.Size([32, 144, 1, 1])

MSE before adaquant: 7.018818e-02
MSE after  adaquant: 2.057488e-02
 End of training layer  features.4.conv.2 better/total layers= 12 / 12 


Optimize 12:features.5.conv.0.0 for w4a8 bit of shape torch.Size([192, 32, 1, 1])

MSE before adaquant: 2.427297e-04
MSE after  adaquant: 1.753196e-04
 End of training layer  features.5.conv.0.0 better/total layers= 13 / 13 


Optimize 13:features.5.conv.1.0 for w4a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 2.405615e-05
MSE after  adaquant: 2.051623e-05
 End of training layer  features.5.conv.1.0 better/total layers= 14 / 14 


Optimize 14:features.5.conv.2 for w4a8 bit of shape torch.Size([32, 192, 1, 1])

MSE before adaquant: 1.709363e-02
MSE after  adaquant: 6.773911e-03
 End of training layer  features.5.conv.2 better/total layers= 15 / 15 


Optimize 15:features.6.conv.0.0 for w4a8 bit of shape torch.Size([192, 32, 1, 1])

MSE before adaquant: 2.185030e-04
MSE after  adaquant: 1.725630e-04
 End of training layer  features.6.conv.0.0 better/total layers= 16 / 16 


Optimize 16:features.6.conv.1.0 for w4a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 1.228935e-05
MSE after  adaquant: 1.180211e-05
 End of training layer  features.6.conv.1.0 better/total layers= 17 / 17 


Optimize 17:features.6.conv.2 for w4a8 bit of shape torch.Size([32, 192, 1, 1])

MSE before adaquant: 2.365504e-02
MSE after  adaquant: 1.239618e-02
 End of training layer  features.6.conv.2 better/total layers= 18 / 18 


Optimize 18:features.7.conv.0.0 for w4a8 bit of shape torch.Size([192, 32, 1, 1])

MSE before adaquant: 4.017233e-04
MSE after  adaquant: 3.439107e-04
 End of training layer  features.7.conv.0.0 better/total layers= 19 / 19 


Optimize 19:features.7.conv.1.0 for w4a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 1.201400e-05
MSE after  adaquant: 1.381124e-05
 End of training layer  features.7.conv.1.0 better/total layers= 19 / 20 


Optimize 20:features.7.conv.2 for w4a8 bit of shape torch.Size([64, 192, 1, 1])

MSE before adaquant: 9.320033e-02
MSE after  adaquant: 2.445637e-02
 End of training layer  features.7.conv.2 better/total layers= 20 / 21 


Optimize 21:features.8.conv.0.0 for w4a8 bit of shape torch.Size([384, 64, 1, 1])

MSE before adaquant: 2.000649e-04
MSE after  adaquant: 1.302324e-04
 End of training layer  features.8.conv.0.0 better/total layers= 21 / 22 


Optimize 22:features.8.conv.1.0 for w4a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 2.591993e-05
MSE after  adaquant: 2.345278e-05
 End of training layer  features.8.conv.1.0 better/total layers= 22 / 23 


Optimize 23:features.8.conv.2 for w4a8 bit of shape torch.Size([64, 384, 1, 1])

MSE before adaquant: 1.336198e-02
MSE after  adaquant: 5.970781e-03
 End of training layer  features.8.conv.2 better/total layers= 23 / 24 


Optimize 24:features.9.conv.0.0 for w4a8 bit of shape torch.Size([384, 64, 1, 1])

MSE before adaquant: 1.744134e-04
MSE after  adaquant: 1.301197e-04
 End of training layer  features.9.conv.0.0 better/total layers= 24 / 25 


Optimize 25:features.9.conv.1.0 for w4a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 5.536566e-06
MSE after  adaquant: 4.284607e-06
 End of training layer  features.9.conv.1.0 better/total layers= 25 / 26 


Optimize 26:features.9.conv.2 for w4a8 bit of shape torch.Size([64, 384, 1, 1])

MSE before adaquant: 1.302507e-02
MSE after  adaquant: 5.211421e-03
 End of training layer  features.9.conv.2 better/total layers= 26 / 27 


Optimize 27:features.10.conv.0.0 for w4a8 bit of shape torch.Size([384, 64, 1, 1])

MSE before adaquant: 1.468754e-04
MSE after  adaquant: 1.114764e-04
 End of training layer  features.10.conv.0.0 better/total layers= 27 / 28 


Optimize 28:features.10.conv.1.0 for w4a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 5.784834e-06
MSE after  adaquant: 5.935969e-06
 End of training layer  features.10.conv.1.0 better/total layers= 27 / 29 


Optimize 29:features.10.conv.2 for w4a8 bit of shape torch.Size([64, 384, 1, 1])

MSE before adaquant: 3.223633e-02
MSE after  adaquant: 1.905840e-02
 End of training layer  features.10.conv.2 better/total layers= 28 / 30 


Optimize 30:features.11.conv.0.0 for w4a8 bit of shape torch.Size([384, 64, 1, 1])

MSE before adaquant: 3.021387e-04
MSE after  adaquant: 2.226795e-04
 End of training layer  features.11.conv.0.0 better/total layers= 29 / 31 


Optimize 31:features.11.conv.1.0 for w4a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 1.785912e-05
MSE after  adaquant: 1.587019e-05
 End of training layer  features.11.conv.1.0 better/total layers= 30 / 32 


Optimize 32:features.11.conv.2 for w4a8 bit of shape torch.Size([96, 384, 1, 1])

MSE before adaquant: 2.767644e-02
MSE after  adaquant: 8.343322e-03
 End of training layer  features.11.conv.2 better/total layers= 31 / 33 


Optimize 33:features.12.conv.0.0 for w4a8 bit of shape torch.Size([576, 96, 1, 1])

MSE before adaquant: 1.981954e-04
MSE after  adaquant: 1.294469e-04
 End of training layer  features.12.conv.0.0 better/total layers= 32 / 34 


Optimize 34:features.12.conv.1.0 for w4a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 3.486617e-05
MSE after  adaquant: 3.450787e-05
 End of training layer  features.12.conv.1.0 better/total layers= 33 / 35 


Optimize 35:features.12.conv.2 for w4a8 bit of shape torch.Size([96, 576, 1, 1])

MSE before adaquant: 3.021476e-02
MSE after  adaquant: 1.030402e-02
 End of training layer  features.12.conv.2 better/total layers= 34 / 36 


Optimize 36:features.13.conv.0.0 for w4a8 bit of shape torch.Size([576, 96, 1, 1])

MSE before adaquant: 1.852985e-04
MSE after  adaquant: 1.353582e-04
 End of training layer  features.13.conv.0.0 better/total layers= 35 / 37 


Optimize 37:features.13.conv.1.0 for w4a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 5.381021e-05
MSE after  adaquant: 5.597329e-05
 End of training layer  features.13.conv.1.0 better/total layers= 35 / 38 


Optimize 38:features.13.conv.2 for w4a8 bit of shape torch.Size([96, 576, 1, 1])

MSE before adaquant: 6.039220e-02
MSE after  adaquant: 2.630078e-02
 End of training layer  features.13.conv.2 better/total layers= 36 / 39 


Optimize 39:features.14.conv.0.0 for w4a8 bit of shape torch.Size([576, 96, 1, 1])

MSE before adaquant: 4.516496e-04
MSE after  adaquant: 3.216421e-04
 End of training layer  features.14.conv.0.0 better/total layers= 37 / 40 


Optimize 40:features.14.conv.1.0 for w4a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 2.032649e-03
MSE after  adaquant: 2.021932e-03
 End of training layer  features.14.conv.1.0 better/total layers= 38 / 41 


Optimize 41:features.14.conv.2 for w4a8 bit of shape torch.Size([160, 576, 1, 1])

MSE before adaquant: 4.949150e-02
MSE after  adaquant: 1.810206e-02
 End of training layer  features.14.conv.2 better/total layers= 39 / 42 


Optimize 42:features.15.conv.0.0 for w4a8 bit of shape torch.Size([960, 160, 1, 1])

MSE before adaquant: 1.340090e-03
MSE after  adaquant: 8.236408e-04
 End of training layer  features.15.conv.0.0 better/total layers= 40 / 43 


Optimize 43:features.15.conv.1.0 for w4a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 8.699135e-04
MSE after  adaquant: 8.674962e-04
 End of training layer  features.15.conv.1.0 better/total layers= 41 / 44 


Optimize 44:features.15.conv.2 for w4a8 bit of shape torch.Size([160, 960, 1, 1])

MSE before adaquant: 3.750773e-02
MSE after  adaquant: 2.357954e-02
 End of training layer  features.15.conv.2 better/total layers= 42 / 45 


Optimize 45:features.16.conv.0.0 for w4a8 bit of shape torch.Size([960, 160, 1, 1])

MSE before adaquant: 1.364994e-03
MSE after  adaquant: 7.905704e-04
 End of training layer  features.16.conv.0.0 better/total layers= 43 / 46 


Optimize 46:features.16.conv.1.0 for w4a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 1.278985e-03
MSE after  adaquant: 1.270293e-03
 End of training layer  features.16.conv.1.0 better/total layers= 44 / 47 


Optimize 47:features.16.conv.2 for w4a8 bit of shape torch.Size([160, 960, 1, 1])

MSE before adaquant: 1.211259e-01
MSE after  adaquant: 8.437283e-02
 End of training layer  features.16.conv.2 better/total layers= 45 / 48 


Optimize 48:features.17.conv.0.0 for w4a8 bit of shape torch.Size([960, 160, 1, 1])

MSE before adaquant: 3.013339e-04
MSE after  adaquant: 1.683667e-04
 End of training layer  features.17.conv.0.0 better/total layers= 46 / 49 


Optimize 49:features.17.conv.1.0 for w4a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 1.802444e-05
MSE after  adaquant: 1.947647e-05
 End of training layer  features.17.conv.1.0 better/total layers= 46 / 50 


Optimize 50:features.17.conv.2 for w4a8 bit of shape torch.Size([320, 960, 1, 1])

MSE before adaquant: 8.088599e-02
MSE after  adaquant: 1.690782e-02
 End of training layer  features.17.conv.2 better/total layers= 47 / 51 


Optimize 51:features.18.0 for w8a8 bit of shape torch.Size([1280, 320, 1, 1])

MSE before adaquant: 4.704648e-02
MSE after  adaquant: 3.879050e-02
 End of training layer  features.18.0 better/total layers= 48 / 52 


Optimize 52:classifier.1 for w8a8 bit of shape torch.Size([1000, 1280])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 9.319914e-04
MSE after  adaquant: 5.625761e-04
 End of training layer  classifier.1 better/total layers= 49 / 53 

step 1: 
step 2: 
Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.2.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.7.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.9.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.10.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.11.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.14.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
read json file /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenetv2_adaquant.piano.kdp530.scaled.onnx.json
Json : Layer features.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.1.conv.1, precision switch from w8a8 to w8a8.
Json : Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.2.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.2.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.3.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.4.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.5.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.6.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.7.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.7.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.8.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.9.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.9.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.10.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.10.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.11.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.11.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.12.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.13.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.14.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.14.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.15.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.16.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.17.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.18.0, precision switch from w8a8 to w8a8.
Json : Layer classifier.1, precision switch from w8a8 to w8a8.
step 3: 
Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.2.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.7.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.9.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.10.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.11.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.14.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
Input/outputs cached

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.before_adaquant.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.before_adaquant.onnx
Bernard calculate float point model accuracy before enabling quantization!
Bernard calculate fixed point model accuracy before training!

Optimize 0:features.0.0 for w8a8 bit of shape torch.Size([32, 3, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 1.631438e-05
MSE after  adaquant: 1.054845e-05
 End of training layer  features.0.0 better/total layers= 1 / 1 


Optimize 1:features.1.conv.0.0 for w8a8 bit of shape torch.Size([32, 1, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 9.646802e-04
MSE after  adaquant: 5.647871e-04
 End of training layer  features.1.conv.0.0 better/total layers= 2 / 2 


Optimize 2:features.1.conv.1 for w8a8 bit of shape torch.Size([16, 32, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 4.958804e-04
MSE after  adaquant: 3.800871e-04
 End of training layer  features.1.conv.1 better/total layers= 3 / 3 


Optimize 3:features.2.conv.0.0 for w8a8 bit of shape torch.Size([96, 16, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 3.071409e-05
MSE after  adaquant: 3.050721e-05
 End of training layer  features.2.conv.0.0 better/total layers= 4 / 4 


Optimize 4:features.2.conv.1.0 for w8a8 bit of shape torch.Size([96, 1, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 6.436574e-05
MSE after  adaquant: 5.477600e-05
 End of training layer  features.2.conv.1.0 better/total layers= 5 / 5 


Optimize 5:features.2.conv.2 for w8a8 bit of shape torch.Size([24, 96, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 6.989302e-04
MSE after  adaquant: 2.297985e-04
 End of training layer  features.2.conv.2 better/total layers= 6 / 6 


Optimize 6:features.3.conv.0.0 for w8a8 bit of shape torch.Size([144, 24, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 2.127202e-05
MSE after  adaquant: 2.627670e-05
 End of training layer  features.3.conv.0.0 better/total layers= 6 / 7 


Optimize 7:features.3.conv.1.0 for w8a8 bit of shape torch.Size([144, 1, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 4.446507e-05
MSE after  adaquant: 3.614749e-05
 End of training layer  features.3.conv.1.0 better/total layers= 7 / 8 


Optimize 8:features.3.conv.2 for w8a8 bit of shape torch.Size([24, 144, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 3.841969e-04
MSE after  adaquant: 2.345287e-04
 End of training layer  features.3.conv.2 better/total layers= 8 / 9 


Optimize 9:features.4.conv.0.0 for w8a8 bit of shape torch.Size([144, 24, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 9.707544e-06
MSE after  adaquant: 1.081045e-05
 End of training layer  features.4.conv.0.0 better/total layers= 8 / 10 


Optimize 10:features.4.conv.1.0 for w8a8 bit of shape torch.Size([144, 1, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 1.610835e-05
MSE after  adaquant: 1.502425e-05
 End of training layer  features.4.conv.1.0 better/total layers= 9 / 11 


Optimize 11:features.4.conv.2 for w8a8 bit of shape torch.Size([32, 144, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 3.443213e-04
MSE after  adaquant: 1.425408e-04
 End of training layer  features.4.conv.2 better/total layers= 10 / 12 


Optimize 12:features.5.conv.0.0 for w8a8 bit of shape torch.Size([192, 32, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 2.855459e-06
MSE after  adaquant: 3.145683e-06
 End of training layer  features.5.conv.0.0 better/total layers= 10 / 13 


Optimize 13:features.5.conv.1.0 for w8a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 2.405615e-05
MSE after  adaquant: 2.051623e-05
 End of training layer  features.5.conv.1.0 better/total layers= 11 / 14 


Optimize 14:features.5.conv.2 for w8a8 bit of shape torch.Size([32, 192, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 1.084301e-04
MSE after  adaquant: 8.752126e-05
 End of training layer  features.5.conv.2 better/total layers= 12 / 15 


Optimize 15:features.6.conv.0.0 for w8a8 bit of shape torch.Size([192, 32, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 2.557782e-06
MSE after  adaquant: 3.432980e-06
 End of training layer  features.6.conv.0.0 better/total layers= 12 / 16 


Optimize 16:features.6.conv.1.0 for w8a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 1.228935e-05
MSE after  adaquant: 1.180211e-05
 End of training layer  features.6.conv.1.0 better/total layers= 13 / 17 


Optimize 17:features.6.conv.2 for w8a8 bit of shape torch.Size([32, 192, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 1.262818e-04
MSE after  adaquant: 7.291495e-05
 End of training layer  features.6.conv.2 better/total layers= 14 / 18 


Optimize 18:features.7.conv.0.0 for w8a8 bit of shape torch.Size([192, 32, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 4.909775e-06
MSE after  adaquant: 5.553388e-06
 End of training layer  features.7.conv.0.0 better/total layers= 14 / 19 


Optimize 19:features.7.conv.1.0 for w8a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 1.201400e-05
MSE after  adaquant: 1.381124e-05
 End of training layer  features.7.conv.1.0 better/total layers= 14 / 20 


Optimize 20:features.7.conv.2 for w8a8 bit of shape torch.Size([64, 192, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 4.447242e-04
MSE after  adaquant: 2.033882e-04
 End of training layer  features.7.conv.2 better/total layers= 15 / 21 


Optimize 21:features.8.conv.0.0 for w8a8 bit of shape torch.Size([384, 64, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 1.688755e-06
MSE after  adaquant: 1.765536e-06
 End of training layer  features.8.conv.0.0 better/total layers= 15 / 22 


Optimize 22:features.8.conv.1.0 for w8a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 2.591993e-05
MSE after  adaquant: 2.345278e-05
 End of training layer  features.8.conv.1.0 better/total layers= 16 / 23 


Optimize 23:features.8.conv.2 for w8a8 bit of shape torch.Size([64, 384, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 2.407170e-04
MSE after  adaquant: 1.762355e-04
 End of training layer  features.8.conv.2 better/total layers= 17 / 24 


Optimize 24:features.9.conv.0.0 for w8a8 bit of shape torch.Size([384, 64, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 1.579727e-06
MSE after  adaquant: 1.696131e-06
 End of training layer  features.9.conv.0.0 better/total layers= 17 / 25 


Optimize 25:features.9.conv.1.0 for w8a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 5.536566e-06
MSE after  adaquant: 4.284607e-06
 End of training layer  features.9.conv.1.0 better/total layers= 18 / 26 


Optimize 26:features.9.conv.2 for w8a8 bit of shape torch.Size([64, 384, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 7.018702e-05
MSE after  adaquant: 3.791812e-05
 End of training layer  features.9.conv.2 better/total layers= 19 / 27 


Optimize 27:features.10.conv.0.0 for w8a8 bit of shape torch.Size([384, 64, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 1.410621e-06
MSE after  adaquant: 1.561295e-06
 End of training layer  features.10.conv.0.0 better/total layers= 19 / 28 


Optimize 28:features.10.conv.1.0 for w8a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 5.784834e-06
MSE after  adaquant: 5.935969e-06
 End of training layer  features.10.conv.1.0 better/total layers= 19 / 29 


Optimize 29:features.10.conv.2 for w8a8 bit of shape torch.Size([64, 384, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 4.351272e-04
MSE after  adaquant: 4.851776e-04
 End of training layer  features.10.conv.2 better/total layers= 19 / 30 


Optimize 30:features.11.conv.0.0 for w8a8 bit of shape torch.Size([384, 64, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 6.437870e-06
MSE after  adaquant: 6.698818e-06
 End of training layer  features.11.conv.0.0 better/total layers= 19 / 31 


Optimize 31:features.11.conv.1.0 for w8a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 1.785912e-05
MSE after  adaquant: 1.587019e-05
 End of training layer  features.11.conv.1.0 better/total layers= 20 / 32 


Optimize 32:features.11.conv.2 for w8a8 bit of shape torch.Size([96, 384, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 1.666072e-04
MSE after  adaquant: 8.871711e-05
 End of training layer  features.11.conv.2 better/total layers= 21 / 33 


Optimize 33:features.12.conv.0.0 for w8a8 bit of shape torch.Size([576, 96, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 2.455865e-06
MSE after  adaquant: 2.733796e-06
 End of training layer  features.12.conv.0.0 better/total layers= 21 / 34 


Optimize 34:features.12.conv.1.0 for w8a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 3.486617e-05
MSE after  adaquant: 3.450787e-05
 End of training layer  features.12.conv.1.0 better/total layers= 22 / 35 


Optimize 35:features.12.conv.2 for w8a8 bit of shape torch.Size([96, 576, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 4.859696e-04
MSE after  adaquant: 3.746416e-04
 End of training layer  features.12.conv.2 better/total layers= 23 / 36 


Optimize 36:features.13.conv.0.0 for w8a8 bit of shape torch.Size([576, 96, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 3.020513e-06
MSE after  adaquant: 2.870311e-06
 End of training layer  features.13.conv.0.0 better/total layers= 24 / 37 


Optimize 37:features.13.conv.1.0 for w8a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 5.381021e-05
MSE after  adaquant: 5.597329e-05
 End of training layer  features.13.conv.1.0 better/total layers= 24 / 38 


Optimize 38:features.13.conv.2 for w8a8 bit of shape torch.Size([96, 576, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 4.138238e-03
MSE after  adaquant: 3.146898e-03
 End of training layer  features.13.conv.2 better/total layers= 25 / 39 


Optimize 39:features.14.conv.0.0 for w8a8 bit of shape torch.Size([576, 96, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 1.950899e-04
MSE after  adaquant: 1.167408e-04
 End of training layer  features.14.conv.0.0 better/total layers= 26 / 40 


Optimize 40:features.14.conv.1.0 for w8a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 2.032649e-03
MSE after  adaquant: 2.021932e-03
 End of training layer  features.14.conv.1.0 better/total layers= 27 / 41 


Optimize 41:features.14.conv.2 for w8a8 bit of shape torch.Size([160, 576, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 1.342546e-02
MSE after  adaquant: 7.290782e-03
 End of training layer  features.14.conv.2 better/total layers= 28 / 42 


Optimize 42:features.15.conv.0.0 for w8a8 bit of shape torch.Size([960, 160, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 1.120400e-03
MSE after  adaquant: 5.767153e-04
 End of training layer  features.15.conv.0.0 better/total layers= 29 / 43 


Optimize 43:features.15.conv.1.0 for w8a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 8.699135e-04
MSE after  adaquant: 8.674962e-04
 End of training layer  features.15.conv.1.0 better/total layers= 30 / 44 


Optimize 44:features.15.conv.2 for w8a8 bit of shape torch.Size([160, 960, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 2.155115e-02
MSE after  adaquant: 1.567274e-02
 End of training layer  features.15.conv.2 better/total layers= 31 / 45 


Optimize 45:features.16.conv.0.0 for w8a8 bit of shape torch.Size([960, 160, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 1.183445e-03
MSE after  adaquant: 5.634468e-04
 End of training layer  features.16.conv.0.0 better/total layers= 32 / 46 


Optimize 46:features.16.conv.1.0 for w8a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 1.278985e-03
MSE after  adaquant: 1.270293e-03
 End of training layer  features.16.conv.1.0 better/total layers= 33 / 47 


Optimize 47:features.16.conv.2 for w8a8 bit of shape torch.Size([160, 960, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 9.961963e-02
MSE after  adaquant: 7.369476e-02
 End of training layer  features.16.conv.2 better/total layers= 34 / 48 


Optimize 48:features.17.conv.0.0 for w8a8 bit of shape torch.Size([960, 160, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 2.120701e-04
MSE after  adaquant: 9.005047e-05
 End of training layer  features.17.conv.0.0 better/total layers= 35 / 49 


Optimize 49:features.17.conv.1.0 for w8a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 1.802444e-05
MSE after  adaquant: 1.947647e-05
 End of training layer  features.17.conv.1.0 better/total layers= 35 / 50 


Optimize 50:features.17.conv.2 for w8a8 bit of shape torch.Size([320, 960, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 7.180021e-04
MSE after  adaquant: 4.811998e-04
 End of training layer  features.17.conv.2 better/total layers= 36 / 51 


Optimize 51:features.18.0 for w8a8 bit of shape torch.Size([1280, 320, 1, 1])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 3.399708e-04
MSE after  adaquant: 3.308556e-04
 End of training layer  features.18.0 better/total layers= 37 / 52 


Optimize 52:classifier.1 for w8a8 bit of shape torch.Size([1000, 1280])
8-bit layer should use smaller LR = 0.0001

MSE before adaquant: 9.319914e-04
MSE after  adaquant: 5.625761e-04
 End of training layer  classifier.1 better/total layers= 38 / 53 

step 4
Train: ########### All 8bit results ###########
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
finished 0 out of 50
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
finished 1 out of 50
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
finished 2 out of 50
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w8a8 to w8a8.
finished 3 out of 50
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
finished 4 out of 50
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
finished 5 out of 50
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
finished 6 out of 50
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
finished 7 out of 50
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
finished 8 out of 50
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
finished 9 out of 50
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
finished 10 out of 50
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
finished 11 out of 50
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
finished 12 out of 50
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
finished 13 out of 50
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
finished 14 out of 50
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
finished 15 out of 50
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
finished 16 out of 50
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
finished 17 out of 50
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w8a8 to w8a8.
finished 18 out of 50
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
finished 19 out of 50
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
finished 20 out of 50
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
finished 21 out of 50
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
finished 22 out of 50
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
finished 23 out of 50
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w8a8 to w8a8.
finished 24 out of 50
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
finished 25 out of 50
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
finished 26 out of 50
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w8a8 to w8a8.
finished 27 out of 50
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
finished 28 out of 50
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
finished 29 out of 50
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w8a8 to w8a8.
finished 30 out of 50
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
finished 31 out of 50
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
finished 32 out of 50
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
finished 33 out of 50
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
finished 34 out of 50
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
finished 35 out of 50
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
finished 36 out of 50
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
finished 37 out of 50
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
finished 38 out of 50
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w8a8 to w8a8.
finished 39 out of 50
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
finished 40 out of 50
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
finished 41 out of 50
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
finished 42 out of 50
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
finished 43 out of 50
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
finished 44 out of 50
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
finished 45 out of 50
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
finished 46 out of 50
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
finished 47 out of 50
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
finished 48 out of 50
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
step 5
Found K = 43
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Achieved compression:  0.1332099886696761
Expected acc:  2.136982665485384
Params % in int 4 = 0.9343200906425912
Params % in int 8 = 0.06567990935740878
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.0.0 to w4a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.0.0 to w4a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.0.0 to w4a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
switched layer features.5.conv.2 to w4a8
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.0.0 to w4a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
switched layer features.6.conv.2 to w4a8
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.0.0 to w4a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
switched layer features.10.conv.2 to w4a8
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.0.0 to w4a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
switched layer features.11.conv.2 to w4a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
switched layer features.13.conv.2 to w4a8
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.0.0 to w4a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
switched layer features.15.conv.2 to w4a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.0.0 to w4a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
switched layer features.17.conv.2 to w4a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.1332099886696761, expected loss 2.136982665485384, actual acc 35.9, actual loss 3.087179172515869
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Found K = 36
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Achieved compression:  0.14294867183425355
Expected acc:  1.819670585817338
Params % in int 4 = 0.8564106253259717
Params % in int 8 = 0.14358937467402838
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.0.0 to w4a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.0.0 to w4a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.0.0 to w4a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.0.0 to w4a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.0.0 to w4a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
switched layer features.15.conv.2 to w4a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.0.0 to w4a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
switched layer features.17.conv.2 to w4a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.1332099886696761, expected loss 2.136982665485384, actual acc 35.9, actual loss 3.087179172515869
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14294867183425355, expected loss 1.819670585817338, actual acc 52.099999969482425, actual loss 2.050087553024292
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Found K = 33
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Achieved compression:  0.15805577037210222
Expected acc:  1.6254024605216988
Params % in int 4 = 0.7355538370231822
Params % in int 8 = 0.2644461629768178
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.0.0 to w4a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.0.0 to w4a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.0.0 to w4a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
switched layer features.12.conv.2 to w8a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.0.0 to w4a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.0.0 to w4a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
switched layer features.17.conv.2 to w4a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.1332099886696761, expected loss 2.136982665485384, actual acc 35.9, actual loss 3.087179172515869
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14294867183425355, expected loss 1.819670585817338, actual acc 52.099999969482425, actual loss 2.050087553024292
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.15805577037210222, expected loss 1.6254024605216988, actual acc 60.199999938964844, actual loss 1.6454819574356079
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Found K = 31
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Achieved compression:  0.16366697840044603
Expected acc:  1.5664973120155339
Params % in int 4 = 0.6906641727964319
Params % in int 8 = 0.30933582720356817
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.0.0 to w4a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.0.0 to w4a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.0.0 to w4a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
switched layer features.12.conv.2 to w8a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.0.0 to w4a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
switched layer features.17.conv.2 to w4a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.1332099886696761, expected loss 2.136982665485384, actual acc 35.9, actual loss 3.087179172515869
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14294867183425355, expected loss 1.819670585817338, actual acc 52.099999969482425, actual loss 2.050087553024292
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.15805577037210222, expected loss 1.6254024605216988, actual acc 60.199999938964844, actual loss 1.6454819574356079
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16366697840044603, expected loss 1.5664973120155339, actual acc 61.699999938964844, actual loss 1.5792326784133912
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Found K = 28
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Achieved compression:  0.18870159883459525
Expected acc:  1.3825055639209751
Params % in int 4 = 0.490387209323238
Params % in int 8 = 0.509612790676762
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.0.0 to w4a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.0.0 to w4a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
switched layer features.12.conv.2 to w8a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.0.0 to w4a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.1332099886696761, expected loss 2.136982665485384, actual acc 35.9, actual loss 3.087179172515869
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14294867183425355, expected loss 1.819670585817338, actual acc 52.099999969482425, actual loss 2.050087553024292
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.15805577037210222, expected loss 1.6254024605216988, actual acc 60.199999938964844, actual loss 1.6454819574356079
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16366697840044603, expected loss 1.5664973120155339, actual acc 61.699999938964844, actual loss 1.5792326784133912
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.18870159883459525, expected loss 1.3825055639209751, actual acc 67.0999994506836, actual loss 1.3425860261917115
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Found K = 28
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Achieved compression:  0.18870159883459525
Expected acc:  1.3825055639209751
Params % in int 4 = 0.490387209323238
Params % in int 8 = 0.509612790676762
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.0.0 to w4a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.0.0 to w4a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
switched layer features.12.conv.2 to w8a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.0.0 to w4a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.1332099886696761, expected loss 2.136982665485384, actual acc 35.9, actual loss 3.087179172515869
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14294867183425355, expected loss 1.819670585817338, actual acc 52.099999969482425, actual loss 2.050087553024292
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.15805577037210222, expected loss 1.6254024605216988, actual acc 60.199999938964844, actual loss 1.6454819574356079
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16366697840044603, expected loss 1.5664973120155339, actual acc 61.699999938964844, actual loss 1.5792326784133912
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.18870159883459525, expected loss 1.3825055639209751, actual acc 67.0999994506836, actual loss 1.3425860261917115
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.18870159883459525, expected loss 1.3825055639209751, actual acc 67.0999994506836, actual loss 1.3425860261917115
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Found K = 27
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Achieved compression:  0.19949238350448717
Expected acc:  1.3202443639698032
Params % in int 4 = 0.40406093196410264
Params % in int 8 = 0.5959390680358974
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.0.0 to w4a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.0.0 to w4a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
switched layer features.12.conv.2 to w8a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.1332099886696761, expected loss 2.136982665485384, actual acc 35.9, actual loss 3.087179172515869
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14294867183425355, expected loss 1.819670585817338, actual acc 52.099999969482425, actual loss 2.050087553024292
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.15805577037210222, expected loss 1.6254024605216988, actual acc 60.199999938964844, actual loss 1.6454819574356079
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16366697840044603, expected loss 1.5664973120155339, actual acc 61.699999938964844, actual loss 1.5792326784133912
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.18870159883459525, expected loss 1.3825055639209751, actual acc 67.0999994506836, actual loss 1.3425860261917115
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.18870159883459525, expected loss 1.3825055639209751, actual acc 67.0999994506836, actual loss 1.3425860261917115
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.19949238350448717, expected loss 1.3202443639698032, actual acc 69.19999990844727, actual loss 1.2774370002746582
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Found K = 26
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Achieved compression:  0.2102831681743791
Expected acc:  1.2971676389636995
Params % in int 4 = 0.31773465460496736
Params % in int 8 = 0.6822653453950327
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.0.0 to w4a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.0.0 to w4a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
switched layer features.12.conv.2 to w8a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.1332099886696761, expected loss 2.136982665485384, actual acc 35.9, actual loss 3.087179172515869
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14294867183425355, expected loss 1.819670585817338, actual acc 52.099999969482425, actual loss 2.050087553024292
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.15805577037210222, expected loss 1.6254024605216988, actual acc 60.199999938964844, actual loss 1.6454819574356079
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16366697840044603, expected loss 1.5664973120155339, actual acc 61.699999938964844, actual loss 1.5792326784133912
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.18870159883459525, expected loss 1.3825055639209751, actual acc 67.0999994506836, actual loss 1.3425860261917115
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.18870159883459525, expected loss 1.3825055639209751, actual acc 67.0999994506836, actual loss 1.3425860261917115
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.19949238350448717, expected loss 1.3202443639698032, actual acc 69.19999990844727, actual loss 1.2774370002746582
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.2102831681743791, expected loss 1.2971676389636995, actual acc 69.4999997253418, actual loss 1.209330870628357
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Found K = 26
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Achieved compression:  0.2102831681743791
Expected acc:  1.2971676389636995
Params % in int 4 = 0.31773465460496736
Params % in int 8 = 0.6822653453950327
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.0.0 to w4a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.0.0 to w4a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
switched layer features.12.conv.2 to w8a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.1332099886696761, expected loss 2.136982665485384, actual acc 35.9, actual loss 3.087179172515869
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14294867183425355, expected loss 1.819670585817338, actual acc 52.099999969482425, actual loss 2.050087553024292
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.15805577037210222, expected loss 1.6254024605216988, actual acc 60.199999938964844, actual loss 1.6454819574356079
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16366697840044603, expected loss 1.5664973120155339, actual acc 61.699999938964844, actual loss 1.5792326784133912
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.18870159883459525, expected loss 1.3825055639209751, actual acc 67.0999994506836, actual loss 1.3425860261917115
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.18870159883459525, expected loss 1.3825055639209751, actual acc 67.0999994506836, actual loss 1.3425860261917115
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.19949238350448717, expected loss 1.3202443639698032, actual acc 69.19999990844727, actual loss 1.2774370002746582
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.2102831681743791, expected loss 1.2971676389636995, actual acc 69.4999997253418, actual loss 1.209330870628357
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.21, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss, compression 0.2102831681743791, expected loss 1.2971676389636995, actual acc 69.4999997253418, actual loss 1.209330870628357
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Found K = 24
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Achieved compression:  0.2249586353254321
Expected acc:  1.2722475211086273
Params % in int 4 = 0.20033091739654335
Params % in int 8 = 0.7996690826034566
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.0.0 to w4a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.0.0 to w4a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.0.0 to w8a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
switched layer features.12.conv.2 to w8a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.16.conv.0.0 to w8a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.1332099886696761, expected loss 2.136982665485384, actual acc 35.9, actual loss 3.087179172515869
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14294867183425355, expected loss 1.819670585817338, actual acc 52.099999969482425, actual loss 2.050087553024292
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.15805577037210222, expected loss 1.6254024605216988, actual acc 60.199999938964844, actual loss 1.6454819574356079
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16366697840044603, expected loss 1.5664973120155339, actual acc 61.699999938964844, actual loss 1.5792326784133912
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.18870159883459525, expected loss 1.3825055639209751, actual acc 67.0999994506836, actual loss 1.3425860261917115
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.18870159883459525, expected loss 1.3825055639209751, actual acc 67.0999994506836, actual loss 1.3425860261917115
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.19949238350448717, expected loss 1.3202443639698032, actual acc 69.19999990844727, actual loss 1.2774370002746582
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.2102831681743791, expected loss 1.2971676389636995, actual acc 69.4999997253418, actual loss 1.209330870628357
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.21, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss, compression 0.2102831681743791, expected loss 1.2971676389636995, actual acc 69.4999997253418, actual loss 1.209330870628357
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.22, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss, compression 0.2249586353254321, expected loss 1.2722475211086273, actual acc 70.70000006103515, actual loss 1.1754943475723267
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Found K = 22
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Achieved compression:  0.23056984335377587
Expected acc:  1.264903263277054
Params % in int 4 = 0.155441253169793
Params % in int 8 = 0.844558746830207
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.0.0 to w4a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.0.0 to w4a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.0.0 to w8a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.0.0 to w8a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
switched layer features.12.conv.2 to w8a8
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.0.0 to w8a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.16.conv.0.0 to w8a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.23_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.23_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.1332099886696761, expected loss 2.136982665485384, actual acc 35.9, actual loss 3.087179172515869
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14294867183425355, expected loss 1.819670585817338, actual acc 52.099999969482425, actual loss 2.050087553024292
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.15805577037210222, expected loss 1.6254024605216988, actual acc 60.199999938964844, actual loss 1.6454819574356079
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16366697840044603, expected loss 1.5664973120155339, actual acc 61.699999938964844, actual loss 1.5792326784133912
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.18870159883459525, expected loss 1.3825055639209751, actual acc 67.0999994506836, actual loss 1.3425860261917115
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.18870159883459525, expected loss 1.3825055639209751, actual acc 67.0999994506836, actual loss 1.3425860261917115
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.19949238350448717, expected loss 1.3202443639698032, actual acc 69.19999990844727, actual loss 1.2774370002746582
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.2102831681743791, expected loss 1.2971676389636995, actual acc 69.4999997253418, actual loss 1.209330870628357
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.21, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss, compression 0.2102831681743791, expected loss 1.2971676389636995, actual acc 69.4999997253418, actual loss 1.209330870628357
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.22, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss, compression 0.2249586353254321, expected loss 1.2722475211086273, actual acc 70.70000006103515, actual loss 1.1754943475723267
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.23, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.23_loss, compression 0.23056984335377587, expected loss 1.264903263277054, actual acc 72.39999890136718, actual loss 1.1617086496353148
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Found K = 20
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Achieved compression:  0.24160342067874035
Expected acc:  1.2587732593479155
Params % in int 4 = 0.06717263457007716
Params % in int 8 = 0.9328273654299228
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.0.0 to w4a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.0.0 to w8a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.0.0 to w8a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
switched layer features.12.conv.2 to w8a8
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.0.0 to w8a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.15.conv.0.0 to w8a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.16.conv.0.0 to w8a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.24_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.24_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.1332099886696761, expected loss 2.136982665485384, actual acc 35.9, actual loss 3.087179172515869
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14294867183425355, expected loss 1.819670585817338, actual acc 52.099999969482425, actual loss 2.050087553024292
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.15805577037210222, expected loss 1.6254024605216988, actual acc 60.199999938964844, actual loss 1.6454819574356079
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16366697840044603, expected loss 1.5664973120155339, actual acc 61.699999938964844, actual loss 1.5792326784133912
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.18870159883459525, expected loss 1.3825055639209751, actual acc 67.0999994506836, actual loss 1.3425860261917115
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.18870159883459525, expected loss 1.3825055639209751, actual acc 67.0999994506836, actual loss 1.3425860261917115
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.19949238350448717, expected loss 1.3202443639698032, actual acc 69.19999990844727, actual loss 1.2774370002746582
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.2102831681743791, expected loss 1.2971676389636995, actual acc 69.4999997253418, actual loss 1.209330870628357
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.21, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss, compression 0.2102831681743791, expected loss 1.2971676389636995, actual acc 69.4999997253418, actual loss 1.209330870628357
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.22, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss, compression 0.2249586353254321, expected loss 1.2722475211086273, actual acc 70.70000006103515, actual loss 1.1754943475723267
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.23, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.23_loss, compression 0.23056984335377587, expected loss 1.264903263277054, actual acc 72.39999890136718, actual loss 1.1617086496353148
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.24, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.24_loss, compression 0.24160342067874035, expected loss 1.2587732593479155, actual acc 72.09999890136719, actual loss 1.138713939666748
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.13, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, actual_compression 0.1332099886696761, expected loss 2.136982665485384, actual acc 35.9, actual loss 3.087179172515869
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Compression thr 0.14, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, actual_compression 0.14294867183425355, expected loss 1.819670585817338, actual acc 52.099999969482425, actual loss 2.050087553024292
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Compression thr 0.15000000000000002, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, actual_compression 0.15805577037210222, expected loss 1.6254024605216988, actual acc 60.199999938964844, actual loss 1.6454819574356079
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Compression thr 0.16000000000000003, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, actual_compression 0.16366697840044603, expected loss 1.5664973120155339, actual acc 61.699999938964844, actual loss 1.5792326784133912
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Compression thr 0.17000000000000004, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, actual_compression 0.18870159883459525, expected loss 1.3825055639209751, actual acc 67.0999994506836, actual loss 1.3425860261917115
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Compression thr 0.18000000000000005, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, actual_compression 0.18870159883459525, expected loss 1.3825055639209751, actual acc 67.0999994506836, actual loss 1.3425860261917115
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Compression thr 0.19000000000000006, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, actual_compression 0.19949238350448717, expected loss 1.3202443639698032, actual acc 69.19999990844727, actual loss 1.2774370002746582
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Compression thr 0.20000000000000007, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, actual_compression 0.2102831681743791, expected loss 1.2971676389636995, actual acc 69.4999997253418, actual loss 1.209330870628357
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Compression thr 0.21000000000000008, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss, actual_compression 0.2102831681743791, expected loss 1.2971676389636995, actual acc 69.4999997253418, actual loss 1.209330870628357
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Compression thr 0.22000000000000008, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss, actual_compression 0.2249586353254321, expected loss 1.2722475211086273, actual acc 70.70000006103515, actual loss 1.1754943475723267
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Compression thr 0.2300000000000001, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.23_loss, actual_compression 0.23056984335377587, expected loss 1.264903263277054, actual acc 72.39999890136718, actual loss 1.1617086496353148
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Compression thr 0.2400000000000001, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.24_loss, actual_compression 0.24160342067874035, expected loss 1.2587732593479155, actual acc 72.09999890136719, actual loss 1.138713939666748
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
