step 1: 
step 2: 
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
read json file /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenetv2_adaquant.piano.kdp530.scaled.onnx.json
Json : Layer features.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Json : Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.2.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.7.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.9.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.10.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.11.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.14.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.17.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.18.0, precision switch from w4a8 to w4a8.
Json : Layer classifier.1, precision switch from w8a8 to w8a8.
step 3: 
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
Input/outputs cached

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.before_adaquant.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.before_adaquant.onnx
Bernard calculate float point model accuracy before enabling quantization!
Bernard calculate fixed point model accuracy before training!

Optimize 0:features.0.0 for w8a8 bit of shape torch.Size([32, 3, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.579253e-05
MSE after  adaquant: 1.153480e-05
 End of training layer  features.0.0 better/total layers= 1 / 1 


Optimize 1:features.1.conv.0.0 for w4a8 bit of shape torch.Size([32, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 9.229539e-04
MSE after  adaquant: 4.388471e-04
 End of training layer  features.1.conv.0.0 better/total layers= 2 / 2 


Optimize 2:features.1.conv.1 for w4a8 bit of shape torch.Size([16, 32, 1, 1])

MSE before adaquant: 6.462580e-02
MSE after  adaquant: 5.183212e-02
 End of training layer  features.1.conv.1 better/total layers= 3 / 3 


Optimize 3:features.2.conv.0.0 for w4a8 bit of shape torch.Size([96, 16, 1, 1])

MSE before adaquant: 7.340207e-04
MSE after  adaquant: 4.494121e-04
 End of training layer  features.2.conv.0.0 better/total layers= 4 / 4 


Optimize 4:features.2.conv.1.0 for w4a8 bit of shape torch.Size([96, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 6.908037e-05
MSE after  adaquant: 4.622637e-05
 End of training layer  features.2.conv.1.0 better/total layers= 5 / 5 


Optimize 5:features.2.conv.2 for w4a8 bit of shape torch.Size([24, 96, 1, 1])

MSE before adaquant: 1.388415e-01
MSE after  adaquant: 8.864568e-03
 End of training layer  features.2.conv.2 better/total layers= 6 / 6 


Optimize 6:features.3.conv.0.0 for w4a8 bit of shape torch.Size([144, 24, 1, 1])

MSE before adaquant: 5.151731e-04
MSE after  adaquant: 3.047236e-04
 End of training layer  features.3.conv.0.0 better/total layers= 7 / 7 


Optimize 7:features.3.conv.1.0 for w4a8 bit of shape torch.Size([144, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.576392e-05
MSE after  adaquant: 3.146023e-05
 End of training layer  features.3.conv.1.0 better/total layers= 8 / 8 


Optimize 8:features.3.conv.2 for w4a8 bit of shape torch.Size([24, 144, 1, 1])

MSE before adaquant: 6.532556e-02
MSE after  adaquant: 8.766146e-03
 End of training layer  features.3.conv.2 better/total layers= 9 / 9 


Optimize 9:features.4.conv.0.0 for w4a8 bit of shape torch.Size([144, 24, 1, 1])

MSE before adaquant: 7.108258e-04
MSE after  adaquant: 4.053496e-04
 End of training layer  features.4.conv.0.0 better/total layers= 10 / 10 


Optimize 10:features.4.conv.1.0 for w4a8 bit of shape torch.Size([144, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.708425e-05
MSE after  adaquant: 1.789000e-05
 End of training layer  features.4.conv.1.0 better/total layers= 10 / 11 


Optimize 11:features.4.conv.2 for w4a8 bit of shape torch.Size([32, 144, 1, 1])

MSE before adaquant: 6.966548e-02
MSE after  adaquant: 6.485462e-03
 End of training layer  features.4.conv.2 better/total layers= 11 / 12 


Optimize 12:features.5.conv.0.0 for w4a8 bit of shape torch.Size([192, 32, 1, 1])

MSE before adaquant: 2.528341e-04
MSE after  adaquant: 1.428040e-04
 End of training layer  features.5.conv.0.0 better/total layers= 12 / 13 


Optimize 13:features.5.conv.1.0 for w4a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.133598e-05
MSE after  adaquant: 1.363498e-05
 End of training layer  features.5.conv.1.0 better/total layers= 13 / 14 


Optimize 14:features.5.conv.2 for w4a8 bit of shape torch.Size([32, 192, 1, 1])

MSE before adaquant: 1.698125e-02
MSE after  adaquant: 2.153035e-03
 End of training layer  features.5.conv.2 better/total layers= 14 / 15 


Optimize 15:features.6.conv.0.0 for w4a8 bit of shape torch.Size([192, 32, 1, 1])

MSE before adaquant: 2.071779e-04
MSE after  adaquant: 1.174452e-04
 End of training layer  features.6.conv.0.0 better/total layers= 15 / 16 


Optimize 16:features.6.conv.1.0 for w4a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.093956e-05
MSE after  adaquant: 1.074773e-05
 End of training layer  features.6.conv.1.0 better/total layers= 16 / 17 


Optimize 17:features.6.conv.2 for w4a8 bit of shape torch.Size([32, 192, 1, 1])

MSE before adaquant: 2.426490e-02
MSE after  adaquant: 2.866125e-03
 End of training layer  features.6.conv.2 better/total layers= 17 / 18 


Optimize 18:features.7.conv.0.0 for w4a8 bit of shape torch.Size([192, 32, 1, 1])

MSE before adaquant: 4.180056e-04
MSE after  adaquant: 2.639280e-04
 End of training layer  features.7.conv.0.0 better/total layers= 18 / 19 


Optimize 19:features.7.conv.1.0 for w4a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.318079e-05
MSE after  adaquant: 1.234827e-05
 End of training layer  features.7.conv.1.0 better/total layers= 19 / 20 


Optimize 20:features.7.conv.2 for w4a8 bit of shape torch.Size([64, 192, 1, 1])

MSE before adaquant: 9.422226e-02
MSE after  adaquant: 7.774634e-03
 End of training layer  features.7.conv.2 better/total layers= 20 / 21 


Optimize 21:features.8.conv.0.0 for w4a8 bit of shape torch.Size([384, 64, 1, 1])

MSE before adaquant: 2.040618e-04
MSE after  adaquant: 9.400448e-05
 End of training layer  features.8.conv.0.0 better/total layers= 21 / 22 


Optimize 22:features.8.conv.1.0 for w4a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.423370e-05
MSE after  adaquant: 1.177063e-05
 End of training layer  features.8.conv.1.0 better/total layers= 22 / 23 


Optimize 23:features.8.conv.2 for w4a8 bit of shape torch.Size([64, 384, 1, 1])

MSE before adaquant: 1.364234e-02
MSE after  adaquant: 1.120736e-03
 End of training layer  features.8.conv.2 better/total layers= 23 / 24 


Optimize 24:features.9.conv.0.0 for w4a8 bit of shape torch.Size([384, 64, 1, 1])

MSE before adaquant: 1.729979e-04
MSE after  adaquant: 9.306447e-05
 End of training layer  features.9.conv.0.0 better/total layers= 24 / 25 


Optimize 25:features.9.conv.1.0 for w4a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 5.927501e-06
MSE after  adaquant: 4.603472e-06
 End of training layer  features.9.conv.1.0 better/total layers= 25 / 26 


Optimize 26:features.9.conv.2 for w4a8 bit of shape torch.Size([64, 384, 1, 1])

MSE before adaquant: 1.328114e-02
MSE after  adaquant: 1.611341e-03
 End of training layer  features.9.conv.2 better/total layers= 26 / 27 


Optimize 27:features.10.conv.0.0 for w4a8 bit of shape torch.Size([384, 64, 1, 1])

MSE before adaquant: 1.492400e-04
MSE after  adaquant: 9.009563e-05
 End of training layer  features.10.conv.0.0 better/total layers= 27 / 28 


Optimize 28:features.10.conv.1.0 for w4a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 5.097105e-06
MSE after  adaquant: 3.857123e-06
 End of training layer  features.10.conv.1.0 better/total layers= 28 / 29 


Optimize 29:features.10.conv.2 for w4a8 bit of shape torch.Size([64, 384, 1, 1])

MSE before adaquant: 3.080784e-02
MSE after  adaquant: 4.222068e-03
 End of training layer  features.10.conv.2 better/total layers= 29 / 30 


Optimize 30:features.11.conv.0.0 for w4a8 bit of shape torch.Size([384, 64, 1, 1])

MSE before adaquant: 2.955174e-04
MSE after  adaquant: 1.570112e-04
 End of training layer  features.11.conv.0.0 better/total layers= 30 / 31 


Optimize 31:features.11.conv.1.0 for w4a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.500396e-05
MSE after  adaquant: 1.198289e-05
 End of training layer  features.11.conv.1.0 better/total layers= 31 / 32 


Optimize 32:features.11.conv.2 for w4a8 bit of shape torch.Size([96, 384, 1, 1])

MSE before adaquant: 2.761978e-02
MSE after  adaquant: 2.217822e-03
 End of training layer  features.11.conv.2 better/total layers= 32 / 33 


Optimize 33:features.12.conv.0.0 for w4a8 bit of shape torch.Size([576, 96, 1, 1])

MSE before adaquant: 2.094211e-04
MSE after  adaquant: 1.314604e-04
 End of training layer  features.12.conv.0.0 better/total layers= 33 / 34 


Optimize 34:features.12.conv.1.0 for w4a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.188883e-05
MSE after  adaquant: 5.038937e-06
 End of training layer  features.12.conv.1.0 better/total layers= 34 / 35 


Optimize 35:features.12.conv.2 for w4a8 bit of shape torch.Size([96, 576, 1, 1])

MSE before adaquant: 2.990035e-02
MSE after  adaquant: 1.720189e-03
 End of training layer  features.12.conv.2 better/total layers= 35 / 36 


Optimize 36:features.13.conv.0.0 for w4a8 bit of shape torch.Size([576, 96, 1, 1])

MSE before adaquant: 1.813670e-04
MSE after  adaquant: 1.013738e-04
 End of training layer  features.13.conv.0.0 better/total layers= 36 / 37 


Optimize 37:features.13.conv.1.0 for w4a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 5.033382e-05
MSE after  adaquant: 1.428157e-05
 End of training layer  features.13.conv.1.0 better/total layers= 37 / 38 


Optimize 38:features.13.conv.2 for w4a8 bit of shape torch.Size([96, 576, 1, 1])

MSE before adaquant: 5.946666e-02
MSE after  adaquant: 5.651036e-03
 End of training layer  features.13.conv.2 better/total layers= 38 / 39 


Optimize 39:features.14.conv.0.0 for w4a8 bit of shape torch.Size([576, 96, 1, 1])

MSE before adaquant: 4.718409e-04
MSE after  adaquant: 1.266486e-04
 End of training layer  features.14.conv.0.0 better/total layers= 39 / 40 


Optimize 40:features.14.conv.1.0 for w4a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.753571e-03
MSE after  adaquant: 6.669876e-04
 End of training layer  features.14.conv.1.0 better/total layers= 40 / 41 


Optimize 41:features.14.conv.2 for w4a8 bit of shape torch.Size([160, 576, 1, 1])

MSE before adaquant: 5.207446e-02
MSE after  adaquant: 3.965243e-03
 End of training layer  features.14.conv.2 better/total layers= 41 / 42 


Optimize 42:features.15.conv.0.0 for w4a8 bit of shape torch.Size([960, 160, 1, 1])

MSE before adaquant: 1.301610e-03
MSE after  adaquant: 1.506889e-04
 End of training layer  features.15.conv.0.0 better/total layers= 42 / 43 


Optimize 43:features.15.conv.1.0 for w4a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.493535e-04
MSE after  adaquant: 6.205655e-05
 End of training layer  features.15.conv.1.0 better/total layers= 43 / 44 


Optimize 44:features.15.conv.2 for w4a8 bit of shape torch.Size([160, 960, 1, 1])

MSE before adaquant: 1.437078e-02
MSE after  adaquant: 2.025443e-03
 End of training layer  features.15.conv.2 better/total layers= 44 / 45 


Optimize 45:features.16.conv.0.0 for w4a8 bit of shape torch.Size([960, 160, 1, 1])

MSE before adaquant: 4.744336e-03
MSE after  adaquant: 2.748565e-04
 End of training layer  features.16.conv.0.0 better/total layers= 45 / 46 


Optimize 46:features.16.conv.1.0 for w4a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.249692e-03
MSE after  adaquant: 1.825066e-03
 End of training layer  features.16.conv.1.0 better/total layers= 46 / 47 


Optimize 47:features.16.conv.2 for w4a8 bit of shape torch.Size([160, 960, 1, 1])

MSE before adaquant: 9.588862e-02
MSE after  adaquant: 8.829779e-03
 End of training layer  features.16.conv.2 better/total layers= 47 / 48 


Optimize 48:features.17.conv.0.0 for w4a8 bit of shape torch.Size([960, 160, 1, 1])

MSE before adaquant: 4.057169e-04
MSE after  adaquant: 6.764758e-05
 End of training layer  features.17.conv.0.0 better/total layers= 48 / 49 


Optimize 49:features.17.conv.1.0 for w4a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.973625e-05
MSE after  adaquant: 1.241130e-05
 End of training layer  features.17.conv.1.0 better/total layers= 49 / 50 


Optimize 50:features.17.conv.2 for w4a8 bit of shape torch.Size([320, 960, 1, 1])

MSE before adaquant: 8.178966e-02
MSE after  adaquant: 3.477985e-03
 End of training layer  features.17.conv.2 better/total layers= 50 / 51 


Optimize 51:features.18.0 for w8a8 bit of shape torch.Size([1280, 320, 1, 1])

MSE before adaquant: 5.176962e-02
MSE after  adaquant: 1.344571e-02
 End of training layer  features.18.0 better/total layers= 51 / 52 


Optimize 52:classifier.1 for w8a8 bit of shape torch.Size([1000, 1280])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 9.441149e-04
MSE after  adaquant: 7.814456e-04
 End of training layer  classifier.1 better/total layers= 52 / 53 

step 1: 
step 2: 
Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.2.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.7.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.9.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.10.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.11.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.14.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
read json file /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenetv2_adaquant.piano.kdp530.scaled.onnx.json
Json : Layer features.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.1.conv.1, precision switch from w8a8 to w8a8.
Json : Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.2.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.2.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.3.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.4.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.5.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.6.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.7.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.7.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.8.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.9.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.9.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.10.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.10.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.11.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.11.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.12.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.13.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.14.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.14.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.15.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.16.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.17.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.18.0, precision switch from w8a8 to w8a8.
Json : Layer classifier.1, precision switch from w8a8 to w8a8.
step 3: 
Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.2.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.7.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.9.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.10.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.11.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.14.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
Input/outputs cached

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.before_adaquant.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.before_adaquant.onnx
Bernard calculate float point model accuracy before enabling quantization!
Bernard calculate fixed point model accuracy before training!

Optimize 0:features.0.0 for w8a8 bit of shape torch.Size([32, 3, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.579253e-05
MSE after  adaquant: 8.612918e-06
 End of training layer  features.0.0 better/total layers= 1 / 1 


Optimize 1:features.1.conv.0.0 for w8a8 bit of shape torch.Size([32, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 9.229539e-04
MSE after  adaquant: 4.388471e-04
 End of training layer  features.1.conv.0.0 better/total layers= 2 / 2 


Optimize 2:features.1.conv.1 for w8a8 bit of shape torch.Size([16, 32, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.895328e-04
MSE after  adaquant: 3.959913e-04
 End of training layer  features.1.conv.1 better/total layers= 3 / 3 


Optimize 3:features.2.conv.0.0 for w8a8 bit of shape torch.Size([96, 16, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.077799e-05
MSE after  adaquant: 2.031968e-05
 End of training layer  features.2.conv.0.0 better/total layers= 4 / 4 


Optimize 4:features.2.conv.1.0 for w8a8 bit of shape torch.Size([96, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 6.908037e-05
MSE after  adaquant: 4.622637e-05
 End of training layer  features.2.conv.1.0 better/total layers= 5 / 5 


Optimize 5:features.2.conv.2 for w8a8 bit of shape torch.Size([24, 96, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 7.114431e-04
MSE after  adaquant: 2.212460e-04
 End of training layer  features.2.conv.2 better/total layers= 6 / 6 


Optimize 6:features.3.conv.0.0 for w8a8 bit of shape torch.Size([144, 24, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.167379e-05
MSE after  adaquant: 2.368250e-05
 End of training layer  features.3.conv.0.0 better/total layers= 6 / 7 


Optimize 7:features.3.conv.1.0 for w8a8 bit of shape torch.Size([144, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.576392e-05
MSE after  adaquant: 3.146023e-05
 End of training layer  features.3.conv.1.0 better/total layers= 7 / 8 


Optimize 8:features.3.conv.2 for w8a8 bit of shape torch.Size([24, 144, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.957774e-04
MSE after  adaquant: 1.618634e-04
 End of training layer  features.3.conv.2 better/total layers= 8 / 9 


Optimize 9:features.4.conv.0.0 for w8a8 bit of shape torch.Size([144, 24, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 9.693759e-06
MSE after  adaquant: 9.375067e-06
 End of training layer  features.4.conv.0.0 better/total layers= 9 / 10 


Optimize 10:features.4.conv.1.0 for w8a8 bit of shape torch.Size([144, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.708425e-05
MSE after  adaquant: 1.789000e-05
 End of training layer  features.4.conv.1.0 better/total layers= 9 / 11 


Optimize 11:features.4.conv.2 for w8a8 bit of shape torch.Size([32, 144, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.328680e-04
MSE after  adaquant: 1.393581e-04
 End of training layer  features.4.conv.2 better/total layers= 10 / 12 


Optimize 12:features.5.conv.0.0 for w8a8 bit of shape torch.Size([192, 32, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.986895e-06
MSE after  adaquant: 3.210344e-06
 End of training layer  features.5.conv.0.0 better/total layers= 10 / 13 


Optimize 13:features.5.conv.1.0 for w8a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.133598e-05
MSE after  adaquant: 1.363498e-05
 End of training layer  features.5.conv.1.0 better/total layers= 11 / 14 


Optimize 14:features.5.conv.2 for w8a8 bit of shape torch.Size([32, 192, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 8.008318e-05
MSE after  adaquant: 4.791598e-05
 End of training layer  features.5.conv.2 better/total layers= 12 / 15 


Optimize 15:features.6.conv.0.0 for w8a8 bit of shape torch.Size([192, 32, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.516806e-06
MSE after  adaquant: 3.233861e-06
 End of training layer  features.6.conv.0.0 better/total layers= 12 / 16 


Optimize 16:features.6.conv.1.0 for w8a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.093956e-05
MSE after  adaquant: 1.074773e-05
 End of training layer  features.6.conv.1.0 better/total layers= 13 / 17 


Optimize 17:features.6.conv.2 for w8a8 bit of shape torch.Size([32, 192, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.374863e-04
MSE after  adaquant: 5.447896e-05
 End of training layer  features.6.conv.2 better/total layers= 14 / 18 


Optimize 18:features.7.conv.0.0 for w8a8 bit of shape torch.Size([192, 32, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.975441e-06
MSE after  adaquant: 5.599870e-06
 End of training layer  features.7.conv.0.0 better/total layers= 14 / 19 


Optimize 19:features.7.conv.1.0 for w8a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.318079e-05
MSE after  adaquant: 1.234827e-05
 End of training layer  features.7.conv.1.0 better/total layers= 15 / 20 


Optimize 20:features.7.conv.2 for w8a8 bit of shape torch.Size([64, 192, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.664661e-04
MSE after  adaquant: 1.242638e-04
 End of training layer  features.7.conv.2 better/total layers= 16 / 21 


Optimize 21:features.8.conv.0.0 for w8a8 bit of shape torch.Size([384, 64, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.646674e-06
MSE after  adaquant: 2.002420e-06
 End of training layer  features.8.conv.0.0 better/total layers= 16 / 22 


Optimize 22:features.8.conv.1.0 for w8a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.423370e-05
MSE after  adaquant: 1.177063e-05
 End of training layer  features.8.conv.1.0 better/total layers= 17 / 23 


Optimize 23:features.8.conv.2 for w8a8 bit of shape torch.Size([64, 384, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.000677e-04
MSE after  adaquant: 4.387788e-05
 End of training layer  features.8.conv.2 better/total layers= 18 / 24 


Optimize 24:features.9.conv.0.0 for w8a8 bit of shape torch.Size([384, 64, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.526041e-06
MSE after  adaquant: 1.788586e-06
 End of training layer  features.9.conv.0.0 better/total layers= 18 / 25 


Optimize 25:features.9.conv.1.0 for w8a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 5.927501e-06
MSE after  adaquant: 4.603472e-06
 End of training layer  features.9.conv.1.0 better/total layers= 19 / 26 


Optimize 26:features.9.conv.2 for w8a8 bit of shape torch.Size([64, 384, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 7.565181e-05
MSE after  adaquant: 2.686647e-05
 End of training layer  features.9.conv.2 better/total layers= 20 / 27 


Optimize 27:features.10.conv.0.0 for w8a8 bit of shape torch.Size([384, 64, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.415378e-06
MSE after  adaquant: 1.632135e-06
 End of training layer  features.10.conv.0.0 better/total layers= 20 / 28 


Optimize 28:features.10.conv.1.0 for w8a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 5.097105e-06
MSE after  adaquant: 3.857123e-06
 End of training layer  features.10.conv.1.0 better/total layers= 21 / 29 


Optimize 29:features.10.conv.2 for w8a8 bit of shape torch.Size([64, 384, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.508172e-04
MSE after  adaquant: 1.280209e-04
 End of training layer  features.10.conv.2 better/total layers= 22 / 30 


Optimize 30:features.11.conv.0.0 for w8a8 bit of shape torch.Size([384, 64, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.660735e-06
MSE after  adaquant: 2.861343e-06
 End of training layer  features.11.conv.0.0 better/total layers= 23 / 31 


Optimize 31:features.11.conv.1.0 for w8a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.500396e-05
MSE after  adaquant: 1.198289e-05
 End of training layer  features.11.conv.1.0 better/total layers= 24 / 32 


Optimize 32:features.11.conv.2 for w8a8 bit of shape torch.Size([96, 384, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.461321e-04
MSE after  adaquant: 5.611393e-05
 End of training layer  features.11.conv.2 better/total layers= 25 / 33 


Optimize 33:features.12.conv.0.0 for w8a8 bit of shape torch.Size([576, 96, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.651598e-06
MSE after  adaquant: 3.002992e-06
 End of training layer  features.12.conv.0.0 better/total layers= 25 / 34 


Optimize 34:features.12.conv.1.0 for w8a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.188883e-05
MSE after  adaquant: 5.038937e-06
 End of training layer  features.12.conv.1.0 better/total layers= 26 / 35 


Optimize 35:features.12.conv.2 for w8a8 bit of shape torch.Size([96, 576, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.847104e-04
MSE after  adaquant: 8.829562e-05
 End of training layer  features.12.conv.2 better/total layers= 27 / 36 


Optimize 36:features.13.conv.0.0 for w8a8 bit of shape torch.Size([576, 96, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.813886e-06
MSE after  adaquant: 2.050896e-06
 End of training layer  features.13.conv.0.0 better/total layers= 27 / 37 


Optimize 37:features.13.conv.1.0 for w8a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 5.033382e-05
MSE after  adaquant: 1.428157e-05
 End of training layer  features.13.conv.1.0 better/total layers= 28 / 38 


Optimize 38:features.13.conv.2 for w8a8 bit of shape torch.Size([96, 576, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.907019e-03
MSE after  adaquant: 4.088925e-04
 End of training layer  features.13.conv.2 better/total layers= 29 / 39 


Optimize 39:features.14.conv.0.0 for w8a8 bit of shape torch.Size([576, 96, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.015724e-04
MSE after  adaquant: 5.315116e-06
 End of training layer  features.14.conv.0.0 better/total layers= 30 / 40 


Optimize 40:features.14.conv.1.0 for w8a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.753571e-03
MSE after  adaquant: 6.669876e-04
 End of training layer  features.14.conv.1.0 better/total layers= 31 / 41 


Optimize 41:features.14.conv.2 for w8a8 bit of shape torch.Size([160, 576, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.515233e-02
MSE after  adaquant: 5.993315e-03
 End of training layer  features.14.conv.2 better/total layers= 32 / 42 


Optimize 42:features.15.conv.0.0 for w8a8 bit of shape torch.Size([960, 160, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.091081e-03
MSE after  adaquant: 2.291622e-04
 End of training layer  features.15.conv.0.0 better/total layers= 33 / 43 


Optimize 43:features.15.conv.1.0 for w8a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.493535e-04
MSE after  adaquant: 6.205655e-05
 End of training layer  features.15.conv.1.0 better/total layers= 34 / 44 


Optimize 44:features.15.conv.2 for w8a8 bit of shape torch.Size([160, 960, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.325774e-04
MSE after  adaquant: 1.594273e-04
 End of training layer  features.15.conv.2 better/total layers= 34 / 45 


Optimize 45:features.16.conv.0.0 for w8a8 bit of shape torch.Size([960, 160, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.514517e-03
MSE after  adaquant: 1.204360e-03
 End of training layer  features.16.conv.0.0 better/total layers= 35 / 46 


Optimize 46:features.16.conv.1.0 for w8a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.249692e-03
MSE after  adaquant: 1.825066e-03
 End of training layer  features.16.conv.1.0 better/total layers= 36 / 47 


Optimize 47:features.16.conv.2 for w8a8 bit of shape torch.Size([160, 960, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 7.485484e-02
MSE after  adaquant: 6.371628e-02
 End of training layer  features.16.conv.2 better/total layers= 37 / 48 


Optimize 48:features.17.conv.0.0 for w8a8 bit of shape torch.Size([960, 160, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.101486e-04
MSE after  adaquant: 4.823388e-05
 End of training layer  features.17.conv.0.0 better/total layers= 38 / 49 


Optimize 49:features.17.conv.1.0 for w8a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.973625e-05
MSE after  adaquant: 1.241130e-05
 End of training layer  features.17.conv.1.0 better/total layers= 39 / 50 


Optimize 50:features.17.conv.2 for w8a8 bit of shape torch.Size([320, 960, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 8.576651e-04
MSE after  adaquant: 5.095238e-04
 End of training layer  features.17.conv.2 better/total layers= 40 / 51 


Optimize 51:features.18.0 for w8a8 bit of shape torch.Size([1280, 320, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.016111e-04
MSE after  adaquant: 3.213918e-04
 End of training layer  features.18.0 better/total layers= 41 / 52 


Optimize 52:classifier.1 for w8a8 bit of shape torch.Size([1000, 1280])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 9.441149e-04
MSE after  adaquant: 7.814456e-04
 End of training layer  classifier.1 better/total layers= 42 / 53 

step 4
Train: ########### All 8bit results ###########
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
finished 0 out of 50
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
finished 1 out of 50
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
finished 2 out of 50
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w8a8 to w8a8.
finished 3 out of 50
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
finished 4 out of 50
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
finished 5 out of 50
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
finished 6 out of 50
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
finished 7 out of 50
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
finished 8 out of 50
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
finished 9 out of 50
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
finished 10 out of 50
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
finished 11 out of 50
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
finished 12 out of 50
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
finished 13 out of 50
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
finished 14 out of 50
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
finished 15 out of 50
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
finished 16 out of 50
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
finished 17 out of 50
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w8a8 to w8a8.
finished 18 out of 50
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
finished 19 out of 50
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
finished 20 out of 50
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
finished 21 out of 50
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
finished 22 out of 50
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
finished 23 out of 50
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w8a8 to w8a8.
finished 24 out of 50
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
finished 25 out of 50
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
finished 26 out of 50
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w8a8 to w8a8.
finished 27 out of 50
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
finished 28 out of 50
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
finished 29 out of 50
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w8a8 to w8a8.
finished 30 out of 50
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
finished 31 out of 50
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
finished 32 out of 50
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
finished 33 out of 50
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
finished 34 out of 50
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
finished 35 out of 50
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
finished 36 out of 50
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
finished 37 out of 50
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
finished 38 out of 50
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w8a8 to w8a8.
finished 39 out of 50
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
finished 40 out of 50
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
finished 41 out of 50
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
finished 42 out of 50
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
finished 43 out of 50
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
finished 44 out of 50
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
finished 45 out of 50
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
finished 46 out of 50
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
finished 47 out of 50
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
finished 48 out of 50
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
step 5
Found K = 38
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Achieved compression:  0.13499046814020826
Expected acc:  1.5081135909023284
Params % in int 4 = 0.9200762548783339
Params % in int 8 = 0.0799237451216661
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.0.0 to w4a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.0.0 to w4a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
switched layer features.10.conv.2 to w4a8
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.0.0 to w4a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
switched layer features.11.conv.2 to w4a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
switched layer features.13.conv.2 to w4a8
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.0.0 to w4a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
switched layer features.15.conv.2 to w4a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.0.0 to w4a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
switched layer features.17.conv.2 to w4a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13499046814020826, expected loss 1.5081135909023284, actual acc 64.79999972534179, actual loss 1.4366613492965699
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Found K = 34
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Achieved compression:  0.14017004478175638
Expected acc:  1.4666175345840453
Params % in int 4 = 0.878639641745949
Params % in int 8 = 0.12136035825405105
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.0.0 to w4a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
switched layer features.13.conv.2 to w4a8
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.0.0 to w4a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
switched layer features.15.conv.2 to w4a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.0.0 to w4a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
switched layer features.17.conv.2 to w4a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13499046814020826, expected loss 1.5081135909023284, actual acc 64.79999972534179, actual loss 1.4366613492965699
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14017004478175638, expected loss 1.4666175345840453, actual acc 64.89999981689454, actual loss 1.3918983459472656
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Found K = 33
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Achieved compression:  0.1509608294516483
Expected acc:  1.4185413639011382
Params % in int 4 = 0.7923133643868137
Params % in int 8 = 0.20768663561318634
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.0.0 to w4a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
switched layer features.13.conv.2 to w4a8
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.0.0 to w4a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.0.0 to w4a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
switched layer features.17.conv.2 to w4a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13499046814020826, expected loss 1.5081135909023284, actual acc 64.79999972534179, actual loss 1.4366613492965699
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14017004478175638, expected loss 1.4666175345840453, actual acc 64.89999981689454, actual loss 1.3918983459472656
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.1509608294516483, expected loss 1.4185413639011382, actual acc 66.89999990844727, actual loss 1.3145601863861085
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Found K = 31
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Achieved compression:  0.1634781396687229
Expected acc:  1.3735585729541777
Params % in int 4 = 0.6921748826502168
Params % in int 8 = 0.3078251173497833
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
switched layer features.13.conv.2 to w4a8
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.0.0 to w4a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.0.0 to w4a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
switched layer features.17.conv.2 to w4a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13499046814020826, expected loss 1.5081135909023284, actual acc 64.79999972534179, actual loss 1.4366613492965699
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14017004478175638, expected loss 1.4666175345840453, actual acc 64.89999981689454, actual loss 1.3918983459472656
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.1509608294516483, expected loss 1.4185413639011382, actual acc 66.89999990844727, actual loss 1.3145601863861085
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.1634781396687229, expected loss 1.3735585729541777, actual acc 67.19999938964844, actual loss 1.2665791912078856
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Found K = 28
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Achieved compression:  0.1708158732442494
Expected acc:  1.351645920700073
Params % in int 4 = 0.6334730140460048
Params % in int 8 = 0.3665269859539953
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.0.0 to w8a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.0.0 to w4a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.0.0 to w4a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
switched layer features.17.conv.2 to w4a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13499046814020826, expected loss 1.5081135909023284, actual acc 64.79999972534179, actual loss 1.4366613492965699
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14017004478175638, expected loss 1.4666175345840453, actual acc 64.89999981689454, actual loss 1.3918983459472656
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.1509608294516483, expected loss 1.4185413639011382, actual acc 66.89999990844727, actual loss 1.3145601863861085
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.1634781396687229, expected loss 1.3735585729541777, actual acc 67.19999938964844, actual loss 1.2665791912078856
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.1708158732442494, expected loss 1.351645920700073, actual acc 67.49999981689453, actual loss 1.24024338722229
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Found K = 25
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Achieved compression:  0.18246992068773268
Expected acc:  1.3290426353874205
Params % in int 4 = 0.5402406344981386
Params % in int 8 = 0.4597593655018614
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.0.0 to w8a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.0.0 to w8a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.0.0 to w8a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.0.0 to w4a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
switched layer features.17.conv.2 to w4a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13499046814020826, expected loss 1.5081135909023284, actual acc 64.79999972534179, actual loss 1.4366613492965699
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14017004478175638, expected loss 1.4666175345840453, actual acc 64.89999981689454, actual loss 1.3918983459472656
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.1509608294516483, expected loss 1.4185413639011382, actual acc 66.89999990844727, actual loss 1.3145601863861085
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.1634781396687229, expected loss 1.3735585729541777, actual acc 67.19999938964844, actual loss 1.2665791912078856
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.1708158732442494, expected loss 1.351645920700073, actual acc 67.49999981689453, actual loss 1.24024338722229
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.18246992068773268, expected loss 1.3290426353874205, actual acc 69.00000042724609, actual loss 1.205486827850342
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Found K = 23
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8']
Achieved compression:  0.1949872309048073
Expected acc:  1.3108046273651122
Params % in int 4 = 0.44010215276154163
Params % in int 8 = 0.5598978472384584
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.0.0 to w8a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.0.0 to w8a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.0.0 to w8a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
switched layer features.17.conv.2 to w4a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13499046814020826, expected loss 1.5081135909023284, actual acc 64.79999972534179, actual loss 1.4366613492965699
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14017004478175638, expected loss 1.4666175345840453, actual acc 64.89999981689454, actual loss 1.3918983459472656
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.1509608294516483, expected loss 1.4185413639011382, actual acc 66.89999990844727, actual loss 1.3145601863861085
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.1634781396687229, expected loss 1.3735585729541777, actual acc 67.19999938964844, actual loss 1.2665791912078856
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.1708158732442494, expected loss 1.351645920700073, actual acc 67.49999981689453, actual loss 1.24024338722229
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.18246992068773268, expected loss 1.3290426353874205, actual acc 69.00000042724609, actual loss 1.205486827850342
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.1949872309048073, expected loss 1.3108046273651122, actual acc 70.0999994506836, actual loss 1.2228394804000855
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Found K = 22
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Achieved compression:  0.21656880024459113
Expected acc:  1.2809949497642517
Params % in int 4 = 0.26744959804327106
Params % in int 8 = 0.7325504019567289
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.0.0 to w8a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.0.0 to w8a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.0.0 to w8a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13499046814020826, expected loss 1.5081135909023284, actual acc 64.79999972534179, actual loss 1.4366613492965699
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14017004478175638, expected loss 1.4666175345840453, actual acc 64.89999981689454, actual loss 1.3918983459472656
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.1509608294516483, expected loss 1.4185413639011382, actual acc 66.89999990844727, actual loss 1.3145601863861085
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.1634781396687229, expected loss 1.3735585729541777, actual acc 67.19999938964844, actual loss 1.2665791912078856
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.1708158732442494, expected loss 1.351645920700073, actual acc 67.49999981689453, actual loss 1.24024338722229
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.18246992068773268, expected loss 1.3290426353874205, actual acc 69.00000042724609, actual loss 1.205486827850342
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.1949872309048073, expected loss 1.3108046273651122, actual acc 70.0999994506836, actual loss 1.2228394804000855
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.21656880024459113, expected loss 1.2809949497642517, actual acc 71.89999908447265, actual loss 1.16557710647583
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Found K = 22
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Achieved compression:  0.21656880024459113
Expected acc:  1.2809949497642517
Params % in int 4 = 0.26744959804327106
Params % in int 8 = 0.7325504019567289
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.0.0 to w8a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.0.0 to w8a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.0.0 to w8a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13499046814020826, expected loss 1.5081135909023284, actual acc 64.79999972534179, actual loss 1.4366613492965699
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14017004478175638, expected loss 1.4666175345840453, actual acc 64.89999981689454, actual loss 1.3918983459472656
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.1509608294516483, expected loss 1.4185413639011382, actual acc 66.89999990844727, actual loss 1.3145601863861085
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.1634781396687229, expected loss 1.3735585729541777, actual acc 67.19999938964844, actual loss 1.2665791912078856
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.1708158732442494, expected loss 1.351645920700073, actual acc 67.49999981689453, actual loss 1.24024338722229
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.18246992068773268, expected loss 1.3290426353874205, actual acc 69.00000042724609, actual loss 1.205486827850342
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.1949872309048073, expected loss 1.3108046273651122, actual acc 70.0999994506836, actual loss 1.2228394804000855
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.21656880024459113, expected loss 1.2809949497642517, actual acc 71.89999908447265, actual loss 1.16557710647583
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.21, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss, compression 0.21656880024459113, expected loss 1.2809949497642517, actual acc 71.89999908447265, actual loss 1.16557710647583
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Found K = 21
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Achieved compression:  0.22735958491448302
Expected acc:  1.2697185615959168
Params % in int 4 = 0.18112332068413575
Params % in int 8 = 0.8188766793158643
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.0.0 to w8a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.0.0 to w8a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.0.0 to w8a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.16.conv.0.0 to w8a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13499046814020826, expected loss 1.5081135909023284, actual acc 64.79999972534179, actual loss 1.4366613492965699
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14017004478175638, expected loss 1.4666175345840453, actual acc 64.89999981689454, actual loss 1.3918983459472656
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.1509608294516483, expected loss 1.4185413639011382, actual acc 66.89999990844727, actual loss 1.3145601863861085
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.1634781396687229, expected loss 1.3735585729541777, actual acc 67.19999938964844, actual loss 1.2665791912078856
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.1708158732442494, expected loss 1.351645920700073, actual acc 67.49999981689453, actual loss 1.24024338722229
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.18246992068773268, expected loss 1.3290426353874205, actual acc 69.00000042724609, actual loss 1.205486827850342
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.1949872309048073, expected loss 1.3108046273651122, actual acc 70.0999994506836, actual loss 1.2228394804000855
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.21656880024459113, expected loss 1.2809949497642517, actual acc 71.89999908447265, actual loss 1.16557710647583
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.21, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss, compression 0.21656880024459113, expected loss 1.2809949497642517, actual acc 71.89999908447265, actual loss 1.16557710647583
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.22, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss, compression 0.22735958491448302, expected loss 1.2697185615959168, actual acc 71.7999998779297, actual loss 1.1343220291137694
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Found K = 19
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Achieved compression:  0.23987689513155766
Expected acc:  1.2598574022712707
Params % in int 4 = 0.0809848389475388
Params % in int 8 = 0.9190151610524612
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.0.0 to w8a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.0.0 to w8a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.0.0 to w8a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.0.0 to w8a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.15.conv.0.0 to w8a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.16.conv.0.0 to w8a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.23_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.23_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13499046814020826, expected loss 1.5081135909023284, actual acc 64.79999972534179, actual loss 1.4366613492965699
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14017004478175638, expected loss 1.4666175345840453, actual acc 64.89999981689454, actual loss 1.3918983459472656
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.1509608294516483, expected loss 1.4185413639011382, actual acc 66.89999990844727, actual loss 1.3145601863861085
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.1634781396687229, expected loss 1.3735585729541777, actual acc 67.19999938964844, actual loss 1.2665791912078856
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.1708158732442494, expected loss 1.351645920700073, actual acc 67.49999981689453, actual loss 1.24024338722229
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.18246992068773268, expected loss 1.3290426353874205, actual acc 69.00000042724609, actual loss 1.205486827850342
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.1949872309048073, expected loss 1.3108046273651122, actual acc 70.0999994506836, actual loss 1.2228394804000855
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.21656880024459113, expected loss 1.2809949497642517, actual acc 71.89999908447265, actual loss 1.16557710647583
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.21, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss, compression 0.21656880024459113, expected loss 1.2809949497642517, actual acc 71.89999908447265, actual loss 1.16557710647583
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.22, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss, compression 0.22735958491448302, expected loss 1.2697185615959168, actual acc 71.7999998779297, actual loss 1.1343220291137694
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.23, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.23_loss, compression 0.23987689513155766, expected loss 1.2598574022712707, actual acc 71.70000030517578, actual loss 1.132310152053833
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Found K = 16
Final Solution:  {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [8, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Achieved compression:  0.24004887326223406
Expected acc:  1.2598544022712708
Params % in int 4 = 0.07960901390212759
Params % in int 8 = 0.9203909860978724
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.1.conv.0.0 to w8a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.1.0 to w8a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.1.0 to w8a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.0.0 to w8a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.0.0 to w8a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.0.0 to w8a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.0.0 to w8a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.15.conv.0.0 to w8a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.16.conv.0.0 to w8a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.24_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.24_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13499046814020826, expected loss 1.5081135909023284, actual acc 64.79999972534179, actual loss 1.4366613492965699
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14017004478175638, expected loss 1.4666175345840453, actual acc 64.89999981689454, actual loss 1.3918983459472656
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.1509608294516483, expected loss 1.4185413639011382, actual acc 66.89999990844727, actual loss 1.3145601863861085
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.1634781396687229, expected loss 1.3735585729541777, actual acc 67.19999938964844, actual loss 1.2665791912078856
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.1708158732442494, expected loss 1.351645920700073, actual acc 67.49999981689453, actual loss 1.24024338722229
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.18246992068773268, expected loss 1.3290426353874205, actual acc 69.00000042724609, actual loss 1.205486827850342
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.1949872309048073, expected loss 1.3108046273651122, actual acc 70.0999994506836, actual loss 1.2228394804000855
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.21656880024459113, expected loss 1.2809949497642517, actual acc 71.89999908447265, actual loss 1.16557710647583
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.21, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss, compression 0.21656880024459113, expected loss 1.2809949497642517, actual acc 71.89999908447265, actual loss 1.16557710647583
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.22, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss, compression 0.22735958491448302, expected loss 1.2697185615959168, actual acc 71.7999998779297, actual loss 1.1343220291137694
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.23, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.23_loss, compression 0.23987689513155766, expected loss 1.2598574022712707, actual acc 71.70000030517578, actual loss 1.132310152053833
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.24, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.24_loss, compression 0.24004887326223406, expected loss 1.2598544022712708, actual acc 71.70000030517578, actual loss 1.132310152053833
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [8, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.13, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, actual_compression 0.13499046814020826, expected loss 1.5081135909023284, actual acc 64.79999972534179, actual loss 1.4366613492965699
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Compression thr 0.14, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, actual_compression 0.14017004478175638, expected loss 1.4666175345840453, actual acc 64.89999981689454, actual loss 1.3918983459472656
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Compression thr 0.15000000000000002, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, actual_compression 0.1509608294516483, expected loss 1.4185413639011382, actual acc 66.89999990844727, actual loss 1.3145601863861085
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Compression thr 0.16000000000000003, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, actual_compression 0.1634781396687229, expected loss 1.3735585729541777, actual acc 67.19999938964844, actual loss 1.2665791912078856
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Compression thr 0.17000000000000004, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, actual_compression 0.1708158732442494, expected loss 1.351645920700073, actual acc 67.49999981689453, actual loss 1.24024338722229
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Compression thr 0.18000000000000005, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, actual_compression 0.18246992068773268, expected loss 1.3290426353874205, actual acc 69.00000042724609, actual loss 1.205486827850342
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Compression thr 0.19000000000000006, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, actual_compression 0.1949872309048073, expected loss 1.3108046273651122, actual acc 70.0999994506836, actual loss 1.2228394804000855
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8']
Compression thr 0.20000000000000007, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, actual_compression 0.21656880024459113, expected loss 1.2809949497642517, actual acc 71.89999908447265, actual loss 1.16557710647583
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Compression thr 0.21000000000000008, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss, actual_compression 0.21656880024459113, expected loss 1.2809949497642517, actual acc 71.89999908447265, actual loss 1.16557710647583
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Compression thr 0.22000000000000008, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss, actual_compression 0.22735958491448302, expected loss 1.2697185615959168, actual acc 71.7999998779297, actual loss 1.1343220291137694
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Compression thr 0.2300000000000001, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.23_loss, actual_compression 0.23987689513155766, expected loss 1.2598574022712707, actual acc 71.70000030517578, actual loss 1.132310152053833
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Compression thr 0.2400000000000001, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.24_loss, actual_compression 0.24004887326223406, expected loss 1.2598544022712708, actual acc 71.70000030517578, actual loss 1.132310152053833
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
