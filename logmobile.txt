step 1: 
step 2: 
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
read json file /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenetv2_adaquant.piano.kdp530.scaled.onnx.json
Json : Layer features.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Json : Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.2.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.7.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.9.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.10.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.11.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.14.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.17.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.18.0, precision switch from w4a8 to w4a8.
Json : Layer classifier.1, precision switch from w8a8 to w8a8.
step 3: 
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
Input/outputs cached

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.before_adaquant.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.before_adaquant.onnx
Bernard calculate float point model accuracy before enabling quantization!
Bernard calculate fixed point model accuracy before training!

Optimize 0:features.0.0 for w8a8 bit of shape torch.Size([32, 3, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.631438e-05
MSE after  adaquant: 1.279114e-05
 End of training layer  features.0.0 better/total layers= 1 / 1 


Optimize 1:features.1.conv.0.0 for w4a8 bit of shape torch.Size([32, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.219447e-03
MSE after  adaquant: 2.948561e-04
 End of training layer  features.1.conv.0.0 better/total layers= 2 / 2 


Optimize 2:features.1.conv.1 for w4a8 bit of shape torch.Size([16, 32, 1, 1])

MSE before adaquant: 4.896906e-02
MSE after  adaquant: 8.304311e-03
 End of training layer  features.1.conv.1 better/total layers= 3 / 3 


Optimize 3:features.2.conv.0.0 for w4a8 bit of shape torch.Size([96, 16, 1, 1])

MSE before adaquant: 9.962326e-04
MSE after  adaquant: 3.073962e-04
 End of training layer  features.2.conv.0.0 better/total layers= 4 / 4 


Optimize 4:features.2.conv.1.0 for w4a8 bit of shape torch.Size([96, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.460114e-04
MSE after  adaquant: 7.288493e-05
 End of training layer  features.2.conv.1.0 better/total layers= 5 / 5 


Optimize 5:features.2.conv.2 for w4a8 bit of shape torch.Size([24, 96, 1, 1])

MSE before adaquant: 1.524795e-01
MSE after  adaquant: 4.190307e-03
 End of training layer  features.2.conv.2 better/total layers= 6 / 6 


Optimize 6:features.3.conv.0.0 for w4a8 bit of shape torch.Size([144, 24, 1, 1])

MSE before adaquant: 6.108347e-04
MSE after  adaquant: 1.689953e-04
 End of training layer  features.3.conv.0.0 better/total layers= 7 / 7 


Optimize 7:features.3.conv.1.0 for w4a8 bit of shape torch.Size([144, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.376892e-05
MSE after  adaquant: 2.249750e-05
 End of training layer  features.3.conv.1.0 better/total layers= 8 / 8 


Optimize 8:features.3.conv.2 for w4a8 bit of shape torch.Size([24, 144, 1, 1])

MSE before adaquant: 6.295650e-02
MSE after  adaquant: 3.142946e-03
 End of training layer  features.3.conv.2 better/total layers= 9 / 9 


Optimize 9:features.4.conv.0.0 for w4a8 bit of shape torch.Size([144, 24, 1, 1])

MSE before adaquant: 7.730051e-04
MSE after  adaquant: 2.846006e-04
 End of training layer  features.4.conv.0.0 better/total layers= 10 / 10 


Optimize 10:features.4.conv.1.0 for w4a8 bit of shape torch.Size([144, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.159022e-05
MSE after  adaquant: 1.200532e-05
 End of training layer  features.4.conv.1.0 better/total layers= 11 / 11 


Optimize 11:features.4.conv.2 for w4a8 bit of shape torch.Size([32, 144, 1, 1])

MSE before adaquant: 6.670250e-02
MSE after  adaquant: 3.289446e-03
 End of training layer  features.4.conv.2 better/total layers= 12 / 12 


Optimize 12:features.5.conv.0.0 for w4a8 bit of shape torch.Size([192, 32, 1, 1])

MSE before adaquant: 2.702675e-04
MSE after  adaquant: 1.023588e-04
 End of training layer  features.5.conv.0.0 better/total layers= 13 / 13 


Optimize 13:features.5.conv.1.0 for w4a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.040126e-05
MSE after  adaquant: 8.732704e-06
 End of training layer  features.5.conv.1.0 better/total layers= 14 / 14 


Optimize 14:features.5.conv.2 for w4a8 bit of shape torch.Size([32, 192, 1, 1])

MSE before adaquant: 1.456690e-02
MSE after  adaquant: 1.425340e-03
 End of training layer  features.5.conv.2 better/total layers= 15 / 15 


Optimize 15:features.6.conv.0.0 for w4a8 bit of shape torch.Size([192, 32, 1, 1])

MSE before adaquant: 2.354713e-04
MSE after  adaquant: 1.072355e-04
 End of training layer  features.6.conv.0.0 better/total layers= 16 / 16 


Optimize 16:features.6.conv.1.0 for w4a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.136162e-05
MSE after  adaquant: 7.152253e-06
 End of training layer  features.6.conv.1.0 better/total layers= 17 / 17 


Optimize 17:features.6.conv.2 for w4a8 bit of shape torch.Size([32, 192, 1, 1])

MSE before adaquant: 2.354343e-02
MSE after  adaquant: 1.667185e-03
 End of training layer  features.6.conv.2 better/total layers= 18 / 18 


Optimize 18:features.7.conv.0.0 for w4a8 bit of shape torch.Size([192, 32, 1, 1])

MSE before adaquant: 4.442949e-04
MSE after  adaquant: 2.172200e-04
 End of training layer  features.7.conv.0.0 better/total layers= 19 / 19 


Optimize 19:features.7.conv.1.0 for w4a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.190538e-05
MSE after  adaquant: 7.803798e-06
 End of training layer  features.7.conv.1.0 better/total layers= 20 / 20 


Optimize 20:features.7.conv.2 for w4a8 bit of shape torch.Size([64, 192, 1, 1])

MSE before adaquant: 9.124408e-02
MSE after  adaquant: 3.700631e-03
 End of training layer  features.7.conv.2 better/total layers= 21 / 21 


Optimize 21:features.8.conv.0.0 for w4a8 bit of shape torch.Size([384, 64, 1, 1])

MSE before adaquant: 2.261034e-04
MSE after  adaquant: 7.370044e-05
 End of training layer  features.8.conv.0.0 better/total layers= 22 / 22 


Optimize 22:features.8.conv.1.0 for w4a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.887624e-05
MSE after  adaquant: 4.433010e-06
 End of training layer  features.8.conv.1.0 better/total layers= 23 / 23 


Optimize 23:features.8.conv.2 for w4a8 bit of shape torch.Size([64, 384, 1, 1])

MSE before adaquant: 1.346825e-02
MSE after  adaquant: 9.512031e-04
 End of training layer  features.8.conv.2 better/total layers= 24 / 24 


Optimize 24:features.9.conv.0.0 for w4a8 bit of shape torch.Size([384, 64, 1, 1])

MSE before adaquant: 1.737016e-04
MSE after  adaquant: 6.976459e-05
 End of training layer  features.9.conv.0.0 better/total layers= 25 / 25 


Optimize 25:features.9.conv.1.0 for w4a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 9.284421e-06
MSE after  adaquant: 7.355639e-06
 End of training layer  features.9.conv.1.0 better/total layers= 26 / 26 


Optimize 26:features.9.conv.2 for w4a8 bit of shape torch.Size([64, 384, 1, 1])

MSE before adaquant: 1.351937e-02
MSE after  adaquant: 8.660272e-04
 End of training layer  features.9.conv.2 better/total layers= 27 / 27 


Optimize 27:features.10.conv.0.0 for w4a8 bit of shape torch.Size([384, 64, 1, 1])

MSE before adaquant: 1.661125e-04
MSE after  adaquant: 7.767574e-05
 End of training layer  features.10.conv.0.0 better/total layers= 28 / 28 


Optimize 28:features.10.conv.1.0 for w4a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 5.291362e-06
MSE after  adaquant: 2.786946e-06
 End of training layer  features.10.conv.1.0 better/total layers= 29 / 29 


Optimize 29:features.10.conv.2 for w4a8 bit of shape torch.Size([64, 384, 1, 1])

MSE before adaquant: 3.945570e-02
MSE after  adaquant: 1.553821e-03
 End of training layer  features.10.conv.2 better/total layers= 30 / 30 


Optimize 30:features.11.conv.0.0 for w4a8 bit of shape torch.Size([384, 64, 1, 1])

MSE before adaquant: 3.137188e-04
MSE after  adaquant: 1.401467e-04
 End of training layer  features.11.conv.0.0 better/total layers= 31 / 31 


Optimize 31:features.11.conv.1.0 for w4a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.629446e-05
MSE after  adaquant: 7.633479e-06
 End of training layer  features.11.conv.1.0 better/total layers= 32 / 32 


Optimize 32:features.11.conv.2 for w4a8 bit of shape torch.Size([96, 384, 1, 1])

MSE before adaquant: 2.607881e-02
MSE after  adaquant: 1.659718e-03
 End of training layer  features.11.conv.2 better/total layers= 33 / 33 


Optimize 33:features.12.conv.0.0 for w4a8 bit of shape torch.Size([576, 96, 1, 1])

MSE before adaquant: 2.302749e-04
MSE after  adaquant: 6.645959e-05
 End of training layer  features.12.conv.0.0 better/total layers= 34 / 34 


Optimize 34:features.12.conv.1.0 for w4a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.986546e-05
MSE after  adaquant: 1.433645e-05
 End of training layer  features.12.conv.1.0 better/total layers= 35 / 35 


Optimize 35:features.12.conv.2 for w4a8 bit of shape torch.Size([96, 576, 1, 1])

MSE before adaquant: 3.219185e-02
MSE after  adaquant: 1.470427e-03
 End of training layer  features.12.conv.2 better/total layers= 36 / 36 


Optimize 36:features.13.conv.0.0 for w4a8 bit of shape torch.Size([576, 96, 1, 1])

MSE before adaquant: 1.879447e-04
MSE after  adaquant: 7.124479e-05
 End of training layer  features.13.conv.0.0 better/total layers= 37 / 37 


Optimize 37:features.13.conv.1.0 for w4a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.081048e-05
MSE after  adaquant: 1.323937e-05
 End of training layer  features.13.conv.1.0 better/total layers= 38 / 38 


Optimize 38:features.13.conv.2 for w4a8 bit of shape torch.Size([96, 576, 1, 1])

MSE before adaquant: 6.721130e-02
MSE after  adaquant: 4.517559e-03
 End of training layer  features.13.conv.2 better/total layers= 39 / 39 


Optimize 39:features.14.conv.0.0 for w4a8 bit of shape torch.Size([576, 96, 1, 1])

MSE before adaquant: 5.141629e-04
MSE after  adaquant: 9.983894e-05
 End of training layer  features.14.conv.0.0 better/total layers= 40 / 40 


Optimize 40:features.14.conv.1.0 for w4a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 8.429982e-04
MSE after  adaquant: 4.578552e-06
 End of training layer  features.14.conv.1.0 better/total layers= 41 / 41 


Optimize 41:features.14.conv.2 for w4a8 bit of shape torch.Size([160, 576, 1, 1])

MSE before adaquant: 4.984240e-02
MSE after  adaquant: 1.744986e-03
 End of training layer  features.14.conv.2 better/total layers= 42 / 42 


Optimize 42:features.15.conv.0.0 for w4a8 bit of shape torch.Size([960, 160, 1, 1])

MSE before adaquant: 9.726478e-04
MSE after  adaquant: 8.773086e-05
 End of training layer  features.15.conv.0.0 better/total layers= 43 / 43 


Optimize 43:features.15.conv.1.0 for w4a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.049090e-03
MSE after  adaquant: 1.239622e-04
 End of training layer  features.15.conv.1.0 better/total layers= 44 / 44 


Optimize 44:features.15.conv.2 for w4a8 bit of shape torch.Size([160, 960, 1, 1])

MSE before adaquant: 2.743306e-02
MSE after  adaquant: 9.317169e-04
 End of training layer  features.15.conv.2 better/total layers= 45 / 45 


Optimize 45:features.16.conv.0.0 for w4a8 bit of shape torch.Size([960, 160, 1, 1])

MSE before adaquant: 2.008212e-03
MSE after  adaquant: 8.752351e-05
 End of training layer  features.16.conv.0.0 better/total layers= 46 / 46 


Optimize 46:features.16.conv.1.0 for w4a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.364703e-03
MSE after  adaquant: 1.239877e-03
 End of training layer  features.16.conv.1.0 better/total layers= 47 / 47 


Optimize 47:features.16.conv.2 for w4a8 bit of shape torch.Size([160, 960, 1, 1])

MSE before adaquant: 5.569855e-02
MSE after  adaquant: 2.667147e-03
 End of training layer  features.16.conv.2 better/total layers= 48 / 48 


Optimize 48:features.17.conv.0.0 for w4a8 bit of shape torch.Size([960, 160, 1, 1])

MSE before adaquant: 2.471021e-04
MSE after  adaquant: 3.225103e-05
 End of training layer  features.17.conv.0.0 better/total layers= 49 / 49 


Optimize 49:features.17.conv.1.0 for w4a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.516425e-05
MSE after  adaquant: 7.254001e-06
 End of training layer  features.17.conv.1.0 better/total layers= 50 / 50 


Optimize 50:features.17.conv.2 for w4a8 bit of shape torch.Size([320, 960, 1, 1])

MSE before adaquant: 8.030660e-02
MSE after  adaquant: 2.476172e-03
 End of training layer  features.17.conv.2 better/total layers= 51 / 51 


Optimize 51:features.18.0 for w8a8 bit of shape torch.Size([1280, 320, 1, 1])

MSE before adaquant: 5.022004e-02
MSE after  adaquant: 1.204485e-02
 End of training layer  features.18.0 better/total layers= 52 / 52 


Optimize 52:classifier.1 for w8a8 bit of shape torch.Size([1000, 1280])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 9.617271e-04
MSE after  adaquant: 4.197607e-04
 End of training layer  classifier.1 better/total layers= 53 / 53 

step 1: 
step 2: 
Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.2.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.7.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.9.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.10.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.11.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.14.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
read json file /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenetv2_adaquant.piano.kdp530.scaled.onnx.json
Json : Layer features.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.1.conv.1, precision switch from w8a8 to w8a8.
Json : Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.2.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.2.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.3.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.4.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.5.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.6.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.7.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.7.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.8.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.9.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.9.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.10.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.10.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.11.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.11.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.12.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.13.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.14.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.14.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.15.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.16.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.17.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.18.0, precision switch from w8a8 to w8a8.
Json : Layer classifier.1, precision switch from w8a8 to w8a8.
step 3: 
Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.2.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.7.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.9.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.10.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.11.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.14.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
Input/outputs cached

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.before_adaquant.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.before_adaquant.onnx
Bernard calculate float point model accuracy before enabling quantization!
Bernard calculate fixed point model accuracy before training!

Optimize 0:features.0.0 for w8a8 bit of shape torch.Size([32, 3, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.631438e-05
MSE after  adaquant: 7.752753e-06
 End of training layer  features.0.0 better/total layers= 1 / 1 


Optimize 1:features.1.conv.0.0 for w8a8 bit of shape torch.Size([32, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.219447e-03
MSE after  adaquant: 2.948561e-04
 End of training layer  features.1.conv.0.0 better/total layers= 2 / 2 


Optimize 2:features.1.conv.1 for w8a8 bit of shape torch.Size([16, 32, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.226180e-04
MSE after  adaquant: 2.797068e-04
 End of training layer  features.1.conv.1 better/total layers= 3 / 3 


Optimize 3:features.2.conv.0.0 for w8a8 bit of shape torch.Size([96, 16, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.544922e-05
MSE after  adaquant: 1.930435e-05
 End of training layer  features.2.conv.0.0 better/total layers= 4 / 4 


Optimize 4:features.2.conv.1.0 for w8a8 bit of shape torch.Size([96, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.460114e-04
MSE after  adaquant: 7.288493e-05
 End of training layer  features.2.conv.1.0 better/total layers= 5 / 5 


Optimize 5:features.2.conv.2 for w8a8 bit of shape torch.Size([24, 96, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.963789e-04
MSE after  adaquant: 1.612884e-04
 End of training layer  features.2.conv.2 better/total layers= 6 / 6 


Optimize 6:features.3.conv.0.0 for w8a8 bit of shape torch.Size([144, 24, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.329022e-05
MSE after  adaquant: 1.699721e-05
 End of training layer  features.3.conv.0.0 better/total layers= 7 / 7 


Optimize 7:features.3.conv.1.0 for w8a8 bit of shape torch.Size([144, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.376892e-05
MSE after  adaquant: 2.249750e-05
 End of training layer  features.3.conv.1.0 better/total layers= 8 / 8 


Optimize 8:features.3.conv.2 for w8a8 bit of shape torch.Size([24, 144, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.327751e-04
MSE after  adaquant: 1.447353e-04
 End of training layer  features.3.conv.2 better/total layers= 9 / 9 


Optimize 9:features.4.conv.0.0 for w8a8 bit of shape torch.Size([144, 24, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.226695e-05
MSE after  adaquant: 7.292144e-06
 End of training layer  features.4.conv.0.0 better/total layers= 10 / 10 


Optimize 10:features.4.conv.1.0 for w8a8 bit of shape torch.Size([144, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.159022e-05
MSE after  adaquant: 1.200532e-05
 End of training layer  features.4.conv.1.0 better/total layers= 11 / 11 


Optimize 11:features.4.conv.2 for w8a8 bit of shape torch.Size([32, 144, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.940185e-04
MSE after  adaquant: 9.798299e-05
 End of training layer  features.4.conv.2 better/total layers= 12 / 12 


Optimize 12:features.5.conv.0.0 for w8a8 bit of shape torch.Size([192, 32, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.110258e-06
MSE after  adaquant: 2.174498e-06
 End of training layer  features.5.conv.0.0 better/total layers= 13 / 13 


Optimize 13:features.5.conv.1.0 for w8a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.040126e-05
MSE after  adaquant: 8.732704e-06
 End of training layer  features.5.conv.1.0 better/total layers= 14 / 14 


Optimize 14:features.5.conv.2 for w8a8 bit of shape torch.Size([32, 192, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 9.484359e-05
MSE after  adaquant: 3.731080e-05
 End of training layer  features.5.conv.2 better/total layers= 15 / 15 


Optimize 15:features.6.conv.0.0 for w8a8 bit of shape torch.Size([192, 32, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.010317e-06
MSE after  adaquant: 2.200520e-06
 End of training layer  features.6.conv.0.0 better/total layers= 16 / 16 


Optimize 16:features.6.conv.1.0 for w8a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.136162e-05
MSE after  adaquant: 7.152253e-06
 End of training layer  features.6.conv.1.0 better/total layers= 17 / 17 


Optimize 17:features.6.conv.2 for w8a8 bit of shape torch.Size([32, 192, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.423344e-04
MSE after  adaquant: 5.298745e-05
 End of training layer  features.6.conv.2 better/total layers= 18 / 18 


Optimize 18:features.7.conv.0.0 for w8a8 bit of shape torch.Size([192, 32, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 6.030399e-06
MSE after  adaquant: 4.323227e-06
 End of training layer  features.7.conv.0.0 better/total layers= 19 / 19 


Optimize 19:features.7.conv.1.0 for w8a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.190538e-05
MSE after  adaquant: 7.803798e-06
 End of training layer  features.7.conv.1.0 better/total layers= 20 / 20 


Optimize 20:features.7.conv.2 for w8a8 bit of shape torch.Size([64, 192, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.863942e-04
MSE after  adaquant: 8.453082e-05
 End of training layer  features.7.conv.2 better/total layers= 21 / 21 


Optimize 21:features.8.conv.0.0 for w8a8 bit of shape torch.Size([384, 64, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.787438e-06
MSE after  adaquant: 1.540315e-06
 End of training layer  features.8.conv.0.0 better/total layers= 22 / 22 


Optimize 22:features.8.conv.1.0 for w8a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.887624e-05
MSE after  adaquant: 4.433010e-06
 End of training layer  features.8.conv.1.0 better/total layers= 23 / 23 


Optimize 23:features.8.conv.2 for w8a8 bit of shape torch.Size([64, 384, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.228710e-04
MSE after  adaquant: 2.675806e-05
 End of training layer  features.8.conv.2 better/total layers= 24 / 24 


Optimize 24:features.9.conv.0.0 for w8a8 bit of shape torch.Size([384, 64, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.531867e-06
MSE after  adaquant: 1.470782e-06
 End of training layer  features.9.conv.0.0 better/total layers= 25 / 25 


Optimize 25:features.9.conv.1.0 for w8a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 9.284421e-06
MSE after  adaquant: 7.355639e-06
 End of training layer  features.9.conv.1.0 better/total layers= 26 / 26 


Optimize 26:features.9.conv.2 for w8a8 bit of shape torch.Size([64, 384, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 7.676485e-05
MSE after  adaquant: 2.261384e-05
 End of training layer  features.9.conv.2 better/total layers= 27 / 27 


Optimize 27:features.10.conv.0.0 for w8a8 bit of shape torch.Size([384, 64, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.462141e-06
MSE after  adaquant: 1.392392e-06
 End of training layer  features.10.conv.0.0 better/total layers= 28 / 28 


Optimize 28:features.10.conv.1.0 for w8a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 5.291362e-06
MSE after  adaquant: 2.786946e-06
 End of training layer  features.10.conv.1.0 better/total layers= 29 / 29 


Optimize 29:features.10.conv.2 for w8a8 bit of shape torch.Size([64, 384, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.124583e-04
MSE after  adaquant: 6.416628e-05
 End of training layer  features.10.conv.2 better/total layers= 30 / 30 


Optimize 30:features.11.conv.0.0 for w8a8 bit of shape torch.Size([384, 64, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.340239e-06
MSE after  adaquant: 2.245527e-06
 End of training layer  features.11.conv.0.0 better/total layers= 31 / 31 


Optimize 31:features.11.conv.1.0 for w8a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.629446e-05
MSE after  adaquant: 7.633479e-06
 End of training layer  features.11.conv.1.0 better/total layers= 32 / 32 


Optimize 32:features.11.conv.2 for w8a8 bit of shape torch.Size([96, 384, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.141030e-04
MSE after  adaquant: 3.515968e-05
 End of training layer  features.11.conv.2 better/total layers= 33 / 33 


Optimize 33:features.12.conv.0.0 for w8a8 bit of shape torch.Size([576, 96, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.808915e-06
MSE after  adaquant: 2.249644e-06
 End of training layer  features.12.conv.0.0 better/total layers= 34 / 34 


Optimize 34:features.12.conv.1.0 for w8a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.986546e-05
MSE after  adaquant: 1.433645e-05
 End of training layer  features.12.conv.1.0 better/total layers= 35 / 35 


Optimize 35:features.12.conv.2 for w8a8 bit of shape torch.Size([96, 576, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 6.526478e-04
MSE after  adaquant: 7.056318e-05
 End of training layer  features.12.conv.2 better/total layers= 36 / 36 


Optimize 36:features.13.conv.0.0 for w8a8 bit of shape torch.Size([576, 96, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.176437e-06
MSE after  adaquant: 1.969609e-06
 End of training layer  features.13.conv.0.0 better/total layers= 37 / 37 


Optimize 37:features.13.conv.1.0 for w8a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.081048e-05
MSE after  adaquant: 1.323937e-05
 End of training layer  features.13.conv.1.0 better/total layers= 38 / 38 


Optimize 38:features.13.conv.2 for w8a8 bit of shape torch.Size([96, 576, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.128241e-03
MSE after  adaquant: 2.378756e-04
 End of training layer  features.13.conv.2 better/total layers= 39 / 39 


Optimize 39:features.14.conv.0.0 for w8a8 bit of shape torch.Size([576, 96, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.101382e-04
MSE after  adaquant: 3.307422e-06
 End of training layer  features.14.conv.0.0 better/total layers= 40 / 40 


Optimize 40:features.14.conv.1.0 for w8a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 8.429982e-04
MSE after  adaquant: 4.578552e-06
 End of training layer  features.14.conv.1.0 better/total layers= 41 / 41 


Optimize 41:features.14.conv.2 for w8a8 bit of shape torch.Size([160, 576, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.265634e-02
MSE after  adaquant: 3.705117e-04
 End of training layer  features.14.conv.2 better/total layers= 42 / 42 


Optimize 42:features.15.conv.0.0 for w8a8 bit of shape torch.Size([960, 160, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 6.933766e-04
MSE after  adaquant: 3.412477e-05
 End of training layer  features.15.conv.0.0 better/total layers= 43 / 43 


Optimize 43:features.15.conv.1.0 for w8a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.049090e-03
MSE after  adaquant: 1.239622e-04
 End of training layer  features.15.conv.1.0 better/total layers= 44 / 44 


Optimize 44:features.15.conv.2 for w8a8 bit of shape torch.Size([160, 960, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.200041e-02
MSE after  adaquant: 3.666119e-04
 End of training layer  features.15.conv.2 better/total layers= 45 / 45 


Optimize 45:features.16.conv.0.0 for w8a8 bit of shape torch.Size([960, 160, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.784025e-03
MSE after  adaquant: 5.389930e-05
 End of training layer  features.16.conv.0.0 better/total layers= 46 / 46 


Optimize 46:features.16.conv.1.0 for w8a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.364703e-03
MSE after  adaquant: 1.239877e-03
 End of training layer  features.16.conv.1.0 better/total layers= 47 / 47 


Optimize 47:features.16.conv.2 for w8a8 bit of shape torch.Size([160, 960, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.568352e-02
MSE after  adaquant: 2.895998e-03
 End of training layer  features.16.conv.2 better/total layers= 48 / 48 


Optimize 48:features.17.conv.0.0 for w8a8 bit of shape torch.Size([960, 160, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.334085e-04
MSE after  adaquant: 1.426201e-05
 End of training layer  features.17.conv.0.0 better/total layers= 49 / 49 


Optimize 49:features.17.conv.1.0 for w8a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.516425e-05
MSE after  adaquant: 7.254001e-06
 End of training layer  features.17.conv.1.0 better/total layers= 50 / 50 


Optimize 50:features.17.conv.2 for w8a8 bit of shape torch.Size([320, 960, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 5.973329e-04
MSE after  adaquant: 1.521865e-04
 End of training layer  features.17.conv.2 better/total layers= 51 / 51 


Optimize 51:features.18.0 for w8a8 bit of shape torch.Size([1280, 320, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.836119e-04
MSE after  adaquant: 2.488298e-04
 End of training layer  features.18.0 better/total layers= 52 / 52 


Optimize 52:classifier.1 for w8a8 bit of shape torch.Size([1000, 1280])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 9.617271e-04
MSE after  adaquant: 4.197607e-04
 End of training layer  classifier.1 better/total layers= 53 / 53 

step 4
Train: ########### All 8bit results ###########
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
finished 0 out of 50
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
finished 1 out of 50
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
finished 2 out of 50
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w8a8 to w8a8.
finished 3 out of 50
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
finished 4 out of 50
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
finished 5 out of 50
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
finished 6 out of 50
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
finished 7 out of 50
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
finished 8 out of 50
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
finished 9 out of 50
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
finished 10 out of 50
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
finished 11 out of 50
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
finished 12 out of 50
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
finished 13 out of 50
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
finished 14 out of 50
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
finished 15 out of 50
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
finished 16 out of 50
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
finished 17 out of 50
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w8a8 to w8a8.
finished 18 out of 50
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
finished 19 out of 50
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
finished 20 out of 50
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
finished 21 out of 50
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
finished 22 out of 50
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
finished 23 out of 50
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w8a8 to w8a8.
finished 24 out of 50
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
finished 25 out of 50
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
finished 26 out of 50
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w8a8 to w8a8.
finished 27 out of 50
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
finished 28 out of 50
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
finished 29 out of 50
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w8a8 to w8a8.
finished 30 out of 50
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
finished 31 out of 50
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
finished 32 out of 50
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
finished 33 out of 50
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
finished 34 out of 50
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
finished 35 out of 50
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
finished 36 out of 50
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
finished 37 out of 50
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
finished 38 out of 50
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w8a8 to w8a8.
finished 39 out of 50
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
finished 40 out of 50
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
finished 41 out of 50
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
finished 42 out of 50
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
finished 43 out of 50
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
finished 44 out of 50
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
finished 45 out of 50
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
finished 46 out of 50
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
finished 47 out of 50
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
finished 48 out of 50
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
step 5
Found K = 38
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Achieved compression:  0.13129462439077028
Expected acc:  1.416616995426177
Params % in int 4 = 0.9496430048738378
Params % in int 8 = 0.050356995126162256
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.0.0 to w4a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
switched layer features.5.conv.2 to w4a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
switched layer features.10.conv.2 to w4a8
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.0.0 to w4a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
switched layer features.13.conv.2 to w4a8
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.0.0 to w4a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
switched layer features.14.conv.2 to w4a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
switched layer features.15.conv.2 to w4a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.0.0 to w4a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
switched layer features.17.conv.2 to w4a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13129462439077028, expected loss 1.416616995426177, actual acc 68.29999981689453, actual loss 1.290364291191101
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Found K = 33
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Achieved compression:  0.1453496214233045
Expected acc:  1.3250418497047418
Params % in int 4 = 0.837203028613564
Params % in int 8 = 0.16279697138643598
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
switched layer features.5.conv.2 to w4a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.0.0 to w4a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
switched layer features.15.conv.2 to w4a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.0.0 to w4a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
switched layer features.17.conv.2 to w4a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13129462439077028, expected loss 1.416616995426177, actual acc 68.29999981689453, actual loss 1.290364291191101
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.1453496214233045, expected loss 1.3250418497047418, actual acc 70.10000024414063, actual loss 1.1782442207336425
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Found K = 30
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Achieved compression:  0.152687354998831
Expected acc:  1.3025634838066096
Params % in int 4 = 0.778501160009352
Params % in int 8 = 0.22149883999064798
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
switched layer features.5.conv.2 to w4a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.0.0 to w8a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.0.0 to w8a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.0.0 to w4a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
switched layer features.15.conv.2 to w4a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.0.0 to w4a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
switched layer features.17.conv.2 to w4a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13129462439077028, expected loss 1.416616995426177, actual acc 68.29999981689453, actual loss 1.290364291191101
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.1453496214233045, expected loss 1.3250418497047418, actual acc 70.10000024414063, actual loss 1.1782442207336425
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.152687354998831, expected loss 1.3025634838066096, actual acc 70.79999926757813, actual loss 1.1669709854125976
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Found K = 29
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Achieved compression:  0.1634781396687229
Expected acc:  1.2855979932270043
Params % in int 4 = 0.6921748826502168
Params % in int 8 = 0.3078251173497833
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
switched layer features.5.conv.2 to w4a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.0.0 to w8a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.0.0 to w8a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.0.0 to w4a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
switched layer features.15.conv.2 to w4a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.0.0 to w4a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
switched layer features.17.conv.2 to w4a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13129462439077028, expected loss 1.416616995426177, actual acc 68.29999981689453, actual loss 1.290364291191101
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.1453496214233045, expected loss 1.3250418497047418, actual acc 70.10000024414063, actual loss 1.1782442207336425
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.152687354998831, expected loss 1.3025634838066096, actual acc 70.79999926757813, actual loss 1.1669709854125976
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.1634781396687229, expected loss 1.2855979932270043, actual acc 70.49999908447266, actual loss 1.1592132949829101
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Found K = 26
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Achieved compression:  0.17988013236695863
Expected acc:  1.2641107631645199
Params % in int 4 = 0.5609589410643311
Params % in int 8 = 0.4390410589356689
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
switched layer features.5.conv.2 to w4a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.0.0 to w8a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.0.0 to w8a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.0.0 to w8a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.0.0 to w8a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.0.0 to w4a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.0.0 to w4a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
switched layer features.17.conv.2 to w4a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13129462439077028, expected loss 1.416616995426177, actual acc 68.29999981689453, actual loss 1.290364291191101
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.1453496214233045, expected loss 1.3250418497047418, actual acc 70.10000024414063, actual loss 1.1782442207336425
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.152687354998831, expected loss 1.3025634838066096, actual acc 70.79999926757813, actual loss 1.1669709854125976
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.1634781396687229, expected loss 1.2855979932270043, actual acc 70.49999908447266, actual loss 1.1592132949829101
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.17988013236695863, expected loss 1.2641107631645199, actual acc 70.40000006103516, actual loss 1.1533089666366576
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Found K = 25
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Achieved compression:  0.20146170170674244
Expected acc:  1.2502316964588163
Params % in int 4 = 0.38830638634606046
Params % in int 8 = 0.6116936136539395
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
switched layer features.5.conv.2 to w4a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.0.0 to w8a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.0.0 to w8a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.0.0 to w8a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.0.0 to w8a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.0.0 to w4a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.0.0 to w4a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13129462439077028, expected loss 1.416616995426177, actual acc 68.29999981689453, actual loss 1.290364291191101
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.1453496214233045, expected loss 1.3250418497047418, actual acc 70.10000024414063, actual loss 1.1782442207336425
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.152687354998831, expected loss 1.3025634838066096, actual acc 70.79999926757813, actual loss 1.1669709854125976
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.1634781396687229, expected loss 1.2855979932270043, actual acc 70.49999908447266, actual loss 1.1592132949829101
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.17988013236695863, expected loss 1.2641107631645199, actual acc 70.40000006103516, actual loss 1.1533089666366576
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.20146170170674244, expected loss 1.2502316964588163, actual acc 70.99999890136719, actual loss 1.1271288328170777
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Found K = 25
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Achieved compression:  0.20146170170674244
Expected acc:  1.2502316964588163
Params % in int 4 = 0.38830638634606046
Params % in int 8 = 0.6116936136539395
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
switched layer features.5.conv.2 to w4a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.0.0 to w8a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.0.0 to w8a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.0.0 to w8a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.0.0 to w8a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.0.0 to w4a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.0.0 to w4a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13129462439077028, expected loss 1.416616995426177, actual acc 68.29999981689453, actual loss 1.290364291191101
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.1453496214233045, expected loss 1.3250418497047418, actual acc 70.10000024414063, actual loss 1.1782442207336425
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.152687354998831, expected loss 1.3025634838066096, actual acc 70.79999926757813, actual loss 1.1669709854125976
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.1634781396687229, expected loss 1.2855979932270043, actual acc 70.49999908447266, actual loss 1.1592132949829101
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.17988013236695863, expected loss 1.2641107631645199, actual acc 70.40000006103516, actual loss 1.1533089666366576
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.20146170170674244, expected loss 1.2502316964588163, actual acc 70.99999890136719, actual loss 1.1271288328170777
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.20146170170674244, expected loss 1.2502316964588163, actual acc 70.99999890136719, actual loss 1.1271288328170777
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Found K = 25
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Achieved compression:  0.20146170170674244
Expected acc:  1.2502316964588163
Params % in int 4 = 0.38830638634606046
Params % in int 8 = 0.6116936136539395
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
switched layer features.5.conv.2 to w4a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.0.0 to w8a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.0.0 to w8a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.0.0 to w8a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.0.0 to w8a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.0.0 to w4a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.0.0 to w4a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13129462439077028, expected loss 1.416616995426177, actual acc 68.29999981689453, actual loss 1.290364291191101
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.1453496214233045, expected loss 1.3250418497047418, actual acc 70.10000024414063, actual loss 1.1782442207336425
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.152687354998831, expected loss 1.3025634838066096, actual acc 70.79999926757813, actual loss 1.1669709854125976
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.1634781396687229, expected loss 1.2855979932270043, actual acc 70.49999908447266, actual loss 1.1592132949829101
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.17988013236695863, expected loss 1.2641107631645199, actual acc 70.40000006103516, actual loss 1.1533089666366576
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.20146170170674244, expected loss 1.2502316964588163, actual acc 70.99999890136719, actual loss 1.1271288328170777
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.20146170170674244, expected loss 1.2502316964588163, actual acc 70.99999890136719, actual loss 1.1271288328170777
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.20146170170674244, expected loss 1.2502316964588163, actual acc 70.99999890136719, actual loss 1.1271288328170777
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Found K = 23
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Achieved compression:  0.21397901192381705
Expected acc:  1.2458958281002044
Params % in int 4 = 0.2881679046094635
Params % in int 8 = 0.7118320953905365
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
switched layer features.5.conv.2 to w4a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.0.0 to w8a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.0.0 to w8a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.0.0 to w8a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.0.0 to w8a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.0.0 to w8a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.0.0 to w4a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.16.conv.0.0 to w8a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.0.0 to w4a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13129462439077028, expected loss 1.416616995426177, actual acc 68.29999981689453, actual loss 1.290364291191101
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.1453496214233045, expected loss 1.3250418497047418, actual acc 70.10000024414063, actual loss 1.1782442207336425
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.152687354998831, expected loss 1.3025634838066096, actual acc 70.79999926757813, actual loss 1.1669709854125976
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.1634781396687229, expected loss 1.2855979932270043, actual acc 70.49999908447266, actual loss 1.1592132949829101
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.17988013236695863, expected loss 1.2641107631645199, actual acc 70.40000006103516, actual loss 1.1533089666366576
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.20146170170674244, expected loss 1.2502316964588163, actual acc 70.99999890136719, actual loss 1.1271288328170777
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.20146170170674244, expected loss 1.2502316964588163, actual acc 70.99999890136719, actual loss 1.1271288328170777
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.20146170170674244, expected loss 1.2502316964588163, actual acc 70.99999890136719, actual loss 1.1271288328170777
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.21, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss, compression 0.21397901192381705, expected loss 1.2458958281002044, actual acc 71.49999969482423, actual loss 1.1323652296066284
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Found K = 21
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Achieved compression:  0.22865447907487005
Expected acc:  1.2432620180568696
Params % in int 4 = 0.1707641674010395
Params % in int 8 = 0.8292358325989605
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
switched layer features.5.conv.2 to w4a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.0.0 to w8a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.0.0 to w8a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.0.0 to w8a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.0.0 to w8a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.0.0 to w8a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.15.conv.0.0 to w8a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.16.conv.0.0 to w8a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.0.0 to w4a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13129462439077028, expected loss 1.416616995426177, actual acc 68.29999981689453, actual loss 1.290364291191101
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.1453496214233045, expected loss 1.3250418497047418, actual acc 70.10000024414063, actual loss 1.1782442207336425
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.152687354998831, expected loss 1.3025634838066096, actual acc 70.79999926757813, actual loss 1.1669709854125976
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.1634781396687229, expected loss 1.2855979932270043, actual acc 70.49999908447266, actual loss 1.1592132949829101
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.17988013236695863, expected loss 1.2641107631645199, actual acc 70.40000006103516, actual loss 1.1533089666366576
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.20146170170674244, expected loss 1.2502316964588163, actual acc 70.99999890136719, actual loss 1.1271288328170777
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.20146170170674244, expected loss 1.2502316964588163, actual acc 70.99999890136719, actual loss 1.1271288328170777
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.20146170170674244, expected loss 1.2502316964588163, actual acc 70.99999890136719, actual loss 1.1271288328170777
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.21, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss, compression 0.21397901192381705, expected loss 1.2458958281002044, actual acc 71.49999969482423, actual loss 1.1323652296066284
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.22, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss, compression 0.22865447907487005, expected loss 1.2432620180568696, actual acc 71.49999969482423, actual loss 1.1074773750305176
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Found K = 11
Final Solution:  {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [8, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [8, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [8, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [8, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [8, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Achieved compression:  0.23001007139902524
Expected acc:  1.2432520180568696
Params % in int 4 = 0.15991942880779814
Params % in int 8 = 0.8400805711922018
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.1.conv.0.0 to w8a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.1.0 to w8a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.1.0 to w8a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.1.0 to w8a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.1.0 to w8a8
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
switched layer features.5.conv.2 to w4a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.1.0 to w8a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.1.0 to w8a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.0.0 to w8a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.0.0 to w8a8
Layer features.9.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.1.0 to w8a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.0.0 to w8a8
Layer features.10.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.1.0 to w8a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.1.0 to w8a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.0.0 to w8a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.0.0 to w8a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.15.conv.0.0 to w8a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.16.conv.0.0 to w8a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.0.0 to w4a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.23_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.23_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13129462439077028, expected loss 1.416616995426177, actual acc 68.29999981689453, actual loss 1.290364291191101
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.1453496214233045, expected loss 1.3250418497047418, actual acc 70.10000024414063, actual loss 1.1782442207336425
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.152687354998831, expected loss 1.3025634838066096, actual acc 70.79999926757813, actual loss 1.1669709854125976
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.1634781396687229, expected loss 1.2855979932270043, actual acc 70.49999908447266, actual loss 1.1592132949829101
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.17988013236695863, expected loss 1.2641107631645199, actual acc 70.40000006103516, actual loss 1.1533089666366576
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.20146170170674244, expected loss 1.2502316964588163, actual acc 70.99999890136719, actual loss 1.1271288328170777
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.20146170170674244, expected loss 1.2502316964588163, actual acc 70.99999890136719, actual loss 1.1271288328170777
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.20146170170674244, expected loss 1.2502316964588163, actual acc 70.99999890136719, actual loss 1.1271288328170777
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.21, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss, compression 0.21397901192381705, expected loss 1.2458958281002044, actual acc 71.49999969482423, actual loss 1.1323652296066284
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.22, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss, compression 0.22865447907487005, expected loss 1.2432620180568696, actual acc 71.49999969482423, actual loss 1.1074773750305176
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.23, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.23_loss, compression 0.23001007139902524, expected loss 1.2432520180568696, actual acc 71.49999969482423, actual loss 1.1074773750305176
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [8, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [8, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [8, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [8, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [8, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Found K = 0
Final Solution:  {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [8, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [8, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [8, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [8, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [8, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [8, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Achieved compression:  0.25
Expected acc:  1.2432410180568696
Params % in int 4 = 0.0
Params % in int 8 = 1.0
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.1.conv.0.0 to w8a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.1.0 to w8a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.1.0 to w8a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.1.0 to w8a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.1.0 to w8a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.1.0 to w8a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.1.0 to w8a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.0.0 to w8a8
Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.1.0 to w8a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.0.0 to w8a8
Layer features.9.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.1.0 to w8a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.0.0 to w8a8
Layer features.10.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.1.0 to w8a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.1.0 to w8a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.0.0 to w8a8
Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.1.0 to w8a8
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
switched layer features.12.conv.2 to w8a8
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.0.0 to w8a8
Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.1.0 to w8a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.1.0 to w8a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.15.conv.0.0 to w8a8
Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.15.conv.1.0 to w8a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.16.conv.0.0 to w8a8
Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.16.conv.1.0 to w8a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.1.0 to w8a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.24_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.24_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13129462439077028, expected loss 1.416616995426177, actual acc 68.29999981689453, actual loss 1.290364291191101
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.1453496214233045, expected loss 1.3250418497047418, actual acc 70.10000024414063, actual loss 1.1782442207336425
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.152687354998831, expected loss 1.3025634838066096, actual acc 70.79999926757813, actual loss 1.1669709854125976
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.1634781396687229, expected loss 1.2855979932270043, actual acc 70.49999908447266, actual loss 1.1592132949829101
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.17988013236695863, expected loss 1.2641107631645199, actual acc 70.40000006103516, actual loss 1.1533089666366576
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.20146170170674244, expected loss 1.2502316964588163, actual acc 70.99999890136719, actual loss 1.1271288328170777
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.20146170170674244, expected loss 1.2502316964588163, actual acc 70.99999890136719, actual loss 1.1271288328170777
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.20146170170674244, expected loss 1.2502316964588163, actual acc 70.99999890136719, actual loss 1.1271288328170777
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.21, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss, compression 0.21397901192381705, expected loss 1.2458958281002044, actual acc 71.49999969482423, actual loss 1.1323652296066284
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.22, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss, compression 0.22865447907487005, expected loss 1.2432620180568696, actual acc 71.49999969482423, actual loss 1.1074773750305176
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.23, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.23_loss, compression 0.23001007139902524, expected loss 1.2432520180568696, actual acc 71.49999969482423, actual loss 1.1074773750305176
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [8, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [8, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [8, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [8, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [8, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.24, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.24_loss, compression 0.25, expected loss 1.2432410180568696, actual acc 72.29999951171875, actual loss 1.0900513162612915
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [8, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [8, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [8, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [8, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [8, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [8, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.13, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, actual_compression 0.13129462439077028, expected loss 1.416616995426177, actual acc 68.29999981689453, actual loss 1.290364291191101
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Compression thr 0.14, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, actual_compression 0.1453496214233045, expected loss 1.3250418497047418, actual acc 70.10000024414063, actual loss 1.1782442207336425
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Compression thr 0.15000000000000002, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, actual_compression 0.152687354998831, expected loss 1.3025634838066096, actual acc 70.79999926757813, actual loss 1.1669709854125976
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Compression thr 0.16000000000000003, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, actual_compression 0.1634781396687229, expected loss 1.2855979932270043, actual acc 70.49999908447266, actual loss 1.1592132949829101
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Compression thr 0.17000000000000004, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, actual_compression 0.17988013236695863, expected loss 1.2641107631645199, actual acc 70.40000006103516, actual loss 1.1533089666366576
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8']
Compression thr 0.18000000000000005, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, actual_compression 0.20146170170674244, expected loss 1.2502316964588163, actual acc 70.99999890136719, actual loss 1.1271288328170777
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Compression thr 0.19000000000000006, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, actual_compression 0.20146170170674244, expected loss 1.2502316964588163, actual acc 70.99999890136719, actual loss 1.1271288328170777
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Compression thr 0.20000000000000007, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, actual_compression 0.20146170170674244, expected loss 1.2502316964588163, actual acc 70.99999890136719, actual loss 1.1271288328170777
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Compression thr 0.21000000000000008, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss, actual_compression 0.21397901192381705, expected loss 1.2458958281002044, actual acc 71.49999969482423, actual loss 1.1323652296066284
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Compression thr 0.22000000000000008, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss, actual_compression 0.22865447907487005, expected loss 1.2432620180568696, actual acc 71.49999969482423, actual loss 1.1074773750305176
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Compression thr 0.2300000000000001, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.23_loss, actual_compression 0.23001007139902524, expected loss 1.2432520180568696, actual acc 71.49999969482423, actual loss 1.1074773750305176
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8']
Compression thr 0.2400000000000001, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.24_loss, actual_compression 0.25, expected loss 1.2432410180568696, actual acc 72.29999951171875, actual loss 1.0900513162612915
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
