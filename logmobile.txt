step 1: 
step 2: 
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
read json file /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenetv2_adaquant.piano.kdp530.scaled.onnx.json
Json : Layer features.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Json : Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.2.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.7.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.9.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.10.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.11.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.14.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.17.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.18.0, precision switch from w4a8 to w4a8.
Json : Layer classifier.1, precision switch from w8a8 to w8a8.
step 3: 
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
Input/outputs cached

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.before_adaquant.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.before_adaquant.onnx
Bernard calculate float point model accuracy before enabling quantization!
Bernard calculate fixed point model accuracy before training!

Optimize 0:features.0.0 for w8a8 bit of shape torch.Size([32, 3, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.631438e-05
MSE after  adaquant: 6.792959e-06
 End of training layer  features.0.0 better/total layers= 1 / 1 


Optimize 1:features.1.conv.0.0 for w4a8 bit of shape torch.Size([32, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.219447e-03
MSE after  adaquant: 2.948561e-04
 End of training layer  features.1.conv.0.0 better/total layers= 2 / 2 


Optimize 2:features.1.conv.1 for w4a8 bit of shape torch.Size([16, 32, 1, 1])

MSE before adaquant: 6.562681e-02
MSE after  adaquant: 6.729779e-03
 End of training layer  features.1.conv.1 better/total layers= 3 / 3 


Optimize 3:features.2.conv.0.0 for w4a8 bit of shape torch.Size([96, 16, 1, 1])

MSE before adaquant: 8.126380e-04
MSE after  adaquant: 3.286893e-04
 End of training layer  features.2.conv.0.0 better/total layers= 4 / 4 


Optimize 4:features.2.conv.1.0 for w4a8 bit of shape torch.Size([96, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 6.686311e-05
MSE after  adaquant: 3.312304e-05
 End of training layer  features.2.conv.1.0 better/total layers= 5 / 5 


Optimize 5:features.2.conv.2 for w4a8 bit of shape torch.Size([24, 96, 1, 1])

MSE before adaquant: 1.354802e-01
MSE after  adaquant: 2.967203e-03
 End of training layer  features.2.conv.2 better/total layers= 6 / 6 


Optimize 6:features.3.conv.0.0 for w4a8 bit of shape torch.Size([144, 24, 1, 1])

MSE before adaquant: 4.835264e-04
MSE after  adaquant: 1.600362e-04
 End of training layer  features.3.conv.0.0 better/total layers= 7 / 7 


Optimize 7:features.3.conv.1.0 for w4a8 bit of shape torch.Size([144, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.326752e-05
MSE after  adaquant: 2.183325e-05
 End of training layer  features.3.conv.1.0 better/total layers= 8 / 8 


Optimize 8:features.3.conv.2 for w4a8 bit of shape torch.Size([24, 144, 1, 1])

MSE before adaquant: 6.461850e-02
MSE after  adaquant: 4.437602e-03
 End of training layer  features.3.conv.2 better/total layers= 9 / 9 


Optimize 9:features.4.conv.0.0 for w4a8 bit of shape torch.Size([144, 24, 1, 1])

MSE before adaquant: 7.142762e-04
MSE after  adaquant: 2.750744e-04
 End of training layer  features.4.conv.0.0 better/total layers= 10 / 10 


Optimize 10:features.4.conv.1.0 for w4a8 bit of shape torch.Size([144, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.659103e-05
MSE after  adaquant: 9.503570e-06
 End of training layer  features.4.conv.1.0 better/total layers= 11 / 11 


Optimize 11:features.4.conv.2 for w4a8 bit of shape torch.Size([32, 144, 1, 1])

MSE before adaquant: 6.840894e-02
MSE after  adaquant: 3.786605e-03
 End of training layer  features.4.conv.2 better/total layers= 12 / 12 


Optimize 12:features.5.conv.0.0 for w4a8 bit of shape torch.Size([192, 32, 1, 1])

MSE before adaquant: 2.383923e-04
MSE after  adaquant: 1.029969e-04
 End of training layer  features.5.conv.0.0 better/total layers= 13 / 13 


Optimize 13:features.5.conv.1.0 for w4a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.040322e-05
MSE after  adaquant: 8.738416e-06
 End of training layer  features.5.conv.1.0 better/total layers= 14 / 14 


Optimize 14:features.5.conv.2 for w4a8 bit of shape torch.Size([32, 192, 1, 1])

MSE before adaquant: 1.697278e-02
MSE after  adaquant: 1.151533e-03
 End of training layer  features.5.conv.2 better/total layers= 15 / 15 


Optimize 15:features.6.conv.0.0 for w4a8 bit of shape torch.Size([192, 32, 1, 1])

MSE before adaquant: 2.192940e-04
MSE after  adaquant: 1.090033e-04
 End of training layer  features.6.conv.0.0 better/total layers= 16 / 16 


Optimize 16:features.6.conv.1.0 for w4a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.136162e-05
MSE after  adaquant: 7.152253e-06
 End of training layer  features.6.conv.1.0 better/total layers= 17 / 17 


Optimize 17:features.6.conv.2 for w4a8 bit of shape torch.Size([32, 192, 1, 1])

MSE before adaquant: 2.465269e-02
MSE after  adaquant: 1.781806e-03
 End of training layer  features.6.conv.2 better/total layers= 18 / 18 


Optimize 18:features.7.conv.0.0 for w4a8 bit of shape torch.Size([192, 32, 1, 1])

MSE before adaquant: 4.163148e-04
MSE after  adaquant: 2.163287e-04
 End of training layer  features.7.conv.0.0 better/total layers= 19 / 19 


Optimize 19:features.7.conv.1.0 for w4a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.190538e-05
MSE after  adaquant: 7.803798e-06
 End of training layer  features.7.conv.1.0 better/total layers= 20 / 20 


Optimize 20:features.7.conv.2 for w4a8 bit of shape torch.Size([64, 192, 1, 1])

MSE before adaquant: 9.209491e-02
MSE after  adaquant: 4.225245e-03
 End of training layer  features.7.conv.2 better/total layers= 21 / 21 


Optimize 21:features.8.conv.0.0 for w4a8 bit of shape torch.Size([384, 64, 1, 1])

MSE before adaquant: 2.110553e-04
MSE after  adaquant: 7.563193e-05
 End of training layer  features.8.conv.0.0 better/total layers= 22 / 22 


Optimize 22:features.8.conv.1.0 for w4a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.887624e-05
MSE after  adaquant: 4.433010e-06
 End of training layer  features.8.conv.1.0 better/total layers= 23 / 23 


Optimize 23:features.8.conv.2 for w4a8 bit of shape torch.Size([64, 384, 1, 1])

MSE before adaquant: 1.282790e-02
MSE after  adaquant: 9.290671e-04
 End of training layer  features.8.conv.2 better/total layers= 24 / 24 


Optimize 24:features.9.conv.0.0 for w4a8 bit of shape torch.Size([384, 64, 1, 1])

MSE before adaquant: 1.591320e-04
MSE after  adaquant: 7.023683e-05
 End of training layer  features.9.conv.0.0 better/total layers= 25 / 25 


Optimize 25:features.9.conv.1.0 for w4a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 5.718499e-06
MSE after  adaquant: 3.324376e-06
 End of training layer  features.9.conv.1.0 better/total layers= 26 / 26 


Optimize 26:features.9.conv.2 for w4a8 bit of shape torch.Size([64, 384, 1, 1])

MSE before adaquant: 1.345651e-02
MSE after  adaquant: 8.604648e-04
 End of training layer  features.9.conv.2 better/total layers= 27 / 27 


Optimize 27:features.10.conv.0.0 for w4a8 bit of shape torch.Size([384, 64, 1, 1])

MSE before adaquant: 1.554589e-04
MSE after  adaquant: 7.597742e-05
 End of training layer  features.10.conv.0.0 better/total layers= 28 / 28 


Optimize 28:features.10.conv.1.0 for w4a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 5.291362e-06
MSE after  adaquant: 2.786946e-06
 End of training layer  features.10.conv.1.0 better/total layers= 29 / 29 


Optimize 29:features.10.conv.2 for w4a8 bit of shape torch.Size([64, 384, 1, 1])

MSE before adaquant: 3.116540e-02
MSE after  adaquant: 1.626400e-03
 End of training layer  features.10.conv.2 better/total layers= 30 / 30 


Optimize 30:features.11.conv.0.0 for w4a8 bit of shape torch.Size([384, 64, 1, 1])

MSE before adaquant: 3.020919e-04
MSE after  adaquant: 1.395765e-04
 End of training layer  features.11.conv.0.0 better/total layers= 31 / 31 


Optimize 31:features.11.conv.1.0 for w4a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.628536e-05
MSE after  adaquant: 7.602255e-06
 End of training layer  features.11.conv.1.0 better/total layers= 32 / 32 


Optimize 32:features.11.conv.2 for w4a8 bit of shape torch.Size([96, 384, 1, 1])

MSE before adaquant: 2.734628e-02
MSE after  adaquant: 1.691545e-03
 End of training layer  features.11.conv.2 better/total layers= 33 / 33 


Optimize 33:features.12.conv.0.0 for w4a8 bit of shape torch.Size([576, 96, 1, 1])

MSE before adaquant: 2.056470e-04
MSE after  adaquant: 6.789979e-05
 End of training layer  features.12.conv.0.0 better/total layers= 34 / 34 


Optimize 34:features.12.conv.1.0 for w4a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.986546e-05
MSE after  adaquant: 1.433645e-05
 End of training layer  features.12.conv.1.0 better/total layers= 35 / 35 


Optimize 35:features.12.conv.2 for w4a8 bit of shape torch.Size([96, 576, 1, 1])

MSE before adaquant: 3.119843e-02
MSE after  adaquant: 1.453580e-03
 End of training layer  features.12.conv.2 better/total layers= 36 / 36 


Optimize 36:features.13.conv.0.0 for w4a8 bit of shape torch.Size([576, 96, 1, 1])

MSE before adaquant: 1.689576e-04
MSE after  adaquant: 7.147194e-05
 End of training layer  features.13.conv.0.0 better/total layers= 37 / 37 


Optimize 37:features.13.conv.1.0 for w4a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.081048e-05
MSE after  adaquant: 1.323937e-05
 End of training layer  features.13.conv.1.0 better/total layers= 38 / 38 


Optimize 38:features.13.conv.2 for w4a8 bit of shape torch.Size([96, 576, 1, 1])

MSE before adaquant: 6.118744e-02
MSE after  adaquant: 4.939312e-03
 End of training layer  features.13.conv.2 better/total layers= 39 / 39 


Optimize 39:features.14.conv.0.0 for w4a8 bit of shape torch.Size([576, 96, 1, 1])

MSE before adaquant: 5.804535e-04
MSE after  adaquant: 1.002500e-04
 End of training layer  features.14.conv.0.0 better/total layers= 40 / 40 


Optimize 40:features.14.conv.1.0 for w4a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 8.429982e-04
MSE after  adaquant: 4.578552e-06
 End of training layer  features.14.conv.1.0 better/total layers= 41 / 41 


Optimize 41:features.14.conv.2 for w4a8 bit of shape torch.Size([160, 576, 1, 1])

MSE before adaquant: 4.918335e-02
MSE after  adaquant: 1.882543e-03
 End of training layer  features.14.conv.2 better/total layers= 42 / 42 


Optimize 42:features.15.conv.0.0 for w4a8 bit of shape torch.Size([960, 160, 1, 1])

MSE before adaquant: 9.923580e-04
MSE after  adaquant: 9.083320e-05
 End of training layer  features.15.conv.0.0 better/total layers= 43 / 43 


Optimize 43:features.15.conv.1.0 for w4a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.044725e-03
MSE after  adaquant: 1.158230e-04
 End of training layer  features.15.conv.1.0 better/total layers= 44 / 44 


Optimize 44:features.15.conv.2 for w4a8 bit of shape torch.Size([160, 960, 1, 1])

MSE before adaquant: 2.729117e-02
MSE after  adaquant: 9.746459e-04
 End of training layer  features.15.conv.2 better/total layers= 45 / 45 


Optimize 45:features.16.conv.0.0 for w4a8 bit of shape torch.Size([960, 160, 1, 1])

MSE before adaquant: 2.150184e-03
MSE after  adaquant: 9.011543e-05
 End of training layer  features.16.conv.0.0 better/total layers= 46 / 46 


Optimize 46:features.16.conv.1.0 for w4a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.364117e-03
MSE after  adaquant: 1.237678e-03
 End of training layer  features.16.conv.1.0 better/total layers= 47 / 47 


Optimize 47:features.16.conv.2 for w4a8 bit of shape torch.Size([160, 960, 1, 1])

MSE before adaquant: 5.577325e-02
MSE after  adaquant: 2.723170e-03
 End of training layer  features.16.conv.2 better/total layers= 48 / 48 


Optimize 48:features.17.conv.0.0 for w4a8 bit of shape torch.Size([960, 160, 1, 1])

MSE before adaquant: 2.245158e-04
MSE after  adaquant: 3.209081e-05
 End of training layer  features.17.conv.0.0 better/total layers= 49 / 49 


Optimize 49:features.17.conv.1.0 for w4a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.516425e-05
MSE after  adaquant: 7.254001e-06
 End of training layer  features.17.conv.1.0 better/total layers= 50 / 50 


Optimize 50:features.17.conv.2 for w4a8 bit of shape torch.Size([320, 960, 1, 1])

MSE before adaquant: 8.169848e-02
MSE after  adaquant: 2.364487e-03
 End of training layer  features.17.conv.2 better/total layers= 51 / 51 


Optimize 51:features.18.0 for w8a8 bit of shape torch.Size([1280, 320, 1, 1])

MSE before adaquant: 4.876409e-02
MSE after  adaquant: 1.207801e-02
 End of training layer  features.18.0 better/total layers= 52 / 52 


Optimize 52:classifier.1 for w8a8 bit of shape torch.Size([1000, 1280])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 9.617271e-04
MSE after  adaquant: 4.197607e-04
 End of training layer  classifier.1 better/total layers= 53 / 53 

step 1: 
step 2: 
Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.2.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.7.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.9.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.10.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.11.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.14.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
read json file /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenetv2_adaquant.piano.kdp530.scaled.onnx.json
Json : Layer features.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.1.conv.1, precision switch from w8a8 to w8a8.
Json : Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.2.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.2.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.3.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.4.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.5.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.6.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.7.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.7.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.8.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.9.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.9.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.10.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.10.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.11.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.11.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.12.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.13.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.14.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.14.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.15.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.16.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.17.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.18.0, precision switch from w8a8 to w8a8.
Json : Layer classifier.1, precision switch from w8a8 to w8a8.
step 3: 
Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.2.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.7.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.9.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.10.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.11.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.14.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
Input/outputs cached

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.before_adaquant.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.before_adaquant.onnx
Bernard calculate float point model accuracy before enabling quantization!
Bernard calculate fixed point model accuracy before training!

Optimize 0:features.0.0 for w8a8 bit of shape torch.Size([32, 3, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.631438e-05
MSE after  adaquant: 8.026064e-06
 End of training layer  features.0.0 better/total layers= 1 / 1 


Optimize 1:features.1.conv.0.0 for w8a8 bit of shape torch.Size([32, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.219447e-03
MSE after  adaquant: 2.948561e-04
 End of training layer  features.1.conv.0.0 better/total layers= 2 / 2 


Optimize 2:features.1.conv.1 for w8a8 bit of shape torch.Size([16, 32, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.870319e-04
MSE after  adaquant: 2.887076e-04
 End of training layer  features.1.conv.1 better/total layers= 3 / 3 


Optimize 3:features.2.conv.0.0 for w8a8 bit of shape torch.Size([96, 16, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.185769e-05
MSE after  adaquant: 1.858779e-05
 End of training layer  features.2.conv.0.0 better/total layers= 4 / 4 


Optimize 4:features.2.conv.1.0 for w8a8 bit of shape torch.Size([96, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 6.686311e-05
MSE after  adaquant: 3.312304e-05
 End of training layer  features.2.conv.1.0 better/total layers= 5 / 5 


Optimize 5:features.2.conv.2 for w8a8 bit of shape torch.Size([24, 96, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 6.968844e-04
MSE after  adaquant: 1.865548e-04
 End of training layer  features.2.conv.2 better/total layers= 6 / 6 


Optimize 6:features.3.conv.0.0 for w8a8 bit of shape torch.Size([144, 24, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.145998e-05
MSE after  adaquant: 1.182575e-05
 End of training layer  features.3.conv.0.0 better/total layers= 7 / 7 


Optimize 7:features.3.conv.1.0 for w8a8 bit of shape torch.Size([144, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.326752e-05
MSE after  adaquant: 2.183325e-05
 End of training layer  features.3.conv.1.0 better/total layers= 8 / 8 


Optimize 8:features.3.conv.2 for w8a8 bit of shape torch.Size([24, 144, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.703782e-04
MSE after  adaquant: 1.446940e-04
 End of training layer  features.3.conv.2 better/total layers= 9 / 9 


Optimize 9:features.4.conv.0.0 for w8a8 bit of shape torch.Size([144, 24, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 9.514266e-06
MSE after  adaquant: 7.149816e-06
 End of training layer  features.4.conv.0.0 better/total layers= 10 / 10 


Optimize 10:features.4.conv.1.0 for w8a8 bit of shape torch.Size([144, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.659103e-05
MSE after  adaquant: 9.503570e-06
 End of training layer  features.4.conv.1.0 better/total layers= 11 / 11 


Optimize 11:features.4.conv.2 for w8a8 bit of shape torch.Size([32, 144, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.333829e-04
MSE after  adaquant: 9.840227e-05
 End of training layer  features.4.conv.2 better/total layers= 12 / 12 


Optimize 12:features.5.conv.0.0 for w8a8 bit of shape torch.Size([192, 32, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.832310e-06
MSE after  adaquant: 2.153867e-06
 End of training layer  features.5.conv.0.0 better/total layers= 13 / 13 


Optimize 13:features.5.conv.1.0 for w8a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.040322e-05
MSE after  adaquant: 8.738416e-06
 End of training layer  features.5.conv.1.0 better/total layers= 14 / 14 


Optimize 14:features.5.conv.2 for w8a8 bit of shape torch.Size([32, 192, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 9.417241e-05
MSE after  adaquant: 3.457326e-05
 End of training layer  features.5.conv.2 better/total layers= 15 / 15 


Optimize 15:features.6.conv.0.0 for w8a8 bit of shape torch.Size([192, 32, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.703277e-06
MSE after  adaquant: 2.149346e-06
 End of training layer  features.6.conv.0.0 better/total layers= 16 / 16 


Optimize 16:features.6.conv.1.0 for w8a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.136162e-05
MSE after  adaquant: 7.152253e-06
 End of training layer  features.6.conv.1.0 better/total layers= 17 / 17 


Optimize 17:features.6.conv.2 for w8a8 bit of shape torch.Size([32, 192, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.327535e-04
MSE after  adaquant: 4.833505e-05
 End of training layer  features.6.conv.2 better/total layers= 18 / 18 


Optimize 18:features.7.conv.0.0 for w8a8 bit of shape torch.Size([192, 32, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.990693e-06
MSE after  adaquant: 4.122804e-06
 End of training layer  features.7.conv.0.0 better/total layers= 19 / 19 


Optimize 19:features.7.conv.1.0 for w8a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.190538e-05
MSE after  adaquant: 7.803798e-06
 End of training layer  features.7.conv.1.0 better/total layers= 20 / 20 


Optimize 20:features.7.conv.2 for w8a8 bit of shape torch.Size([64, 192, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.890267e-04
MSE after  adaquant: 8.163527e-05
 End of training layer  features.7.conv.2 better/total layers= 21 / 21 


Optimize 21:features.8.conv.0.0 for w8a8 bit of shape torch.Size([384, 64, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.739219e-06
MSE after  adaquant: 1.508094e-06
 End of training layer  features.8.conv.0.0 better/total layers= 22 / 22 


Optimize 22:features.8.conv.1.0 for w8a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.887624e-05
MSE after  adaquant: 4.433010e-06
 End of training layer  features.8.conv.1.0 better/total layers= 23 / 23 


Optimize 23:features.8.conv.2 for w8a8 bit of shape torch.Size([64, 384, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.263789e-04
MSE after  adaquant: 2.752810e-05
 End of training layer  features.8.conv.2 better/total layers= 24 / 24 


Optimize 24:features.9.conv.0.0 for w8a8 bit of shape torch.Size([384, 64, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.447184e-06
MSE after  adaquant: 1.397393e-06
 End of training layer  features.9.conv.0.0 better/total layers= 25 / 25 


Optimize 25:features.9.conv.1.0 for w8a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 5.718499e-06
MSE after  adaquant: 3.324376e-06
 End of training layer  features.9.conv.1.0 better/total layers= 26 / 26 


Optimize 26:features.9.conv.2 for w8a8 bit of shape torch.Size([64, 384, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 7.033776e-05
MSE after  adaquant: 2.060259e-05
 End of training layer  features.9.conv.2 better/total layers= 27 / 27 


Optimize 27:features.10.conv.0.0 for w8a8 bit of shape torch.Size([384, 64, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.381219e-06
MSE after  adaquant: 1.341359e-06
 End of training layer  features.10.conv.0.0 better/total layers= 28 / 28 


Optimize 28:features.10.conv.1.0 for w8a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 5.291362e-06
MSE after  adaquant: 2.786946e-06
 End of training layer  features.10.conv.1.0 better/total layers= 29 / 29 


Optimize 29:features.10.conv.2 for w8a8 bit of shape torch.Size([64, 384, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.828222e-04
MSE after  adaquant: 6.718360e-05
 End of training layer  features.10.conv.2 better/total layers= 30 / 30 


Optimize 30:features.11.conv.0.0 for w8a8 bit of shape torch.Size([384, 64, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 5.936786e-06
MSE after  adaquant: 2.180853e-06
 End of training layer  features.11.conv.0.0 better/total layers= 31 / 31 


Optimize 31:features.11.conv.1.0 for w8a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.628536e-05
MSE after  adaquant: 7.602255e-06
 End of training layer  features.11.conv.1.0 better/total layers= 32 / 32 


Optimize 32:features.11.conv.2 for w8a8 bit of shape torch.Size([96, 384, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.227807e-04
MSE after  adaquant: 3.530456e-05
 End of training layer  features.11.conv.2 better/total layers= 33 / 33 


Optimize 33:features.12.conv.0.0 for w8a8 bit of shape torch.Size([576, 96, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.583543e-06
MSE after  adaquant: 2.091477e-06
 End of training layer  features.12.conv.0.0 better/total layers= 34 / 34 


Optimize 34:features.12.conv.1.0 for w8a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.986546e-05
MSE after  adaquant: 1.433645e-05
 End of training layer  features.12.conv.1.0 better/total layers= 35 / 35 


Optimize 35:features.12.conv.2 for w8a8 bit of shape torch.Size([96, 576, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 6.535437e-04
MSE after  adaquant: 6.864192e-05
 End of training layer  features.12.conv.2 better/total layers= 36 / 36 


Optimize 36:features.13.conv.0.0 for w8a8 bit of shape torch.Size([576, 96, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.028715e-06
MSE after  adaquant: 1.845680e-06
 End of training layer  features.13.conv.0.0 better/total layers= 37 / 37 


Optimize 37:features.13.conv.1.0 for w8a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.081048e-05
MSE after  adaquant: 1.323937e-05
 End of training layer  features.13.conv.1.0 better/total layers= 38 / 38 


Optimize 38:features.13.conv.2 for w8a8 bit of shape torch.Size([96, 576, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.124988e-03
MSE after  adaquant: 3.504042e-04
 End of training layer  features.13.conv.2 better/total layers= 39 / 39 


Optimize 39:features.14.conv.0.0 for w8a8 bit of shape torch.Size([576, 96, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.162519e-04
MSE after  adaquant: 2.677670e-06
 End of training layer  features.14.conv.0.0 better/total layers= 40 / 40 


Optimize 40:features.14.conv.1.0 for w8a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 8.429982e-04
MSE after  adaquant: 4.578552e-06
 End of training layer  features.14.conv.1.0 better/total layers= 41 / 41 


Optimize 41:features.14.conv.2 for w8a8 bit of shape torch.Size([160, 576, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.267088e-02
MSE after  adaquant: 3.883229e-04
 End of training layer  features.14.conv.2 better/total layers= 42 / 42 


Optimize 42:features.15.conv.0.0 for w8a8 bit of shape torch.Size([960, 160, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 7.700343e-04
MSE after  adaquant: 2.083918e-05
 End of training layer  features.15.conv.0.0 better/total layers= 43 / 43 


Optimize 43:features.15.conv.1.0 for w8a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.044725e-03
MSE after  adaquant: 1.158230e-04
 End of training layer  features.15.conv.1.0 better/total layers= 44 / 44 


Optimize 44:features.15.conv.2 for w8a8 bit of shape torch.Size([160, 960, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.200333e-02
MSE after  adaquant: 3.651931e-04
 End of training layer  features.15.conv.2 better/total layers= 45 / 45 


Optimize 45:features.16.conv.0.0 for w8a8 bit of shape torch.Size([960, 160, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.966696e-03
MSE after  adaquant: 5.643771e-05
 End of training layer  features.16.conv.0.0 better/total layers= 46 / 46 


Optimize 46:features.16.conv.1.0 for w8a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.364117e-03
MSE after  adaquant: 1.237678e-03
 End of training layer  features.16.conv.1.0 better/total layers= 47 / 47 


Optimize 47:features.16.conv.2 for w8a8 bit of shape torch.Size([160, 960, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.569356e-02
MSE after  adaquant: 2.845551e-03
 End of training layer  features.16.conv.2 better/total layers= 48 / 48 


Optimize 48:features.17.conv.0.0 for w8a8 bit of shape torch.Size([960, 160, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.364099e-04
MSE after  adaquant: 1.176330e-05
 End of training layer  features.17.conv.0.0 better/total layers= 49 / 49 


Optimize 49:features.17.conv.1.0 for w8a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.516425e-05
MSE after  adaquant: 7.254001e-06
 End of training layer  features.17.conv.1.0 better/total layers= 50 / 50 


Optimize 50:features.17.conv.2 for w8a8 bit of shape torch.Size([320, 960, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 5.900509e-04
MSE after  adaquant: 1.455313e-04
 End of training layer  features.17.conv.2 better/total layers= 51 / 51 


Optimize 51:features.18.0 for w8a8 bit of shape torch.Size([1280, 320, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.686186e-04
MSE after  adaquant: 2.460807e-04
 End of training layer  features.18.0 better/total layers= 52 / 52 


Optimize 52:classifier.1 for w8a8 bit of shape torch.Size([1000, 1280])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 9.617271e-04
MSE after  adaquant: 4.197607e-04
 End of training layer  classifier.1 better/total layers= 53 / 53 

step 4
Train: ########### All 8bit results ###########
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
finished 0 out of 50
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
finished 1 out of 50
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
finished 2 out of 50
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w8a8 to w8a8.
finished 3 out of 50
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
finished 4 out of 50
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
finished 5 out of 50
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
finished 6 out of 50
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
finished 7 out of 50
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
finished 8 out of 50
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
finished 9 out of 50
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
finished 10 out of 50
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
finished 11 out of 50
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
finished 12 out of 50
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
finished 13 out of 50
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
finished 14 out of 50
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
finished 15 out of 50
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
finished 16 out of 50
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
finished 17 out of 50
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w8a8 to w8a8.
finished 18 out of 50
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
finished 19 out of 50
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
finished 20 out of 50
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
finished 21 out of 50
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
finished 22 out of 50
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
finished 23 out of 50
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w8a8 to w8a8.
finished 24 out of 50
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
finished 25 out of 50
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
finished 26 out of 50
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w8a8 to w8a8.
finished 27 out of 50
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
finished 28 out of 50
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
finished 29 out of 50
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w8a8 to w8a8.
finished 30 out of 50
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
finished 31 out of 50
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
finished 32 out of 50
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
finished 33 out of 50
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
finished 34 out of 50
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
finished 35 out of 50
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
finished 36 out of 50
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
finished 37 out of 50
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
finished 38 out of 50
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w8a8 to w8a8.
finished 39 out of 50
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
finished 40 out of 50
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
finished 41 out of 50
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
finished 42 out of 50
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
finished 43 out of 50
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
finished 44 out of 50
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
finished 45 out of 50
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
finished 46 out of 50
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
finished 47 out of 50
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
finished 48 out of 50
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
step 5
Found K = 40
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Achieved compression:  0.13043136161717894
Expected acc:  1.3418958494949342
Params % in int 4 = 0.9565491070625686
Params % in int 8 = 0.043450892937431436
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.0.0 to w4a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.0.0 to w4a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
switched layer features.5.conv.2 to w4a8
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.0.0 to w4a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
switched layer features.10.conv.2 to w4a8
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.0.0 to w4a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
switched layer features.13.conv.2 to w4a8
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.0.0 to w4a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
switched layer features.14.conv.2 to w4a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
switched layer features.15.conv.2 to w4a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.0.0 to w4a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
switched layer features.17.conv.2 to w4a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13043136161717894, expected loss 1.3418958494949342, actual acc 67.19999990844727, actual loss 1.2954269762039186
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Found K = 38
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Achieved compression:  0.14079051490027517
Expected acc:  1.2887115130710602
Params % in int 4 = 0.8736758807977987
Params % in int 8 = 0.12632411920220132
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.0.0 to w4a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.0.0 to w4a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
switched layer features.5.conv.2 to w4a8
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.0.0 to w4a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
switched layer features.10.conv.2 to w4a8
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.0.0 to w4a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.0.0 to w4a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
switched layer features.15.conv.2 to w4a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.0.0 to w4a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
switched layer features.17.conv.2 to w4a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13043136161717894, expected loss 1.3418958494949342, actual acc 67.19999990844727, actual loss 1.2954269762039186
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14079051490027517, expected loss 1.2887115130710602, actual acc 67.50000042724609, actual loss 1.2309192724227904
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Found K = 34
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Achieved compression:  0.1567608762117152
Expected acc:  1.2668806979942324
Params % in int 4 = 0.7459129903062784
Params % in int 8 = 0.25408700969372155
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.0.0 to w4a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.0.0 to w4a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
switched layer features.5.conv.2 to w4a8
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.0.0 to w4a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.0.0 to w8a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.0.0 to w4a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.0.0 to w4a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
switched layer features.17.conv.2 to w4a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13043136161717894, expected loss 1.3418958494949342, actual acc 67.19999990844727, actual loss 1.2954269762039186
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14079051490027517, expected loss 1.2887115130710602, actual acc 67.50000042724609, actual loss 1.2309192724227904
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.1567608762117152, expected loss 1.2668806979942324, actual acc 69.19999926757812, actual loss 1.1962841415405274
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Found K = 33
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Achieved compression:  0.16064555869287628
Expected acc:  1.2617347727108004
Params % in int 4 = 0.7148355304569898
Params % in int 8 = 0.2851644695430103
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.0.0 to w4a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.0.0 to w4a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
switched layer features.5.conv.2 to w4a8
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.0.0 to w4a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.0.0 to w8a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.0.0 to w4a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
switched layer features.17.conv.2 to w4a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13043136161717894, expected loss 1.3418958494949342, actual acc 67.19999990844727, actual loss 1.2954269762039186
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14079051490027517, expected loss 1.2887115130710602, actual acc 67.50000042724609, actual loss 1.2309192724227904
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.1567608762117152, expected loss 1.2668806979942324, actual acc 69.19999926757812, actual loss 1.1962841415405274
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16064555869287628, expected loss 1.2617347727108004, actual acc 69.4000004272461, actual loss 1.1893514032363892
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Found K = 32
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8']
Achieved compression:  0.1714363433627682
Expected acc:  1.256345553188324
Params % in int 4 = 0.6285092530978544
Params % in int 8 = 0.37149074690214556
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.0.0 to w4a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.0.0 to w4a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
switched layer features.5.conv.2 to w4a8
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.0.0 to w4a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.0.0 to w8a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
switched layer features.17.conv.2 to w4a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13043136161717894, expected loss 1.3418958494949342, actual acc 67.19999990844727, actual loss 1.2954269762039186
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14079051490027517, expected loss 1.2887115130710602, actual acc 67.50000042724609, actual loss 1.2309192724227904
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.1567608762117152, expected loss 1.2668806979942324, actual acc 69.19999926757812, actual loss 1.1962841415405274
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16064555869287628, expected loss 1.2617347727108004, actual acc 69.4000004272461, actual loss 1.1893514032363892
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.1714363433627682, expected loss 1.256345553188324, actual acc 69.3999994506836, actual loss 1.1794587888717651
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Found K = 31
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Achieved compression:  0.19301791270255203
Expected acc:  1.2487962434577942
Params % in int 4 = 0.4558566983795838
Params % in int 8 = 0.5441433016204161
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.0.0 to w4a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.0.0 to w4a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
switched layer features.5.conv.2 to w4a8
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.0.0 to w4a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.0.0 to w8a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13043136161717894, expected loss 1.3418958494949342, actual acc 67.19999990844727, actual loss 1.2954269762039186
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14079051490027517, expected loss 1.2887115130710602, actual acc 67.50000042724609, actual loss 1.2309192724227904
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.1567608762117152, expected loss 1.2668806979942324, actual acc 69.19999926757812, actual loss 1.1962841415405274
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16064555869287628, expected loss 1.2617347727108004, actual acc 69.4000004272461, actual loss 1.1893514032363892
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.1714363433627682, expected loss 1.256345553188324, actual acc 69.3999994506836, actual loss 1.1794587888717651
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.19301791270255203, expected loss 1.2487962434577942, actual acc 70.29999926757813, actual loss 1.151705072402954
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Found K = 31
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Achieved compression:  0.19301791270255203
Expected acc:  1.2487962434577942
Params % in int 4 = 0.4558566983795838
Params % in int 8 = 0.5441433016204161
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.0.0 to w4a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.0.0 to w4a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
switched layer features.5.conv.2 to w4a8
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.0.0 to w4a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.0.0 to w8a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13043136161717894, expected loss 1.3418958494949342, actual acc 67.19999990844727, actual loss 1.2954269762039186
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14079051490027517, expected loss 1.2887115130710602, actual acc 67.50000042724609, actual loss 1.2309192724227904
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.1567608762117152, expected loss 1.2668806979942324, actual acc 69.19999926757812, actual loss 1.1962841415405274
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16064555869287628, expected loss 1.2617347727108004, actual acc 69.4000004272461, actual loss 1.1893514032363892
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.1714363433627682, expected loss 1.256345553188324, actual acc 69.3999994506836, actual loss 1.1794587888717651
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.19301791270255203, expected loss 1.2487962434577942, actual acc 70.29999926757813, actual loss 1.151705072402954
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.19301791270255203, expected loss 1.2487962434577942, actual acc 70.29999926757813, actual loss 1.151705072402954
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Found K = 30
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Achieved compression:  0.20380869737244392
Expected acc:  1.247927309064865
Params % in int 4 = 0.36953042102044853
Params % in int 8 = 0.6304695789795515
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.0.0 to w4a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.0.0 to w4a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
switched layer features.5.conv.2 to w4a8
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.0.0 to w4a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.0.0 to w8a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.15.conv.0.0 to w8a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13043136161717894, expected loss 1.3418958494949342, actual acc 67.19999990844727, actual loss 1.2954269762039186
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14079051490027517, expected loss 1.2887115130710602, actual acc 67.50000042724609, actual loss 1.2309192724227904
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.1567608762117152, expected loss 1.2668806979942324, actual acc 69.19999926757812, actual loss 1.1962841415405274
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16064555869287628, expected loss 1.2617347727108004, actual acc 69.4000004272461, actual loss 1.1893514032363892
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.1714363433627682, expected loss 1.256345553188324, actual acc 69.3999994506836, actual loss 1.1794587888717651
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.19301791270255203, expected loss 1.2487962434577942, actual acc 70.29999926757813, actual loss 1.151705072402954
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.19301791270255203, expected loss 1.2487962434577942, actual acc 70.29999926757813, actual loss 1.151705072402954
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.20380869737244392, expected loss 1.247927309064865, actual acc 70.69999987792968, actual loss 1.1487084131240846
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Found K = 8
Final Solution:  {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [8, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [8, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [8, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [8, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [8, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [8, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Achieved compression:  0.2115848065751848
Expected acc:  1.247905309064865
Params % in int 4 = 0.3073215473985217
Params % in int 8 = 0.6926784526014783
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.1.conv.0.0 to w8a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.1.0 to w8a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.1.0 to w8a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.1.0 to w8a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.1.0 to w8a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.1.0 to w8a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.1.0 to w8a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.1.0 to w8a8
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.1.0 to w8a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.0.0 to w8a8
Layer features.10.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.1.0 to w8a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.1.0 to w8a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.1.0 to w8a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.1.0 to w8a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.1.0 to w8a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.15.conv.0.0 to w8a8
Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.15.conv.1.0 to w8a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.16.conv.1.0 to w8a8
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.1.0 to w8a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13043136161717894, expected loss 1.3418958494949342, actual acc 67.19999990844727, actual loss 1.2954269762039186
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14079051490027517, expected loss 1.2887115130710602, actual acc 67.50000042724609, actual loss 1.2309192724227904
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.1567608762117152, expected loss 1.2668806979942324, actual acc 69.19999926757812, actual loss 1.1962841415405274
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16064555869287628, expected loss 1.2617347727108004, actual acc 69.4000004272461, actual loss 1.1893514032363892
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.1714363433627682, expected loss 1.256345553188324, actual acc 69.3999994506836, actual loss 1.1794587888717651
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.19301791270255203, expected loss 1.2487962434577942, actual acc 70.29999926757813, actual loss 1.151705072402954
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.19301791270255203, expected loss 1.2487962434577942, actual acc 70.29999926757813, actual loss 1.151705072402954
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.20380869737244392, expected loss 1.247927309064865, actual acc 70.69999987792968, actual loss 1.1487084131240846
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.21, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss, compression 0.2115848065751848, expected loss 1.247905309064865, actual acc 71.19999890136718, actual loss 1.1200905084609984
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [8, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [8, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [8, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [8, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [8, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [8, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Found K = 4
Final Solution:  {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [8, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [8, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [8, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [8, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [8, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [8, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Achieved compression:  0.220649065697894
Expected acc:  1.247901309064865
Params % in int 4 = 0.23480747441684802
Params % in int 8 = 0.765192525583152
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.1.conv.0.0 to w8a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.1.0 to w8a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.1.0 to w8a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.1.0 to w8a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.1.0 to w8a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.1.0 to w8a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.1.0 to w8a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.0.0 to w8a8
Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.1.0 to w8a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.0.0 to w8a8
Layer features.9.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.1.0 to w8a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.0.0 to w8a8
Layer features.10.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.1.0 to w8a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.1.0 to w8a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.1.0 to w8a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.0.0 to w8a8
Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.1.0 to w8a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.1.0 to w8a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.15.conv.0.0 to w8a8
Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.15.conv.1.0 to w8a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.16.conv.1.0 to w8a8
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.1.0 to w8a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13043136161717894, expected loss 1.3418958494949342, actual acc 67.19999990844727, actual loss 1.2954269762039186
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14079051490027517, expected loss 1.2887115130710602, actual acc 67.50000042724609, actual loss 1.2309192724227904
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.1567608762117152, expected loss 1.2668806979942324, actual acc 69.19999926757812, actual loss 1.1962841415405274
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16064555869287628, expected loss 1.2617347727108004, actual acc 69.4000004272461, actual loss 1.1893514032363892
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.1714363433627682, expected loss 1.256345553188324, actual acc 69.3999994506836, actual loss 1.1794587888717651
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.19301791270255203, expected loss 1.2487962434577942, actual acc 70.29999926757813, actual loss 1.151705072402954
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.19301791270255203, expected loss 1.2487962434577942, actual acc 70.29999926757813, actual loss 1.151705072402954
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.20380869737244392, expected loss 1.247927309064865, actual acc 70.69999987792968, actual loss 1.1487084131240846
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.21, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss, compression 0.2115848065751848, expected loss 1.247905309064865, actual acc 71.19999890136718, actual loss 1.1200905084609984
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [8, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [8, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [8, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [8, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [8, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [8, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.22, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss, compression 0.220649065697894, expected loss 1.247901309064865, actual acc 71.39999908447265, actual loss 1.109050708770752
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [8, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [8, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [8, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [8, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [8, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [8, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Found K = 1
Final Solution:  {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [8, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [8, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [8, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [8, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [8, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [8, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Achieved compression:  0.23920921533010808
Expected acc:  1.247898309064865
Params % in int 4 = 0.0863262773591353
Params % in int 8 = 0.9136737226408647
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.1.conv.0.0 to w8a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.1.0 to w8a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.1.0 to w8a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.1.0 to w8a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.1.0 to w8a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.1.0 to w8a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.1.0 to w8a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.0.0 to w8a8
Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.1.0 to w8a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.0.0 to w8a8
Layer features.9.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.1.0 to w8a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.0.0 to w8a8
Layer features.10.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.1.0 to w8a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.1.0 to w8a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.0.0 to w8a8
Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.1.0 to w8a8
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
switched layer features.12.conv.2 to w8a8
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.0.0 to w8a8
Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.1.0 to w8a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.1.0 to w8a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.15.conv.0.0 to w8a8
Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.15.conv.1.0 to w8a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.16.conv.1.0 to w8a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.1.0 to w8a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.23_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.23_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13043136161717894, expected loss 1.3418958494949342, actual acc 67.19999990844727, actual loss 1.2954269762039186
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14079051490027517, expected loss 1.2887115130710602, actual acc 67.50000042724609, actual loss 1.2309192724227904
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.1567608762117152, expected loss 1.2668806979942324, actual acc 69.19999926757812, actual loss 1.1962841415405274
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16064555869287628, expected loss 1.2617347727108004, actual acc 69.4000004272461, actual loss 1.1893514032363892
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.1714363433627682, expected loss 1.256345553188324, actual acc 69.3999994506836, actual loss 1.1794587888717651
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.19301791270255203, expected loss 1.2487962434577942, actual acc 70.29999926757813, actual loss 1.151705072402954
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.19301791270255203, expected loss 1.2487962434577942, actual acc 70.29999926757813, actual loss 1.151705072402954
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.20380869737244392, expected loss 1.247927309064865, actual acc 70.69999987792968, actual loss 1.1487084131240846
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.21, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss, compression 0.2115848065751848, expected loss 1.247905309064865, actual acc 71.19999890136718, actual loss 1.1200905084609984
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [8, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [8, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [8, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [8, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [8, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [8, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.22, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss, compression 0.220649065697894, expected loss 1.247901309064865, actual acc 71.39999908447265, actual loss 1.109050708770752
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [8, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [8, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [8, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [8, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [8, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [8, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.23, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.23_loss, compression 0.23920921533010808, expected loss 1.247898309064865, actual acc 71.79999914550781, actual loss 1.0879131517410279
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [8, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [8, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [8, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [8, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [8, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [8, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Found K = 0
Final Solution:  {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [8, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [8, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [8, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [8, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [8, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [8, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Achieved compression:  0.25
Expected acc:  1.247897309064865
Params % in int 4 = 0.0
Params % in int 8 = 1.0
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.1.conv.0.0 to w8a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.1.0 to w8a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.1.0 to w8a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.1.0 to w8a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.1.0 to w8a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.1.0 to w8a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.1.0 to w8a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.0.0 to w8a8
Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.1.0 to w8a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.0.0 to w8a8
Layer features.9.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.1.0 to w8a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.0.0 to w8a8
Layer features.10.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.1.0 to w8a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.1.0 to w8a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.0.0 to w8a8
Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.1.0 to w8a8
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
switched layer features.12.conv.2 to w8a8
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.0.0 to w8a8
Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.1.0 to w8a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.1.0 to w8a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.15.conv.0.0 to w8a8
Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.15.conv.1.0 to w8a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.16.conv.0.0 to w8a8
Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.16.conv.1.0 to w8a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.1.0 to w8a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.11.0...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.24_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.24_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13043136161717894, expected loss 1.3418958494949342, actual acc 67.19999990844727, actual loss 1.2954269762039186
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14079051490027517, expected loss 1.2887115130710602, actual acc 67.50000042724609, actual loss 1.2309192724227904
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.1567608762117152, expected loss 1.2668806979942324, actual acc 69.19999926757812, actual loss 1.1962841415405274
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16064555869287628, expected loss 1.2617347727108004, actual acc 69.4000004272461, actual loss 1.1893514032363892
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.1714363433627682, expected loss 1.256345553188324, actual acc 69.3999994506836, actual loss 1.1794587888717651
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.19301791270255203, expected loss 1.2487962434577942, actual acc 70.29999926757813, actual loss 1.151705072402954
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.19301791270255203, expected loss 1.2487962434577942, actual acc 70.29999926757813, actual loss 1.151705072402954
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.20380869737244392, expected loss 1.247927309064865, actual acc 70.69999987792968, actual loss 1.1487084131240846
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.21, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss, compression 0.2115848065751848, expected loss 1.247905309064865, actual acc 71.19999890136718, actual loss 1.1200905084609984
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [8, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [8, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [8, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [8, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [8, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [8, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.22, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss, compression 0.220649065697894, expected loss 1.247901309064865, actual acc 71.39999908447265, actual loss 1.109050708770752
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [8, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [8, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [8, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [8, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [8, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [8, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.23, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.23_loss, compression 0.23920921533010808, expected loss 1.247898309064865, actual acc 71.79999914550781, actual loss 1.0879131517410279
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [8, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [8, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [8, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [8, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [8, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [8, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.24, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.24_loss, compression 0.25, expected loss 1.247897309064865, actual acc 71.79999914550781, actual loss 1.0875069065093994
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [8, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [8, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [8, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [8, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [8, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [8, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.13, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, actual_compression 0.13043136161717894, expected loss 1.3418958494949342, actual acc 67.19999990844727, actual loss 1.2954269762039186
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Compression thr 0.14, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, actual_compression 0.14079051490027517, expected loss 1.2887115130710602, actual acc 67.50000042724609, actual loss 1.2309192724227904
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Compression thr 0.15000000000000002, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, actual_compression 0.1567608762117152, expected loss 1.2668806979942324, actual acc 69.19999926757812, actual loss 1.1962841415405274
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Compression thr 0.16000000000000003, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, actual_compression 0.16064555869287628, expected loss 1.2617347727108004, actual acc 69.4000004272461, actual loss 1.1893514032363892
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Compression thr 0.17000000000000004, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, actual_compression 0.1714363433627682, expected loss 1.256345553188324, actual acc 69.3999994506836, actual loss 1.1794587888717651
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8']
Compression thr 0.18000000000000005, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, actual_compression 0.19301791270255203, expected loss 1.2487962434577942, actual acc 70.29999926757813, actual loss 1.151705072402954
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Compression thr 0.19000000000000006, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, actual_compression 0.19301791270255203, expected loss 1.2487962434577942, actual acc 70.29999926757813, actual loss 1.151705072402954
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Compression thr 0.20000000000000007, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, actual_compression 0.20380869737244392, expected loss 1.247927309064865, actual acc 70.69999987792968, actual loss 1.1487084131240846
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Compression thr 0.21000000000000008, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss, actual_compression 0.2115848065751848, expected loss 1.247905309064865, actual acc 71.19999890136718, actual loss 1.1200905084609984
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Compression thr 0.22000000000000008, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss, actual_compression 0.220649065697894, expected loss 1.247901309064865, actual acc 71.39999908447265, actual loss 1.109050708770752
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Compression thr 0.2300000000000001, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.23_loss, actual_compression 0.23920921533010808, expected loss 1.247898309064865, actual acc 71.79999914550781, actual loss 1.0879131517410279
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Compression thr 0.2400000000000001, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.24_loss, actual_compression 0.25, expected loss 1.247897309064865, actual acc 71.79999914550781, actual loss 1.0875069065093994
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
