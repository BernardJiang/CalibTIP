step 1: 
step 2: 
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
read json file /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenetv2_adaquant.piano.kdp530.scaled.onnx.json
Json : Layer features.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Json : Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.2.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.7.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.9.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.10.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.11.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.14.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Json : Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.17.conv.2, precision switch from w4a8 to w4a8.
Json : Layer features.18.0, precision switch from w4a8 to w4a8.
Json : Layer classifier.1, precision switch from w8a8 to w8a8.
step 3: 
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
Input/outputs cached

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.before_adaquant.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.before_adaquant.onnx
Bernard calculate float point model accuracy before enabling quantization!
Bernard calculate fixed point model accuracy before training!

Optimize 0:features.0.0 for w8a8 bit of shape torch.Size([32, 3, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.579253e-05
MSE after  adaquant: 1.440952e-05
layer features.1.conv.0.0's input scale is updated
 End of training layer  features.0.0 better/total layers= 1 / 1 


Optimize 1:features.1.conv.0.0 for w4a8 bit of shape torch.Size([32, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 9.229539e-04
MSE after  adaquant: 6.315759e-04
layer features.1.conv.1's input scale is updated
 End of training layer  features.1.conv.0.0 better/total layers= 2 / 2 


Optimize 2:features.1.conv.1 for w4a8 bit of shape torch.Size([16, 32, 1, 1])

MSE before adaquant: 6.462580e-02
MSE after  adaquant: 3.489421e-02
layer features.2.conv.0.0's input scale is updated
 End of training layer  features.1.conv.1 better/total layers= 3 / 3 


Optimize 3:features.2.conv.0.0 for w4a8 bit of shape torch.Size([96, 16, 1, 1])

MSE before adaquant: 7.340207e-04
MSE after  adaquant: 1.065995e-03
layer features.2.conv.1.0's input scale is updated
 End of training layer  features.2.conv.0.0 better/total layers= 3 / 4 


Optimize 4:features.2.conv.1.0 for w4a8 bit of shape torch.Size([96, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 6.908037e-05
MSE after  adaquant: 6.210471e-05
layer features.2.conv.2's input scale is updated
 End of training layer  features.2.conv.1.0 better/total layers= 4 / 5 


Optimize 5:features.2.conv.2 for w4a8 bit of shape torch.Size([24, 96, 1, 1])

MSE before adaquant: 1.388415e-01
MSE after  adaquant: 4.821324e-02
layer features.3.conv.0.0's input scale is updated
 End of training layer  features.2.conv.2 better/total layers= 5 / 6 


Optimize 6:features.3.conv.0.0 for w4a8 bit of shape torch.Size([144, 24, 1, 1])

MSE before adaquant: 5.151731e-04
MSE after  adaquant: 7.051823e-04
layer features.3.conv.1.0's input scale is updated
 End of training layer  features.3.conv.0.0 better/total layers= 5 / 7 


Optimize 7:features.3.conv.1.0 for w4a8 bit of shape torch.Size([144, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.576392e-05
MSE after  adaquant: 3.782410e-05
layer features.3.conv.2's input scale is updated
 End of training layer  features.3.conv.1.0 better/total layers= 6 / 8 


Optimize 8:features.3.conv.2 for w4a8 bit of shape torch.Size([24, 144, 1, 1])

MSE before adaquant: 6.532556e-02
MSE after  adaquant: 2.186760e-02
 End of training layer  features.3.conv.2 better/total layers= 7 / 9 


Optimize 9:features.4.conv.0.0 for w4a8 bit of shape torch.Size([144, 24, 1, 1])

MSE before adaquant: 7.108258e-04
MSE after  adaquant: 9.730106e-04
layer features.4.conv.1.0's input scale is updated
 End of training layer  features.4.conv.0.0 better/total layers= 7 / 10 


Optimize 10:features.4.conv.1.0 for w4a8 bit of shape torch.Size([144, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.708425e-05
MSE after  adaquant: 1.802828e-05
layer features.4.conv.2's input scale is updated
 End of training layer  features.4.conv.1.0 better/total layers= 7 / 11 


Optimize 11:features.4.conv.2 for w4a8 bit of shape torch.Size([32, 144, 1, 1])

MSE before adaquant: 6.966548e-02
MSE after  adaquant: 2.214456e-02
layer features.5.conv.0.0's input scale is updated
 End of training layer  features.4.conv.2 better/total layers= 8 / 12 


Optimize 12:features.5.conv.0.0 for w4a8 bit of shape torch.Size([192, 32, 1, 1])

MSE before adaquant: 2.528341e-04
MSE after  adaquant: 3.669029e-04
layer features.5.conv.1.0's input scale is updated
 End of training layer  features.5.conv.0.0 better/total layers= 8 / 13 


Optimize 13:features.5.conv.1.0 for w4a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.133598e-05
MSE after  adaquant: 2.750877e-05
layer features.5.conv.2's input scale is updated
 End of training layer  features.5.conv.1.0 better/total layers= 9 / 14 


Optimize 14:features.5.conv.2 for w4a8 bit of shape torch.Size([32, 192, 1, 1])

MSE before adaquant: 1.698125e-02
MSE after  adaquant: 9.707741e-03
 End of training layer  features.5.conv.2 better/total layers= 10 / 15 


Optimize 15:features.6.conv.0.0 for w4a8 bit of shape torch.Size([192, 32, 1, 1])

MSE before adaquant: 2.071779e-04
MSE after  adaquant: 3.105757e-04
layer features.6.conv.1.0's input scale is updated
 End of training layer  features.6.conv.0.0 better/total layers= 10 / 16 


Optimize 16:features.6.conv.1.0 for w4a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.093956e-05
MSE after  adaquant: 9.778945e-06
layer features.6.conv.2's input scale is updated
 End of training layer  features.6.conv.1.0 better/total layers= 11 / 17 


Optimize 17:features.6.conv.2 for w4a8 bit of shape torch.Size([32, 192, 1, 1])

MSE before adaquant: 2.426490e-02
MSE after  adaquant: 1.062419e-02
 End of training layer  features.6.conv.2 better/total layers= 12 / 18 


Optimize 18:features.7.conv.0.0 for w4a8 bit of shape torch.Size([192, 32, 1, 1])

MSE before adaquant: 4.180056e-04
MSE after  adaquant: 6.442549e-04
layer features.7.conv.1.0's input scale is updated
 End of training layer  features.7.conv.0.0 better/total layers= 12 / 19 


Optimize 19:features.7.conv.1.0 for w4a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.318079e-05
MSE after  adaquant: 1.350671e-05
layer features.7.conv.2's input scale is updated
 End of training layer  features.7.conv.1.0 better/total layers= 12 / 20 


Optimize 20:features.7.conv.2 for w4a8 bit of shape torch.Size([64, 192, 1, 1])

MSE before adaquant: 9.422226e-02
MSE after  adaquant: 2.162383e-02
layer features.8.conv.0.0's input scale is updated
 End of training layer  features.7.conv.2 better/total layers= 13 / 21 


Optimize 21:features.8.conv.0.0 for w4a8 bit of shape torch.Size([384, 64, 1, 1])

MSE before adaquant: 2.040618e-04
MSE after  adaquant: 2.403380e-04
layer features.8.conv.1.0's input scale is updated
 End of training layer  features.8.conv.0.0 better/total layers= 13 / 22 


Optimize 22:features.8.conv.1.0 for w4a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.423370e-05
MSE after  adaquant: 3.973484e-05
layer features.8.conv.2's input scale is updated
 End of training layer  features.8.conv.1.0 better/total layers= 14 / 23 


Optimize 23:features.8.conv.2 for w4a8 bit of shape torch.Size([64, 384, 1, 1])

MSE before adaquant: 1.364234e-02
MSE after  adaquant: 6.226264e-03
 End of training layer  features.8.conv.2 better/total layers= 15 / 24 


Optimize 24:features.9.conv.0.0 for w4a8 bit of shape torch.Size([384, 64, 1, 1])

MSE before adaquant: 1.729979e-04
MSE after  adaquant: 2.374544e-04
layer features.9.conv.1.0's input scale is updated
 End of training layer  features.9.conv.0.0 better/total layers= 15 / 25 


Optimize 25:features.9.conv.1.0 for w4a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 5.927501e-06
MSE after  adaquant: 4.916506e-06
layer features.9.conv.2's input scale is updated
 End of training layer  features.9.conv.1.0 better/total layers= 16 / 26 


Optimize 26:features.9.conv.2 for w4a8 bit of shape torch.Size([64, 384, 1, 1])

MSE before adaquant: 1.328114e-02
MSE after  adaquant: 6.041685e-03
 End of training layer  features.9.conv.2 better/total layers= 17 / 27 


Optimize 27:features.10.conv.0.0 for w4a8 bit of shape torch.Size([384, 64, 1, 1])

MSE before adaquant: 1.492400e-04
MSE after  adaquant: 2.113144e-04
layer features.10.conv.1.0's input scale is updated
 End of training layer  features.10.conv.0.0 better/total layers= 17 / 28 


Optimize 28:features.10.conv.1.0 for w4a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 5.097105e-06
MSE after  adaquant: 4.502970e-06
layer features.10.conv.2's input scale is updated
 End of training layer  features.10.conv.1.0 better/total layers= 18 / 29 


Optimize 29:features.10.conv.2 for w4a8 bit of shape torch.Size([64, 384, 1, 1])

MSE before adaquant: 3.080784e-02
MSE after  adaquant: 1.935448e-02
 End of training layer  features.10.conv.2 better/total layers= 19 / 30 


Optimize 30:features.11.conv.0.0 for w4a8 bit of shape torch.Size([384, 64, 1, 1])

MSE before adaquant: 2.955174e-04
MSE after  adaquant: 4.118051e-04
layer features.11.conv.1.0's input scale is updated
 End of training layer  features.11.conv.0.0 better/total layers= 19 / 31 


Optimize 31:features.11.conv.1.0 for w4a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.500396e-05
MSE after  adaquant: 1.263988e-05
layer features.11.conv.2's input scale is updated
 End of training layer  features.11.conv.1.0 better/total layers= 20 / 32 


Optimize 32:features.11.conv.2 for w4a8 bit of shape torch.Size([96, 384, 1, 1])

MSE before adaquant: 2.761978e-02
MSE after  adaquant: 9.402200e-03
layer features.12.conv.0.0's input scale is updated
 End of training layer  features.11.conv.2 better/total layers= 21 / 33 


Optimize 33:features.12.conv.0.0 for w4a8 bit of shape torch.Size([576, 96, 1, 1])

MSE before adaquant: 2.094211e-04
MSE after  adaquant: 2.524158e-04
layer features.12.conv.1.0's input scale is updated
 End of training layer  features.12.conv.0.0 better/total layers= 21 / 34 


Optimize 34:features.12.conv.1.0 for w4a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.188883e-05
MSE after  adaquant: 4.091769e-05
layer features.12.conv.2's input scale is updated
 End of training layer  features.12.conv.1.0 better/total layers= 22 / 35 


Optimize 35:features.12.conv.2 for w4a8 bit of shape torch.Size([96, 576, 1, 1])

MSE before adaquant: 2.990035e-02
MSE after  adaquant: 1.183695e-02
 End of training layer  features.12.conv.2 better/total layers= 23 / 36 


Optimize 36:features.13.conv.0.0 for w4a8 bit of shape torch.Size([576, 96, 1, 1])

MSE before adaquant: 1.813670e-04
MSE after  adaquant: 2.542583e-04
layer features.13.conv.1.0's input scale is updated
 End of training layer  features.13.conv.0.0 better/total layers= 23 / 37 


Optimize 37:features.13.conv.1.0 for w4a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 5.033382e-05
MSE after  adaquant: 4.646499e-05
layer features.13.conv.2's input scale is updated
 End of training layer  features.13.conv.1.0 better/total layers= 24 / 38 


Optimize 38:features.13.conv.2 for w4a8 bit of shape torch.Size([96, 576, 1, 1])

MSE before adaquant: 5.946666e-02
MSE after  adaquant: 3.100415e-02
 End of training layer  features.13.conv.2 better/total layers= 25 / 39 


Optimize 39:features.14.conv.0.0 for w4a8 bit of shape torch.Size([576, 96, 1, 1])

MSE before adaquant: 4.718409e-04
MSE after  adaquant: 3.974766e-04
layer features.14.conv.1.0's input scale is updated
 End of training layer  features.14.conv.0.0 better/total layers= 26 / 40 


Optimize 40:features.14.conv.1.0 for w4a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.753571e-03
MSE after  adaquant: 3.690960e-03
layer features.14.conv.2's input scale is updated
 End of training layer  features.14.conv.1.0 better/total layers= 27 / 41 


Optimize 41:features.14.conv.2 for w4a8 bit of shape torch.Size([160, 576, 1, 1])

MSE before adaquant: 5.207446e-02
MSE after  adaquant: 2.068991e-02
layer features.15.conv.0.0's input scale is updated
 End of training layer  features.14.conv.2 better/total layers= 28 / 42 


Optimize 42:features.15.conv.0.0 for w4a8 bit of shape torch.Size([960, 160, 1, 1])

MSE before adaquant: 1.301610e-03
MSE after  adaquant: 4.184965e-04
layer features.15.conv.1.0's input scale is updated
 End of training layer  features.15.conv.0.0 better/total layers= 29 / 43 


Optimize 43:features.15.conv.1.0 for w4a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.493535e-04
MSE after  adaquant: 1.470220e-04
layer features.15.conv.2's input scale is updated
 End of training layer  features.15.conv.1.0 better/total layers= 30 / 44 


Optimize 44:features.15.conv.2 for w4a8 bit of shape torch.Size([160, 960, 1, 1])

MSE before adaquant: 1.437078e-02
MSE after  adaquant: 6.535860e-03
 End of training layer  features.15.conv.2 better/total layers= 31 / 45 


Optimize 45:features.16.conv.0.0 for w4a8 bit of shape torch.Size([960, 160, 1, 1])

MSE before adaquant: 4.744336e-03
MSE after  adaquant: 1.328055e-03
layer features.16.conv.1.0's input scale is updated
 End of training layer  features.16.conv.0.0 better/total layers= 32 / 46 


Optimize 46:features.16.conv.1.0 for w4a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.249692e-03
MSE after  adaquant: 2.235497e-03
layer features.16.conv.2's input scale is updated
 End of training layer  features.16.conv.1.0 better/total layers= 33 / 47 


Optimize 47:features.16.conv.2 for w4a8 bit of shape torch.Size([160, 960, 1, 1])

MSE before adaquant: 9.588862e-02
MSE after  adaquant: 6.980310e-02
 End of training layer  features.16.conv.2 better/total layers= 34 / 48 


Optimize 48:features.17.conv.0.0 for w4a8 bit of shape torch.Size([960, 160, 1, 1])

MSE before adaquant: 4.057169e-04
MSE after  adaquant: 1.769865e-04
layer features.17.conv.1.0's input scale is updated
 End of training layer  features.17.conv.0.0 better/total layers= 35 / 49 


Optimize 49:features.17.conv.1.0 for w4a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.973625e-05
MSE after  adaquant: 1.909876e-05
layer features.17.conv.2's input scale is updated
 End of training layer  features.17.conv.1.0 better/total layers= 36 / 50 


Optimize 50:features.17.conv.2 for w4a8 bit of shape torch.Size([320, 960, 1, 1])

MSE before adaquant: 8.178966e-02
MSE after  adaquant: 3.240352e-02
layer features.18.0's input scale is updated
 End of training layer  features.17.conv.2 better/total layers= 37 / 51 


Optimize 51:features.18.0 for w8a8 bit of shape torch.Size([1280, 320, 1, 1])

MSE before adaquant: 5.176962e-02
MSE after  adaquant: 4.979390e-02
layer classifier.1's input scale is updated
 End of training layer  features.18.0 better/total layers= 38 / 52 


Optimize 52:classifier.1 for w8a8 bit of shape torch.Size([1000, 1280])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 9.441149e-04
MSE after  adaquant: 7.349157e-04
 End of training layer  classifier.1 better/total layers= 39 / 53 

step 1: 
step 2: 
Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.2.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.7.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.9.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.10.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.11.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.14.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
read json file /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenetv2_adaquant.piano.kdp530.scaled.onnx.json
Json : Layer features.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.1.conv.1, precision switch from w8a8 to w8a8.
Json : Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.2.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.2.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.3.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.4.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.5.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.6.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.7.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.7.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.8.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.9.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.9.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.10.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.10.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.11.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.11.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.12.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.13.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.14.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.14.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.15.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.16.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
Json : Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
Json : Layer features.17.conv.2, precision switch from w8a8 to w8a8.
Json : Layer features.18.0, precision switch from w8a8 to w8a8.
Json : Layer classifier.1, precision switch from w8a8 to w8a8.
step 3: 
Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.2.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.7.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.9.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.10.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.11.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.14.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
Input/outputs cached

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.before_adaquant.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.before_adaquant.onnx
Bernard calculate float point model accuracy before enabling quantization!
Bernard calculate fixed point model accuracy before training!

Optimize 0:features.0.0 for w8a8 bit of shape torch.Size([32, 3, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.579253e-05
MSE after  adaquant: 1.440952e-05
layer features.1.conv.0.0's input scale is updated
 End of training layer  features.0.0 better/total layers= 1 / 1 


Optimize 1:features.1.conv.0.0 for w8a8 bit of shape torch.Size([32, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 9.229539e-04
MSE after  adaquant: 6.315759e-04
layer features.1.conv.1's input scale is updated
 End of training layer  features.1.conv.0.0 better/total layers= 2 / 2 


Optimize 2:features.1.conv.1 for w8a8 bit of shape torch.Size([16, 32, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.895328e-04
MSE after  adaquant: 4.723790e-04
layer features.2.conv.0.0's input scale is updated
 End of training layer  features.1.conv.1 better/total layers= 3 / 3 


Optimize 3:features.2.conv.0.0 for w8a8 bit of shape torch.Size([96, 16, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.077799e-05
MSE after  adaquant: 3.275326e-05
layer features.2.conv.1.0's input scale is updated
 End of training layer  features.2.conv.0.0 better/total layers= 3 / 4 


Optimize 4:features.2.conv.1.0 for w8a8 bit of shape torch.Size([96, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 6.908037e-05
MSE after  adaquant: 6.210471e-05
layer features.2.conv.2's input scale is updated
 End of training layer  features.2.conv.1.0 better/total layers= 4 / 5 


Optimize 5:features.2.conv.2 for w8a8 bit of shape torch.Size([24, 96, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 7.114431e-04
MSE after  adaquant: 3.240368e-04
layer features.3.conv.0.0's input scale is updated
 End of training layer  features.2.conv.2 better/total layers= 5 / 6 


Optimize 6:features.3.conv.0.0 for w8a8 bit of shape torch.Size([144, 24, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.167379e-05
MSE after  adaquant: 2.002026e-05
layer features.3.conv.1.0's input scale is updated
 End of training layer  features.3.conv.0.0 better/total layers= 6 / 7 


Optimize 7:features.3.conv.1.0 for w8a8 bit of shape torch.Size([144, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.576392e-05
MSE after  adaquant: 3.782410e-05
layer features.3.conv.2's input scale is updated
 End of training layer  features.3.conv.1.0 better/total layers= 7 / 8 


Optimize 8:features.3.conv.2 for w8a8 bit of shape torch.Size([24, 144, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.957774e-04
MSE after  adaquant: 3.508910e-04
 End of training layer  features.3.conv.2 better/total layers= 8 / 9 


Optimize 9:features.4.conv.0.0 for w8a8 bit of shape torch.Size([144, 24, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 9.693759e-06
MSE after  adaquant: 1.156579e-05
layer features.4.conv.1.0's input scale is updated
 End of training layer  features.4.conv.0.0 better/total layers= 8 / 10 


Optimize 10:features.4.conv.1.0 for w8a8 bit of shape torch.Size([144, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.708425e-05
MSE after  adaquant: 1.802828e-05
layer features.4.conv.2's input scale is updated
 End of training layer  features.4.conv.1.0 better/total layers= 8 / 11 


Optimize 11:features.4.conv.2 for w8a8 bit of shape torch.Size([32, 144, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.328680e-04
MSE after  adaquant: 2.137326e-04
layer features.5.conv.0.0's input scale is updated
 End of training layer  features.4.conv.2 better/total layers= 9 / 12 


Optimize 12:features.5.conv.0.0 for w8a8 bit of shape torch.Size([192, 32, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.986895e-06
MSE after  adaquant: 3.929857e-06
layer features.5.conv.1.0's input scale is updated
 End of training layer  features.5.conv.0.0 better/total layers= 9 / 13 


Optimize 13:features.5.conv.1.0 for w8a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.133598e-05
MSE after  adaquant: 2.750877e-05
layer features.5.conv.2's input scale is updated
 End of training layer  features.5.conv.1.0 better/total layers= 10 / 14 


Optimize 14:features.5.conv.2 for w8a8 bit of shape torch.Size([32, 192, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 8.008318e-05
MSE after  adaquant: 9.095523e-05
 End of training layer  features.5.conv.2 better/total layers= 10 / 15 


Optimize 15:features.6.conv.0.0 for w8a8 bit of shape torch.Size([192, 32, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.516806e-06
MSE after  adaquant: 3.117081e-06
layer features.6.conv.1.0's input scale is updated
 End of training layer  features.6.conv.0.0 better/total layers= 10 / 16 


Optimize 16:features.6.conv.1.0 for w8a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.093956e-05
MSE after  adaquant: 9.778945e-06
layer features.6.conv.2's input scale is updated
 End of training layer  features.6.conv.1.0 better/total layers= 11 / 17 


Optimize 17:features.6.conv.2 for w8a8 bit of shape torch.Size([32, 192, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.374863e-04
MSE after  adaquant: 9.505464e-05
 End of training layer  features.6.conv.2 better/total layers= 12 / 18 


Optimize 18:features.7.conv.0.0 for w8a8 bit of shape torch.Size([192, 32, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.975441e-06
MSE after  adaquant: 6.402291e-06
layer features.7.conv.1.0's input scale is updated
 End of training layer  features.7.conv.0.0 better/total layers= 12 / 19 


Optimize 19:features.7.conv.1.0 for w8a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.318079e-05
MSE after  adaquant: 1.350671e-05
layer features.7.conv.2's input scale is updated
 End of training layer  features.7.conv.1.0 better/total layers= 12 / 20 


Optimize 20:features.7.conv.2 for w8a8 bit of shape torch.Size([64, 192, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.664661e-04
MSE after  adaquant: 2.310493e-04
layer features.8.conv.0.0's input scale is updated
 End of training layer  features.7.conv.2 better/total layers= 13 / 21 


Optimize 21:features.8.conv.0.0 for w8a8 bit of shape torch.Size([384, 64, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.646674e-06
MSE after  adaquant: 2.008710e-06
layer features.8.conv.1.0's input scale is updated
 End of training layer  features.8.conv.0.0 better/total layers= 13 / 22 


Optimize 22:features.8.conv.1.0 for w8a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.423370e-05
MSE after  adaquant: 3.973484e-05
layer features.8.conv.2's input scale is updated
 End of training layer  features.8.conv.1.0 better/total layers= 14 / 23 


Optimize 23:features.8.conv.2 for w8a8 bit of shape torch.Size([64, 384, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.000677e-04
MSE after  adaquant: 2.255236e-04
 End of training layer  features.8.conv.2 better/total layers= 15 / 24 


Optimize 24:features.9.conv.0.0 for w8a8 bit of shape torch.Size([384, 64, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.526041e-06
MSE after  adaquant: 1.971527e-06
layer features.9.conv.1.0's input scale is updated
 End of training layer  features.9.conv.0.0 better/total layers= 15 / 25 


Optimize 25:features.9.conv.1.0 for w8a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 5.927501e-06
MSE after  adaquant: 4.916506e-06
layer features.9.conv.2's input scale is updated
 End of training layer  features.9.conv.1.0 better/total layers= 16 / 26 


Optimize 26:features.9.conv.2 for w8a8 bit of shape torch.Size([64, 384, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 7.565181e-05
MSE after  adaquant: 4.896096e-05
 End of training layer  features.9.conv.2 better/total layers= 17 / 27 


Optimize 27:features.10.conv.0.0 for w8a8 bit of shape torch.Size([384, 64, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.415378e-06
MSE after  adaquant: 1.854915e-06
layer features.10.conv.1.0's input scale is updated
 End of training layer  features.10.conv.0.0 better/total layers= 17 / 28 


Optimize 28:features.10.conv.1.0 for w8a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 5.097105e-06
MSE after  adaquant: 4.502970e-06
layer features.10.conv.2's input scale is updated
 End of training layer  features.10.conv.1.0 better/total layers= 18 / 29 


Optimize 29:features.10.conv.2 for w8a8 bit of shape torch.Size([64, 384, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.508172e-04
MSE after  adaquant: 2.684960e-04
 End of training layer  features.10.conv.2 better/total layers= 19 / 30 


Optimize 30:features.11.conv.0.0 for w8a8 bit of shape torch.Size([384, 64, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.660735e-06
MSE after  adaquant: 4.182482e-06
layer features.11.conv.1.0's input scale is updated
 End of training layer  features.11.conv.0.0 better/total layers= 19 / 31 


Optimize 31:features.11.conv.1.0 for w8a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.500396e-05
MSE after  adaquant: 1.263988e-05
layer features.11.conv.2's input scale is updated
 End of training layer  features.11.conv.1.0 better/total layers= 20 / 32 


Optimize 32:features.11.conv.2 for w8a8 bit of shape torch.Size([96, 384, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.461321e-04
MSE after  adaquant: 8.199195e-05
layer features.12.conv.0.0's input scale is updated
 End of training layer  features.11.conv.2 better/total layers= 21 / 33 


Optimize 33:features.12.conv.0.0 for w8a8 bit of shape torch.Size([576, 96, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.651598e-06
MSE after  adaquant: 2.529548e-06
layer features.12.conv.1.0's input scale is updated
 End of training layer  features.12.conv.0.0 better/total layers= 22 / 34 


Optimize 34:features.12.conv.1.0 for w8a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.188883e-05
MSE after  adaquant: 4.091769e-05
layer features.12.conv.2's input scale is updated
 End of training layer  features.12.conv.1.0 better/total layers= 23 / 35 


Optimize 35:features.12.conv.2 for w8a8 bit of shape torch.Size([96, 576, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.847104e-04
MSE after  adaquant: 3.055398e-04
 End of training layer  features.12.conv.2 better/total layers= 24 / 36 


Optimize 36:features.13.conv.0.0 for w8a8 bit of shape torch.Size([576, 96, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.813886e-06
MSE after  adaquant: 2.136601e-06
layer features.13.conv.1.0's input scale is updated
 End of training layer  features.13.conv.0.0 better/total layers= 24 / 37 


Optimize 37:features.13.conv.1.0 for w8a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 5.033382e-05
MSE after  adaquant: 4.646499e-05
layer features.13.conv.2's input scale is updated
 End of training layer  features.13.conv.1.0 better/total layers= 25 / 38 


Optimize 38:features.13.conv.2 for w8a8 bit of shape torch.Size([96, 576, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.907019e-03
MSE after  adaquant: 1.700934e-03
 End of training layer  features.13.conv.2 better/total layers= 26 / 39 


Optimize 39:features.14.conv.0.0 for w8a8 bit of shape torch.Size([576, 96, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.015724e-04
MSE after  adaquant: 1.557740e-04
layer features.14.conv.1.0's input scale is updated
 End of training layer  features.14.conv.0.0 better/total layers= 27 / 40 


Optimize 40:features.14.conv.1.0 for w8a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.753571e-03
MSE after  adaquant: 3.690960e-03
layer features.14.conv.2's input scale is updated
 End of training layer  features.14.conv.1.0 better/total layers= 28 / 41 


Optimize 41:features.14.conv.2 for w8a8 bit of shape torch.Size([160, 576, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.515233e-02
MSE after  adaquant: 1.285362e-02
layer features.15.conv.0.0's input scale is updated
 End of training layer  features.14.conv.2 better/total layers= 29 / 42 


Optimize 42:features.15.conv.0.0 for w8a8 bit of shape torch.Size([960, 160, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.091081e-03
MSE after  adaquant: 9.581516e-04
layer features.15.conv.1.0's input scale is updated
 End of training layer  features.15.conv.0.0 better/total layers= 30 / 43 


Optimize 43:features.15.conv.1.0 for w8a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.493535e-04
MSE after  adaquant: 1.470220e-04
layer features.15.conv.2's input scale is updated
 End of training layer  features.15.conv.1.0 better/total layers= 31 / 44 


Optimize 44:features.15.conv.2 for w8a8 bit of shape torch.Size([160, 960, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.325774e-04
MSE after  adaquant: 1.124103e-04
 End of training layer  features.15.conv.2 better/total layers= 32 / 45 


Optimize 45:features.16.conv.0.0 for w8a8 bit of shape torch.Size([960, 160, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.514517e-03
MSE after  adaquant: 4.063308e-03
layer features.16.conv.1.0's input scale is updated
 End of training layer  features.16.conv.0.0 better/total layers= 33 / 46 


Optimize 46:features.16.conv.1.0 for w8a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.249692e-03
MSE after  adaquant: 2.235497e-03
layer features.16.conv.2's input scale is updated
 End of training layer  features.16.conv.1.0 better/total layers= 34 / 47 


Optimize 47:features.16.conv.2 for w8a8 bit of shape torch.Size([160, 960, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 7.485484e-02
MSE after  adaquant: 7.283996e-02
 End of training layer  features.16.conv.2 better/total layers= 35 / 48 


Optimize 48:features.17.conv.0.0 for w8a8 bit of shape torch.Size([960, 160, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.101486e-04
MSE after  adaquant: 2.269182e-04
layer features.17.conv.1.0's input scale is updated
 End of training layer  features.17.conv.0.0 better/total layers= 36 / 49 


Optimize 49:features.17.conv.1.0 for w8a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.973625e-05
MSE after  adaquant: 1.909876e-05
layer features.17.conv.2's input scale is updated
 End of training layer  features.17.conv.1.0 better/total layers= 37 / 50 


Optimize 50:features.17.conv.2 for w8a8 bit of shape torch.Size([320, 960, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 8.576651e-04
MSE after  adaquant: 6.298291e-04
layer features.18.0's input scale is updated
 End of training layer  features.17.conv.2 better/total layers= 38 / 51 


Optimize 51:features.18.0 for w8a8 bit of shape torch.Size([1280, 320, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.016111e-04
MSE after  adaquant: 3.884472e-04
layer classifier.1's input scale is updated
 End of training layer  features.18.0 better/total layers= 39 / 52 


Optimize 52:classifier.1 for w8a8 bit of shape torch.Size([1000, 1280])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 9.441149e-04
MSE after  adaquant: 7.349157e-04
 End of training layer  classifier.1 better/total layers= 40 / 53 

step 4
Train: ########### All 8bit results ###########
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
finished 0 out of 50
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
finished 1 out of 50
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
finished 2 out of 50
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w8a8 to w8a8.
finished 3 out of 50
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
finished 4 out of 50
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
finished 5 out of 50
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
finished 6 out of 50
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
finished 7 out of 50
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
finished 8 out of 50
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
finished 9 out of 50
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
finished 10 out of 50
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
finished 11 out of 50
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
finished 12 out of 50
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
finished 13 out of 50
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
finished 14 out of 50
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
finished 15 out of 50
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
finished 16 out of 50
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
finished 17 out of 50
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w8a8 to w8a8.
finished 18 out of 50
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
finished 19 out of 50
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
finished 20 out of 50
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
finished 21 out of 50
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
finished 22 out of 50
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
finished 23 out of 50
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w8a8 to w8a8.
finished 24 out of 50
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
finished 25 out of 50
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
finished 26 out of 50
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w8a8 to w8a8.
finished 27 out of 50
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
finished 28 out of 50
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
finished 29 out of 50
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w8a8 to w8a8.
finished 30 out of 50
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
finished 31 out of 50
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
finished 32 out of 50
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
finished 33 out of 50
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
finished 34 out of 50
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
finished 35 out of 50
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
finished 36 out of 50
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
finished 37 out of 50
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
finished 38 out of 50
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w8a8 to w8a8.
finished 39 out of 50
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
finished 40 out of 50
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
finished 41 out of 50
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
finished 42 out of 50
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
finished 43 out of 50
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
finished 44 out of 50
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
finished 45 out of 50
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
finished 46 out of 50
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
finished 47 out of 50
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
finished 48 out of 50
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
step 5
Found K = 42
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Achieved compression:  0.13345278132474866
Expected acc:  2.5126641744308476
Params % in int 4 = 0.9323777494020107
Params % in int 8 = 0.06762225059798932
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.0.0 to w4a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.0.0 to w4a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
switched layer features.5.conv.2 to w4a8
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.0.0 to w4a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
switched layer features.6.conv.2 to w4a8
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.0.0 to w4a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
switched layer features.10.conv.2 to w4a8
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.0.0 to w4a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
switched layer features.11.conv.2 to w4a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
switched layer features.13.conv.2 to w4a8
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.0.0 to w4a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
switched layer features.15.conv.2 to w4a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.0.0 to w4a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
switched layer features.17.conv.2 to w4a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13345278132474866, expected loss 2.5126641744308476, actual acc 29.799999954223633, actual loss 3.667905313491821
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Found K = 36
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Achieved compression:  0.14060167616855207
Expected acc:  2.216812276237487
Params % in int 4 = 0.8751865906515836
Params % in int 8 = 0.12481340934841645
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.0.0 to w4a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.0.0 to w4a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.0.0 to w4a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
switched layer features.11.conv.2 to w4a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.0.0 to w4a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
switched layer features.15.conv.2 to w4a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.0.0 to w4a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
switched layer features.17.conv.2 to w4a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13345278132474866, expected loss 2.5126641744308476, actual acc 29.799999954223633, actual loss 3.667905313491821
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14060167616855207, expected loss 2.216812276237487, actual acc 42.60000015258789, actual loss 2.6863751564025877
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Found K = 33
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Achieved compression:  0.16520466521590563
Expected acc:  1.6469973617725366
Params % in int 4 = 0.6783626782727551
Params % in int 8 = 0.3216373217272449
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.0.0 to w4a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.0.0 to w4a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.0.0 to w4a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
switched layer features.15.conv.2 to w4a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.0.0 to w4a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13345278132474866, expected loss 2.5126641744308476, actual acc 29.799999954223633, actual loss 3.667905313491821
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14060167616855207, expected loss 2.216812276237487, actual acc 42.60000015258789, actual loss 2.6863751564025877
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.16520466521590563, expected loss 1.6469973617725366, actual acc 57.89999996948242, actual loss 1.7869199447631836
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Found K = 33
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Achieved compression:  0.16520466521590563
Expected acc:  1.6469973617725366
Params % in int 4 = 0.6783626782727551
Params % in int 8 = 0.3216373217272449
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.0.0 to w4a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.0.0 to w4a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.0.0 to w4a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
switched layer features.15.conv.2 to w4a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.0.0 to w4a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13345278132474866, expected loss 2.5126641744308476, actual acc 29.799999954223633, actual loss 3.667905313491821
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14060167616855207, expected loss 2.216812276237487, actual acc 42.60000015258789, actual loss 2.6863751564025877
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.16520466521590563, expected loss 1.6469973617725366, actual acc 57.89999996948242, actual loss 1.7869199447631836
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16520466521590563, expected loss 1.6469973617725366, actual acc 57.89999996948242, actual loss 1.7869199447631836
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Found K = 30
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Achieved compression:  0.1712475046310451
Expected acc:  1.5615579360656735
Params % in int 4 = 0.6300199629516393
Params % in int 8 = 0.3699800370483607
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
switched layer features.12.conv.2 to w8a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.0.0 to w4a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
switched layer features.15.conv.2 to w4a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.0.0 to w4a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13345278132474866, expected loss 2.5126641744308476, actual acc 29.799999954223633, actual loss 3.667905313491821
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14060167616855207, expected loss 2.216812276237487, actual acc 42.60000015258789, actual loss 2.6863751564025877
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.16520466521590563, expected loss 1.6469973617725366, actual acc 57.89999996948242, actual loss 1.7869199447631836
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16520466521590563, expected loss 1.6469973617725366, actual acc 57.89999996948242, actual loss 1.7869199447631836
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.1712475046310451, expected loss 1.5615579360656735, actual acc 60.49999951171875, actual loss 1.6324635219573975
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Found K = 28
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Achieved compression:  0.1837648148481197
Expected acc:  1.4149279409580227
Params % in int 4 = 0.5298814812150423
Params % in int 8 = 0.47011851878495764
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
switched layer features.12.conv.2 to w8a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.0.0 to w4a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.0.0 to w4a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13345278132474866, expected loss 2.5126641744308476, actual acc 29.799999954223633, actual loss 3.667905313491821
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14060167616855207, expected loss 2.216812276237487, actual acc 42.60000015258789, actual loss 2.6863751564025877
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.16520466521590563, expected loss 1.6469973617725366, actual acc 57.89999996948242, actual loss 1.7869199447631836
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16520466521590563, expected loss 1.6469973617725366, actual acc 57.89999996948242, actual loss 1.7869199447631836
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.1712475046310451, expected loss 1.5615579360656735, actual acc 60.49999951171875, actual loss 1.6324635219573975
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.1837648148481197, expected loss 1.4149279409580227, actual acc 64.49999966430664, actual loss 1.4024893808364869
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Found K = 25
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Achieved compression:  0.2001668075463554
Expected acc:  1.3141243868999481
Params % in int 4 = 0.3986655396291567
Params % in int 8 = 0.6013344603708433
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
switched layer features.12.conv.2 to w8a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13345278132474866, expected loss 2.5126641744308476, actual acc 29.799999954223633, actual loss 3.667905313491821
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14060167616855207, expected loss 2.216812276237487, actual acc 42.60000015258789, actual loss 2.6863751564025877
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.16520466521590563, expected loss 1.6469973617725366, actual acc 57.89999996948242, actual loss 1.7869199447631836
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16520466521590563, expected loss 1.6469973617725366, actual acc 57.89999996948242, actual loss 1.7869199447631836
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.1712475046310451, expected loss 1.5615579360656735, actual acc 60.49999951171875, actual loss 1.6324635219573975
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.1837648148481197, expected loss 1.4149279409580227, actual acc 64.49999966430664, actual loss 1.4024893808364869
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.2001668075463554, expected loss 1.3141243868999481, actual acc 69.70000006103515, actual loss 1.2527312574386598
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Found K = 25
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Achieved compression:  0.2001668075463554
Expected acc:  1.3141243868999481
Params % in int 4 = 0.3986655396291567
Params % in int 8 = 0.6013344603708433
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
switched layer features.12.conv.2 to w8a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13345278132474866, expected loss 2.5126641744308476, actual acc 29.799999954223633, actual loss 3.667905313491821
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14060167616855207, expected loss 2.216812276237487, actual acc 42.60000015258789, actual loss 2.6863751564025877
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.16520466521590563, expected loss 1.6469973617725366, actual acc 57.89999996948242, actual loss 1.7869199447631836
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16520466521590563, expected loss 1.6469973617725366, actual acc 57.89999996948242, actual loss 1.7869199447631836
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.1712475046310451, expected loss 1.5615579360656735, actual acc 60.49999951171875, actual loss 1.6324635219573975
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.1837648148481197, expected loss 1.4149279409580227, actual acc 64.49999966430664, actual loss 1.4024893808364869
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.2001668075463554, expected loss 1.3141243868999481, actual acc 69.70000006103515, actual loss 1.2527312574386598
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.2001668075463554, expected loss 1.3141243868999481, actual acc 69.70000006103515, actual loss 1.2527312574386598
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Found K = 22
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Achieved compression:  0.21656880024459113
Expected acc:  1.2599113517932894
Params % in int 4 = 0.26744959804327106
Params % in int 8 = 0.7325504019567289
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.0.0 to w8a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.0.0 to w8a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
switched layer features.12.conv.2 to w8a8
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13345278132474866, expected loss 2.5126641744308476, actual acc 29.799999954223633, actual loss 3.667905313491821
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14060167616855207, expected loss 2.216812276237487, actual acc 42.60000015258789, actual loss 2.6863751564025877
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.16520466521590563, expected loss 1.6469973617725366, actual acc 57.89999996948242, actual loss 1.7869199447631836
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16520466521590563, expected loss 1.6469973617725366, actual acc 57.89999996948242, actual loss 1.7869199447631836
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.1712475046310451, expected loss 1.5615579360656735, actual acc 60.49999951171875, actual loss 1.6324635219573975
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.1837648148481197, expected loss 1.4149279409580227, actual acc 64.49999966430664, actual loss 1.4024893808364869
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.2001668075463554, expected loss 1.3141243868999481, actual acc 69.70000006103515, actual loss 1.2527312574386598
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.2001668075463554, expected loss 1.3141243868999481, actual acc 69.70000006103515, actual loss 1.2527312574386598
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.21, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss, compression 0.21656880024459113, expected loss 1.2599113517932894, actual acc 70.90000024414063, actual loss 1.142252347946167
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Found K = 21
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Achieved compression:  0.22045348272575221
Expected acc:  1.2506846123867037
Params % in int 4 = 0.23637213819398234
Params % in int 8 = 0.7636278618060177
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.0.0 to w8a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.0.0 to w8a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
switched layer features.12.conv.2 to w8a8
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.0.0 to w8a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13345278132474866, expected loss 2.5126641744308476, actual acc 29.799999954223633, actual loss 3.667905313491821
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14060167616855207, expected loss 2.216812276237487, actual acc 42.60000015258789, actual loss 2.6863751564025877
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.16520466521590563, expected loss 1.6469973617725366, actual acc 57.89999996948242, actual loss 1.7869199447631836
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16520466521590563, expected loss 1.6469973617725366, actual acc 57.89999996948242, actual loss 1.7869199447631836
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.1712475046310451, expected loss 1.5615579360656735, actual acc 60.49999951171875, actual loss 1.6324635219573975
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.1837648148481197, expected loss 1.4149279409580227, actual acc 64.49999966430664, actual loss 1.4024893808364869
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.2001668075463554, expected loss 1.3141243868999481, actual acc 69.70000006103515, actual loss 1.2527312574386598
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.2001668075463554, expected loss 1.3141243868999481, actual acc 69.70000006103515, actual loss 1.2527312574386598
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.21, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss, compression 0.21656880024459113, expected loss 1.2599113517932894, actual acc 70.90000024414063, actual loss 1.142252347946167
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.22, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss, compression 0.22045348272575221, expected loss 1.2506846123867037, actual acc 70.49999908447266, actual loss 1.1294667711257935
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Found K = 19
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Achieved compression:  0.23297079294282683
Expected acc:  1.229075002067566
Params % in int 4 = 0.1362336564573854
Params % in int 8 = 0.8637663435426146
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.0.0 to w8a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.0.0 to w8a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.0.0 to w8a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
switched layer features.12.conv.2 to w8a8
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.0.0 to w8a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.15.conv.0.0 to w8a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.23_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.23_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13345278132474866, expected loss 2.5126641744308476, actual acc 29.799999954223633, actual loss 3.667905313491821
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14060167616855207, expected loss 2.216812276237487, actual acc 42.60000015258789, actual loss 2.6863751564025877
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.16520466521590563, expected loss 1.6469973617725366, actual acc 57.89999996948242, actual loss 1.7869199447631836
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16520466521590563, expected loss 1.6469973617725366, actual acc 57.89999996948242, actual loss 1.7869199447631836
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.1712475046310451, expected loss 1.5615579360656735, actual acc 60.49999951171875, actual loss 1.6324635219573975
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.1837648148481197, expected loss 1.4149279409580227, actual acc 64.49999966430664, actual loss 1.4024893808364869
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.2001668075463554, expected loss 1.3141243868999481, actual acc 69.70000006103515, actual loss 1.2527312574386598
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.2001668075463554, expected loss 1.3141243868999481, actual acc 69.70000006103515, actual loss 1.2527312574386598
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.21, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss, compression 0.21656880024459113, expected loss 1.2599113517932894, actual acc 70.90000024414063, actual loss 1.142252347946167
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.22, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss, compression 0.22045348272575221, expected loss 1.2506846123867037, actual acc 70.49999908447266, actual loss 1.1294667711257935
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.23, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.23_loss, compression 0.23297079294282683, expected loss 1.229075002067566, actual acc 71.40000048828125, actual loss 1.1094644060134888
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Found K = 18
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Achieved compression:  0.24376157761271874
Expected acc:  1.2138388270072937
Params % in int 4 = 0.0499073790982501
Params % in int 8 = 0.95009262090175
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
Layer features.17.conv.2, precision switch from w4a8 to w4a8.
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2_w4a8.adaquant/mobilenet_v2.absorb_bn.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.3.conv.1.0 to w4a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.4.conv.1.0 to w4a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.5.conv.1.0 to w4a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.6.conv.1.0 to w4a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.8.conv.1.0 to w4a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.0.0 to w8a8
Layer features.9.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.0.0 to w8a8
Layer features.10.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.0.0 to w8a8
Layer features.12.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.12.conv.1.0 to w4a8
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
switched layer features.12.conv.2 to w8a8
Layer features.13.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.0.0 to w8a8
Layer features.13.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.13.conv.1.0 to w4a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.15.conv.0.0 to w8a8
Layer features.15.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.16.conv.0.0 to w8a8
Layer features.16.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w4a8 to w4a8.
switched layer features.17.conv.1.0 to w4a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.24_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.24_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13345278132474866, expected loss 2.5126641744308476, actual acc 29.799999954223633, actual loss 3.667905313491821
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [4, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [4, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14060167616855207, expected loss 2.216812276237487, actual acc 42.60000015258789, actual loss 2.6863751564025877
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [4, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [4, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.16520466521590563, expected loss 1.6469973617725366, actual acc 57.89999996948242, actual loss 1.7869199447631836
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16520466521590563, expected loss 1.6469973617725366, actual acc 57.89999996948242, actual loss 1.7869199447631836
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.1712475046310451, expected loss 1.5615579360656735, actual acc 60.49999951171875, actual loss 1.6324635219573975
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.1837648148481197, expected loss 1.4149279409580227, actual acc 64.49999966430664, actual loss 1.4024893808364869
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.2001668075463554, expected loss 1.3141243868999481, actual acc 69.70000006103515, actual loss 1.2527312574386598
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.2001668075463554, expected loss 1.3141243868999481, actual acc 69.70000006103515, actual loss 1.2527312574386598
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.21, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss, compression 0.21656880024459113, expected loss 1.2599113517932894, actual acc 70.90000024414063, actual loss 1.142252347946167
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.22, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss, compression 0.22045348272575221, expected loss 1.2506846123867037, actual acc 70.49999908447266, actual loss 1.1294667711257935
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.23, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.23_loss, compression 0.23297079294282683, expected loss 1.229075002067566, actual acc 71.40000048828125, actual loss 1.1094644060134888
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.24, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.24_loss, compression 0.24376157761271874, expected loss 1.2138388270072937, actual acc 72.7000001220703, actual loss 1.0735474824905396
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [4, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [4, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [4, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [4, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [4, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [8, 8], 'features.12.conv.1.0': [4, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [8, 8], 'features.13.conv.1.0': [4, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [4, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.13, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, actual_compression 0.13345278132474866, expected loss 2.5126641744308476, actual acc 29.799999954223633, actual loss 3.667905313491821
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Compression thr 0.14, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, actual_compression 0.14060167616855207, expected loss 2.216812276237487, actual acc 42.60000015258789, actual loss 2.6863751564025877
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8']
Compression thr 0.15000000000000002, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, actual_compression 0.16520466521590563, expected loss 1.6469973617725366, actual acc 57.89999996948242, actual loss 1.7869199447631836
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Compression thr 0.16000000000000003, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, actual_compression 0.16520466521590563, expected loss 1.6469973617725366, actual acc 57.89999996948242, actual loss 1.7869199447631836
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Compression thr 0.17000000000000004, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, actual_compression 0.1712475046310451, expected loss 1.5615579360656735, actual acc 60.49999951171875, actual loss 1.6324635219573975
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Compression thr 0.18000000000000005, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, actual_compression 0.1837648148481197, expected loss 1.4149279409580227, actual acc 64.49999966430664, actual loss 1.4024893808364869
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8']
Compression thr 0.19000000000000006, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, actual_compression 0.2001668075463554, expected loss 1.3141243868999481, actual acc 69.70000006103515, actual loss 1.2527312574386598
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Compression thr 0.20000000000000007, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, actual_compression 0.2001668075463554, expected loss 1.3141243868999481, actual acc 69.70000006103515, actual loss 1.2527312574386598
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8']
Compression thr 0.21000000000000008, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss, actual_compression 0.21656880024459113, expected loss 1.2599113517932894, actual acc 70.90000024414063, actual loss 1.142252347946167
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Compression thr 0.22000000000000008, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss, actual_compression 0.22045348272575221, expected loss 1.2506846123867037, actual acc 70.49999908447266, actual loss 1.1294667711257935
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Compression thr 0.2300000000000001, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.23_loss, actual_compression 0.23297079294282683, expected loss 1.229075002067566, actual acc 71.40000048828125, actual loss 1.1094644060134888
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
Compression thr 0.2400000000000001, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2_w8a8.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.24_loss, actual_compression 0.24376157761271874, expected loss 1.2138388270072937, actual acc 72.7000001220703, actual loss 1.0735474824905396
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8']
