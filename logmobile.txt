step 1: 
step 2: 
read json file /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenetv2_adaquant.piano.kdp530.scaled.w4.onnx.json
Json : Layer features.0.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.1.conv.0.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.1.conv.1, precision switch from w8a8 to w4a8b16.
Json : Layer features.2.conv.0.0, precision switch from w8a8 to w4a8b16.
Json : Layer features.2.conv.1.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.2.conv.2, precision switch from w8a8 to w4a8b16.
Json : Layer features.3.conv.0.0, precision switch from w8a8 to w4a8b16.
Json : Layer features.3.conv.1.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.3.conv.2, precision switch from w8a8 to w4a8b16.
Json : Layer features.4.conv.0.0, precision switch from w8a8 to w4a8b16.
Json : Layer features.4.conv.1.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.4.conv.2, precision switch from w8a8 to w4a8b16.
Json : Layer features.5.conv.0.0, precision switch from w8a8 to w4a8b16.
Json : Layer features.5.conv.1.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.5.conv.2, precision switch from w8a8 to w4a8b16.
Json : Layer features.6.conv.0.0, precision switch from w8a8 to w4a8b16.
Json : Layer features.6.conv.1.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.6.conv.2, precision switch from w8a8 to w4a8b16.
Json : Layer features.7.conv.0.0, precision switch from w8a8 to w4a8b16.
Json : Layer features.7.conv.1.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.7.conv.2, precision switch from w8a8 to w4a8b16.
Json : Layer features.8.conv.0.0, precision switch from w8a8 to w4a8b16.
Json : Layer features.8.conv.1.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.8.conv.2, precision switch from w8a8 to w4a8b16.
Json : Layer features.9.conv.0.0, precision switch from w8a8 to w4a8b16.
Json : Layer features.9.conv.1.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.9.conv.2, precision switch from w8a8 to w4a8b16.
Json : Layer features.10.conv.0.0, precision switch from w8a8 to w4a8b16.
Json : Layer features.10.conv.1.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.10.conv.2, precision switch from w8a8 to w4a8b16.
Json : Layer features.11.conv.0.0, precision switch from w8a8 to w4a8b16.
Json : Layer features.11.conv.1.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.11.conv.2, precision switch from w8a8 to w4a8b16.
Json : Layer features.12.conv.0.0, precision switch from w8a8 to w4a8b16.
Json : Layer features.12.conv.1.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.12.conv.2, precision switch from w8a8 to w4a8b16.
Json : Layer features.13.conv.0.0, precision switch from w8a8 to w4a8b16.
Json : Layer features.13.conv.1.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.13.conv.2, precision switch from w8a8 to w4a8b16.
Json : Layer features.14.conv.0.0, precision switch from w8a8 to w4a8b16.
Json : Layer features.14.conv.1.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.14.conv.2, precision switch from w8a8 to w4a8b16.
Json : Layer features.15.conv.0.0, precision switch from w8a8 to w4a8b16.
Json : Layer features.15.conv.1.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.15.conv.2, precision switch from w8a8 to w4a8b16.
Json : Layer features.16.conv.0.0, precision switch from w8a8 to w4a8b16.
Json : Layer features.16.conv.1.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.16.conv.2, precision switch from w8a8 to w4a8b16.
Json : Layer features.17.conv.0.0, precision switch from w8a8 to w4a8b16.
Json : Layer features.17.conv.1.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.17.conv.2, precision switch from w8a8 to w4a8b16.
Json : Layer features.18.0, precision switch from w8a8 to w4a8b16.
Json : Layer classifier.1, precision switch from w8a8 to w8a8b16.
step 3: 
Input/outputs cached

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.w4a8.measure_perC.before_adaquant.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.w4a8.measure_perC.before_adaquant.onnx
Bernard calculate float point model accuracy before enabling quantization!
Bernard calculate fixed point model accuracy before training!

Optimize 0:features.0.0 for w8a8 bit of shape torch.Size([32, 3, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.58e-05
MSE after  adaquant: 1.34e-05
 End of training layer  features.0.0 better/total layers= 1 / 1 


Optimize 1:features.1.conv.0.0 for w8a8 bit of shape torch.Size([32, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 7.42e-02
MSE after  adaquant: 1.04e-02
 End of training layer  features.1.conv.0.0 better/total layers= 2 / 2 


Optimize 2:features.1.conv.1 for w4a8 bit of shape torch.Size([16, 32, 1, 1])

MSE before adaquant: 2.55e-01
MSE after  adaquant: 8.10e-02
 End of training layer  features.1.conv.1 better/total layers= 3 / 3 


Optimize 3:features.2.conv.0.0 for w4a8 bit of shape torch.Size([96, 16, 1, 1])

MSE before adaquant: 6.82e-03
MSE after  adaquant: 1.27e-03
 End of training layer  features.2.conv.0.0 better/total layers= 4 / 4 


Optimize 4:features.2.conv.1.0 for w8a8 bit of shape torch.Size([96, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.61e-03
MSE after  adaquant: 2.78e-03
 End of training layer  features.2.conv.1.0 better/total layers= 5 / 5 


Optimize 5:features.2.conv.2 for w4a8 bit of shape torch.Size([24, 96, 1, 1])

MSE before adaquant: 1.17e-01
MSE after  adaquant: 7.86e-03
 End of training layer  features.2.conv.2 better/total layers= 6 / 6 


Optimize 6:features.3.conv.0.0 for w4a8 bit of shape torch.Size([144, 24, 1, 1])

MSE before adaquant: 6.06e-03
MSE after  adaquant: 9.75e-04
 End of training layer  features.3.conv.0.0 better/total layers= 7 / 7 


Optimize 7:features.3.conv.1.0 for w8a8 bit of shape torch.Size([144, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.69e-02
MSE after  adaquant: 3.41e-02
 End of training layer  features.3.conv.1.0 better/total layers= 8 / 8 


Optimize 8:features.3.conv.2 for w4a8 bit of shape torch.Size([24, 144, 1, 1])

MSE before adaquant: 6.79e-02
MSE after  adaquant: 1.09e-02
 End of training layer  features.3.conv.2 better/total layers= 9 / 9 


Optimize 9:features.4.conv.0.0 for w4a8 bit of shape torch.Size([144, 24, 1, 1])

MSE before adaquant: 7.75e-04
MSE after  adaquant: 4.99e-04
 End of training layer  features.4.conv.0.0 better/total layers= 10 / 10 


Optimize 10:features.4.conv.1.0 for w8a8 bit of shape torch.Size([144, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.95e-05
MSE after  adaquant: 5.81e-05
 End of training layer  features.4.conv.1.0 better/total layers= 10 / 11 


Optimize 11:features.4.conv.2 for w4a8 bit of shape torch.Size([32, 144, 1, 1])

MSE before adaquant: 3.47e-02
MSE after  adaquant: 8.42e-03
 End of training layer  features.4.conv.2 better/total layers= 11 / 12 


Optimize 12:features.5.conv.0.0 for w4a8 bit of shape torch.Size([192, 32, 1, 1])

MSE before adaquant: 9.53e-04
MSE after  adaquant: 2.40e-04
 End of training layer  features.5.conv.0.0 better/total layers= 12 / 13 


Optimize 13:features.5.conv.1.0 for w8a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.17e-03
MSE after  adaquant: 2.69e-03
 End of training layer  features.5.conv.1.0 better/total layers= 13 / 14 


Optimize 14:features.5.conv.2 for w4a8 bit of shape torch.Size([32, 192, 1, 1])

MSE before adaquant: 1.97e-02
MSE after  adaquant: 2.87e-03
 End of training layer  features.5.conv.2 better/total layers= 14 / 15 


Optimize 15:features.6.conv.0.0 for w4a8 bit of shape torch.Size([192, 32, 1, 1])

MSE before adaquant: 2.36e-04
MSE after  adaquant: 1.55e-04
 End of training layer  features.6.conv.0.0 better/total layers= 15 / 16 


Optimize 16:features.6.conv.1.0 for w8a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.63e-04
MSE after  adaquant: 1.44e-04
 End of training layer  features.6.conv.1.0 better/total layers= 16 / 17 


Optimize 17:features.6.conv.2 for w4a8 bit of shape torch.Size([32, 192, 1, 1])

MSE before adaquant: 2.26e-02
MSE after  adaquant: 3.10e-03
 End of training layer  features.6.conv.2 better/total layers= 17 / 18 


Optimize 18:features.7.conv.0.0 for w4a8 bit of shape torch.Size([192, 32, 1, 1])

MSE before adaquant: 4.72e-04
MSE after  adaquant: 3.35e-04
 End of training layer  features.7.conv.0.0 better/total layers= 18 / 19 


Optimize 19:features.7.conv.1.0 for w8a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.97e-05
MSE after  adaquant: 4.00e-05
 End of training layer  features.7.conv.1.0 better/total layers= 18 / 20 


Optimize 20:features.7.conv.2 for w4a8 bit of shape torch.Size([64, 192, 1, 1])

MSE before adaquant: 4.45e-02
MSE after  adaquant: 5.48e-03
 End of training layer  features.7.conv.2 better/total layers= 19 / 21 


Optimize 21:features.8.conv.0.0 for w4a8 bit of shape torch.Size([384, 64, 1, 1])

MSE before adaquant: 1.14e-03
MSE after  adaquant: 3.02e-04
 End of training layer  features.8.conv.0.0 better/total layers= 20 / 22 


Optimize 22:features.8.conv.1.0 for w8a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.11e-03
MSE after  adaquant: 1.86e-03
 End of training layer  features.8.conv.1.0 better/total layers= 21 / 23 


Optimize 23:features.8.conv.2 for w4a8 bit of shape torch.Size([64, 384, 1, 1])

MSE before adaquant: 8.16e-03
MSE after  adaquant: 1.61e-03
 End of training layer  features.8.conv.2 better/total layers= 22 / 24 


Optimize 24:features.9.conv.0.0 for w4a8 bit of shape torch.Size([384, 64, 1, 1])

MSE before adaquant: 1.85e-04
MSE after  adaquant: 1.25e-04
 End of training layer  features.9.conv.0.0 better/total layers= 23 / 25 


Optimize 25:features.9.conv.1.0 for w8a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.45e-04
MSE after  adaquant: 1.10e-04
 End of training layer  features.9.conv.1.0 better/total layers= 24 / 26 


Optimize 26:features.9.conv.2 for w4a8 bit of shape torch.Size([64, 384, 1, 1])

MSE before adaquant: 5.24e-03
MSE after  adaquant: 1.55e-03
 End of training layer  features.9.conv.2 better/total layers= 25 / 27 


Optimize 27:features.10.conv.0.0 for w4a8 bit of shape torch.Size([384, 64, 1, 1])

MSE before adaquant: 1.71e-04
MSE after  adaquant: 1.28e-04
 End of training layer  features.10.conv.0.0 better/total layers= 26 / 28 


Optimize 28:features.10.conv.1.0 for w8a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 6.59e-05
MSE after  adaquant: 6.59e-05
 End of training layer  features.10.conv.1.0 better/total layers= 27 / 29 


Optimize 29:features.10.conv.2 for w4a8 bit of shape torch.Size([64, 384, 1, 1])

MSE before adaquant: 1.42e-02
MSE after  adaquant: 3.37e-03
 End of training layer  features.10.conv.2 better/total layers= 28 / 30 


Optimize 30:features.11.conv.0.0 for w4a8 bit of shape torch.Size([384, 64, 1, 1])

MSE before adaquant: 3.29e-04
MSE after  adaquant: 2.04e-04
 End of training layer  features.11.conv.0.0 better/total layers= 29 / 31 


Optimize 31:features.11.conv.1.0 for w8a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.86e-04
MSE after  adaquant: 3.53e-04
 End of training layer  features.11.conv.1.0 better/total layers= 30 / 32 


Optimize 32:features.11.conv.2 for w4a8 bit of shape torch.Size([96, 384, 1, 1])

MSE before adaquant: 1.40e-02
MSE after  adaquant: 2.32e-03
 End of training layer  features.11.conv.2 better/total layers= 31 / 33 


Optimize 33:features.12.conv.0.0 for w4a8 bit of shape torch.Size([576, 96, 1, 1])

MSE before adaquant: 1.35e-03
MSE after  adaquant: 3.32e-04
 End of training layer  features.12.conv.0.0 better/total layers= 32 / 34 


Optimize 34:features.12.conv.1.0 for w8a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.34e-03
MSE after  adaquant: 1.23e-03
 End of training layer  features.12.conv.1.0 better/total layers= 33 / 35 


Optimize 35:features.12.conv.2 for w4a8 bit of shape torch.Size([96, 576, 1, 1])

MSE before adaquant: 1.44e-02
MSE after  adaquant: 2.53e-03
 End of training layer  features.12.conv.2 better/total layers= 34 / 36 


Optimize 36:features.13.conv.0.0 for w4a8 bit of shape torch.Size([576, 96, 1, 1])

MSE before adaquant: 1.87e-04
MSE after  adaquant: 1.79e-04
 End of training layer  features.13.conv.0.0 better/total layers= 35 / 37 


Optimize 37:features.13.conv.1.0 for w8a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.16e-04
MSE after  adaquant: 1.14e-04
 End of training layer  features.13.conv.1.0 better/total layers= 36 / 38 


Optimize 38:features.13.conv.2 for w4a8 bit of shape torch.Size([96, 576, 1, 1])

MSE before adaquant: 4.44e-02
MSE after  adaquant: 4.73e-03
 End of training layer  features.13.conv.2 better/total layers= 37 / 39 


Optimize 39:features.14.conv.0.0 for w4a8 bit of shape torch.Size([576, 96, 1, 1])

MSE before adaquant: 6.49e-04
MSE after  adaquant: 2.57e-04
 End of training layer  features.14.conv.0.0 better/total layers= 38 / 40 


Optimize 40:features.14.conv.1.0 for w8a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.59e-03
MSE after  adaquant: 1.53e-03
 End of training layer  features.14.conv.1.0 better/total layers= 39 / 41 


Optimize 41:features.14.conv.2 for w4a8 bit of shape torch.Size([160, 576, 1, 1])

MSE before adaquant: 3.33e-02
MSE after  adaquant: 4.46e-03
 End of training layer  features.14.conv.2 better/total layers= 40 / 42 


Optimize 42:features.15.conv.0.0 for w4a8 bit of shape torch.Size([960, 160, 1, 1])

MSE before adaquant: 3.31e-03
MSE after  adaquant: 7.35e-04
 End of training layer  features.15.conv.0.0 better/total layers= 41 / 43 


Optimize 43:features.15.conv.1.0 for w8a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.09e-03
MSE after  adaquant: 2.05e-03
 End of training layer  features.15.conv.1.0 better/total layers= 42 / 44 


Optimize 44:features.15.conv.2 for w4a8 bit of shape torch.Size([160, 960, 1, 1])

MSE before adaquant: 2.93e-02
MSE after  adaquant: 5.32e-03
 End of training layer  features.15.conv.2 better/total layers= 43 / 45 


Optimize 45:features.16.conv.0.0 for w4a8 bit of shape torch.Size([960, 160, 1, 1])

MSE before adaquant: 4.46e-03
MSE after  adaquant: 7.10e-04
 End of training layer  features.16.conv.0.0 better/total layers= 44 / 46 


Optimize 46:features.16.conv.1.0 for w8a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.60e-03
MSE after  adaquant: 4.33e-03
 End of training layer  features.16.conv.1.0 better/total layers= 45 / 47 


Optimize 47:features.16.conv.2 for w4a8 bit of shape torch.Size([160, 960, 1, 1])

MSE before adaquant: 6.25e-02
MSE after  adaquant: 1.82e-02
 End of training layer  features.16.conv.2 better/total layers= 46 / 48 


Optimize 48:features.17.conv.0.0 for w4a8 bit of shape torch.Size([960, 160, 1, 1])

MSE before adaquant: 4.05e-04
MSE after  adaquant: 1.54e-04
 End of training layer  features.17.conv.0.0 better/total layers= 47 / 49 


Optimize 49:features.17.conv.1.0 for w8a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.03e-04
MSE after  adaquant: 1.84e-04
 End of training layer  features.17.conv.1.0 better/total layers= 48 / 50 


Optimize 50:features.17.conv.2 for w4a8 bit of shape torch.Size([320, 960, 1, 1])

MSE before adaquant: 6.47e-02
MSE after  adaquant: 4.84e-03
 End of training layer  features.17.conv.2 better/total layers= 49 / 51 


Optimize 51:features.18.0 for w8a8 bit of shape torch.Size([1280, 320, 1, 1])

MSE before adaquant: 2.69e-01
MSE after  adaquant: 3.94e-02
 End of training layer  features.18.0 better/total layers= 50 / 52 


Optimize 52:classifier.1 for w8a8 bit of shape torch.Size([1000, 1280])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.79e-01
MSE after  adaquant: 4.40e-01
 End of training layer  classifier.1 better/total layers= 51 / 53 

step 1: 
step 2: 
read json file /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenetv2_adaquant.piano.kdp530.scaled.w8.onnx.json
Json : Layer features.0.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.1.conv.0.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.1.conv.1, precision switch from w8a8 to w8a8b16.
Json : Layer features.2.conv.0.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.2.conv.1.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.2.conv.2, precision switch from w8a8 to w8a8b16.
Json : Layer features.3.conv.0.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.3.conv.1.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.3.conv.2, precision switch from w8a8 to w8a8b16.
Json : Layer features.4.conv.0.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.4.conv.1.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.4.conv.2, precision switch from w8a8 to w8a8b16.
Json : Layer features.5.conv.0.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.5.conv.1.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.5.conv.2, precision switch from w8a8 to w8a8b16.
Json : Layer features.6.conv.0.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.6.conv.1.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.6.conv.2, precision switch from w8a8 to w8a8b16.
Json : Layer features.7.conv.0.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.7.conv.1.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.7.conv.2, precision switch from w8a8 to w8a8b16.
Json : Layer features.8.conv.0.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.8.conv.1.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.8.conv.2, precision switch from w8a8 to w8a8b16.
Json : Layer features.9.conv.0.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.9.conv.1.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.9.conv.2, precision switch from w8a8 to w8a8b16.
Json : Layer features.10.conv.0.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.10.conv.1.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.10.conv.2, precision switch from w8a8 to w8a8b16.
Json : Layer features.11.conv.0.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.11.conv.1.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.11.conv.2, precision switch from w8a8 to w8a8b16.
Json : Layer features.12.conv.0.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.12.conv.1.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.12.conv.2, precision switch from w8a8 to w8a8b16.
Json : Layer features.13.conv.0.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.13.conv.1.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.13.conv.2, precision switch from w8a8 to w8a8b16.
Json : Layer features.14.conv.0.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.14.conv.1.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.14.conv.2, precision switch from w8a8 to w8a8b16.
Json : Layer features.15.conv.0.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.15.conv.1.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.15.conv.2, precision switch from w8a8 to w8a8b16.
Json : Layer features.16.conv.0.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.16.conv.1.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.16.conv.2, precision switch from w8a8 to w8a8b16.
Json : Layer features.17.conv.0.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.17.conv.1.0, precision switch from w8a8 to w8a8b16.
Json : Layer features.17.conv.2, precision switch from w8a8 to w8a8b16.
Json : Layer features.18.0, precision switch from w8a8 to w8a8b16.
Json : Layer classifier.1, precision switch from w8a8 to w8a8b16.
step 3: 
Input/outputs cached

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.w8a8.measure_perC.before_adaquant.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.w8a8.measure_perC.before_adaquant.onnx
Bernard calculate float point model accuracy before enabling quantization!
Bernard calculate fixed point model accuracy before training!

Optimize 0:features.0.0 for w8a8 bit of shape torch.Size([32, 3, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.58e-05
MSE after  adaquant: 1.15e-05
 End of training layer  features.0.0 better/total layers= 1 / 1 


Optimize 1:features.1.conv.0.0 for w8a8 bit of shape torch.Size([32, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 7.38e-02
MSE after  adaquant: 1.07e-02
 End of training layer  features.1.conv.0.0 better/total layers= 2 / 2 


Optimize 2:features.1.conv.1 for w8a8 bit of shape torch.Size([16, 32, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.24e-02
MSE after  adaquant: 2.46e-02
 End of training layer  features.1.conv.1 better/total layers= 3 / 3 


Optimize 3:features.2.conv.0.0 for w8a8 bit of shape torch.Size([96, 16, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 7.95e-05
MSE after  adaquant: 6.69e-05
 End of training layer  features.2.conv.0.0 better/total layers= 4 / 4 


Optimize 4:features.2.conv.1.0 for w8a8 bit of shape torch.Size([96, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.08e-02
MSE after  adaquant: 4.22e-03
 End of training layer  features.2.conv.1.0 better/total layers= 5 / 5 


Optimize 5:features.2.conv.2 for w8a8 bit of shape torch.Size([24, 96, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.73e-03
MSE after  adaquant: 5.70e-04
 End of training layer  features.2.conv.2 better/total layers= 6 / 6 


Optimize 6:features.3.conv.0.0 for w8a8 bit of shape torch.Size([144, 24, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.67e-04
MSE after  adaquant: 6.26e-05
 End of training layer  features.3.conv.0.0 better/total layers= 7 / 7 


Optimize 7:features.3.conv.1.0 for w8a8 bit of shape torch.Size([144, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.61e-02
MSE after  adaquant: 3.39e-04
 End of training layer  features.3.conv.1.0 better/total layers= 8 / 8 


Optimize 8:features.3.conv.2 for w8a8 bit of shape torch.Size([24, 144, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.33e-02
MSE after  adaquant: 6.50e-04
 End of training layer  features.3.conv.2 better/total layers= 9 / 9 


Optimize 9:features.4.conv.0.0 for w8a8 bit of shape torch.Size([144, 24, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.25e-05
MSE after  adaquant: 1.39e-05
 End of training layer  features.4.conv.0.0 better/total layers= 9 / 10 


Optimize 10:features.4.conv.1.0 for w8a8 bit of shape torch.Size([144, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.80e-03
MSE after  adaquant: 1.45e-04
 End of training layer  features.4.conv.1.0 better/total layers= 10 / 11 


Optimize 11:features.4.conv.2 for w8a8 bit of shape torch.Size([32, 144, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.21e-03
MSE after  adaquant: 3.82e-04
 End of training layer  features.4.conv.2 better/total layers= 11 / 12 


Optimize 12:features.5.conv.0.0 for w8a8 bit of shape torch.Size([192, 32, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.22e-04
MSE after  adaquant: 7.45e-06
 End of training layer  features.5.conv.0.0 better/total layers= 12 / 13 


Optimize 13:features.5.conv.1.0 for w8a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 6.51e-03
MSE after  adaquant: 3.99e-04
 End of training layer  features.5.conv.1.0 better/total layers= 13 / 14 


Optimize 14:features.5.conv.2 for w8a8 bit of shape torch.Size([32, 192, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.12e-03
MSE after  adaquant: 1.99e-04
 End of training layer  features.5.conv.2 better/total layers= 14 / 15 


Optimize 15:features.6.conv.0.0 for w8a8 bit of shape torch.Size([192, 32, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.98e-06
MSE after  adaquant: 4.55e-06
 End of training layer  features.6.conv.0.0 better/total layers= 14 / 16 


Optimize 16:features.6.conv.1.0 for w8a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.54e-03
MSE after  adaquant: 1.59e-04
 End of training layer  features.6.conv.1.0 better/total layers= 15 / 17 


Optimize 17:features.6.conv.2 for w8a8 bit of shape torch.Size([32, 192, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.10e-03
MSE after  adaquant: 1.70e-04
 End of training layer  features.6.conv.2 better/total layers= 16 / 18 


Optimize 18:features.7.conv.0.0 for w8a8 bit of shape torch.Size([192, 32, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 6.08e-06
MSE after  adaquant: 8.83e-06
 End of training layer  features.7.conv.0.0 better/total layers= 16 / 19 


Optimize 19:features.7.conv.1.0 for w8a8 bit of shape torch.Size([192, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.54e-03
MSE after  adaquant: 1.24e-04
 End of training layer  features.7.conv.1.0 better/total layers= 17 / 20 


Optimize 20:features.7.conv.2 for w8a8 bit of shape torch.Size([64, 192, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.68e-03
MSE after  adaquant: 2.44e-04
 End of training layer  features.7.conv.2 better/total layers= 18 / 21 


Optimize 21:features.8.conv.0.0 for w8a8 bit of shape torch.Size([384, 64, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.20e-05
MSE after  adaquant: 4.62e-06
 End of training layer  features.8.conv.0.0 better/total layers= 19 / 22 


Optimize 22:features.8.conv.1.0 for w8a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.96e-03
MSE after  adaquant: 6.87e-05
 End of training layer  features.8.conv.1.0 better/total layers= 20 / 23 


Optimize 23:features.8.conv.2 for w8a8 bit of shape torch.Size([64, 384, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 6.96e-04
MSE after  adaquant: 7.27e-05
 End of training layer  features.8.conv.2 better/total layers= 21 / 24 


Optimize 24:features.9.conv.0.0 for w8a8 bit of shape torch.Size([384, 64, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.57e-06
MSE after  adaquant: 4.29e-06
 End of training layer  features.9.conv.0.0 better/total layers= 21 / 25 


Optimize 25:features.9.conv.1.0 for w8a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.94e-03
MSE after  adaquant: 1.26e-04
 End of training layer  features.9.conv.1.0 better/total layers= 22 / 26 


Optimize 26:features.9.conv.2 for w8a8 bit of shape torch.Size([64, 384, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.07e-03
MSE after  adaquant: 7.31e-05
 End of training layer  features.9.conv.2 better/total layers= 23 / 27 


Optimize 27:features.10.conv.0.0 for w8a8 bit of shape torch.Size([384, 64, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.52e-06
MSE after  adaquant: 4.35e-06
 End of training layer  features.10.conv.0.0 better/total layers= 23 / 28 


Optimize 28:features.10.conv.1.0 for w8a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.42e-03
MSE after  adaquant: 1.81e-04
 End of training layer  features.10.conv.1.0 better/total layers= 24 / 29 


Optimize 29:features.10.conv.2 for w8a8 bit of shape torch.Size([64, 384, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 5.00e-03
MSE after  adaquant: 2.79e-04
 End of training layer  features.10.conv.2 better/total layers= 25 / 30 


Optimize 30:features.11.conv.0.0 for w8a8 bit of shape torch.Size([384, 64, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.43e-06
MSE after  adaquant: 6.22e-06
 End of training layer  features.11.conv.0.0 better/total layers= 25 / 31 


Optimize 31:features.11.conv.1.0 for w8a8 bit of shape torch.Size([384, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.05e-02
MSE after  adaquant: 3.79e-05
 End of training layer  features.11.conv.1.0 better/total layers= 26 / 32 


Optimize 32:features.11.conv.2 for w8a8 bit of shape torch.Size([96, 384, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.83e-03
MSE after  adaquant: 1.39e-04
 End of training layer  features.11.conv.2 better/total layers= 27 / 33 


Optimize 33:features.12.conv.0.0 for w8a8 bit of shape torch.Size([576, 96, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 6.29e-05
MSE after  adaquant: 8.61e-06
 End of training layer  features.12.conv.0.0 better/total layers= 28 / 34 


Optimize 34:features.12.conv.1.0 for w8a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.75e-03
MSE after  adaquant: 6.67e-05
 End of training layer  features.12.conv.1.0 better/total layers= 29 / 35 


Optimize 35:features.12.conv.2 for w8a8 bit of shape torch.Size([96, 576, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 6.85e-04
MSE after  adaquant: 3.28e-04
 End of training layer  features.12.conv.2 better/total layers= 30 / 36 


Optimize 36:features.13.conv.0.0 for w8a8 bit of shape torch.Size([576, 96, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.12e-06
MSE after  adaquant: 3.06e-06
 End of training layer  features.13.conv.0.0 better/total layers= 30 / 37 


Optimize 37:features.13.conv.1.0 for w8a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.31e-04
MSE after  adaquant: 5.67e-05
 End of training layer  features.13.conv.1.0 better/total layers= 31 / 38 


Optimize 38:features.13.conv.2 for w8a8 bit of shape torch.Size([96, 576, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.60e-03
MSE after  adaquant: 1.72e-03
 End of training layer  features.13.conv.2 better/total layers= 32 / 39 


Optimize 39:features.14.conv.0.0 for w8a8 bit of shape torch.Size([576, 96, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 3.29e-04
MSE after  adaquant: 1.32e-04
 End of training layer  features.14.conv.0.0 better/total layers= 33 / 40 


Optimize 40:features.14.conv.1.0 for w8a8 bit of shape torch.Size([576, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.80e-03
MSE after  adaquant: 1.59e-05
 End of training layer  features.14.conv.1.0 better/total layers= 34 / 41 


Optimize 41:features.14.conv.2 for w8a8 bit of shape torch.Size([160, 576, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.88e-03
MSE after  adaquant: 2.25e-03
 End of training layer  features.14.conv.2 better/total layers= 35 / 42 


Optimize 42:features.15.conv.0.0 for w8a8 bit of shape torch.Size([960, 160, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 7.69e-04
MSE after  adaquant: 2.18e-04
 End of training layer  features.15.conv.0.0 better/total layers= 36 / 43 


Optimize 43:features.15.conv.1.0 for w8a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.18e-03
MSE after  adaquant: 5.73e-04
 End of training layer  features.15.conv.1.0 better/total layers= 37 / 44 


Optimize 44:features.15.conv.2 for w8a8 bit of shape torch.Size([160, 960, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.66e-02
MSE after  adaquant: 1.27e-02
 End of training layer  features.15.conv.2 better/total layers= 38 / 45 


Optimize 45:features.16.conv.0.0 for w8a8 bit of shape torch.Size([960, 160, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.19e-03
MSE after  adaquant: 2.35e-03
 End of training layer  features.16.conv.0.0 better/total layers= 39 / 46 


Optimize 46:features.16.conv.1.0 for w8a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.08e-03
MSE after  adaquant: 3.70e-03
 End of training layer  features.16.conv.1.0 better/total layers= 40 / 47 


Optimize 47:features.16.conv.2 for w8a8 bit of shape torch.Size([160, 960, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.82e-02
MSE after  adaquant: 4.16e-02
 End of training layer  features.16.conv.2 better/total layers= 41 / 48 


Optimize 48:features.17.conv.0.0 for w8a8 bit of shape torch.Size([960, 160, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 2.86e-04
MSE after  adaquant: 9.41e-05
 End of training layer  features.17.conv.0.0 better/total layers= 42 / 49 


Optimize 49:features.17.conv.1.0 for w8a8 bit of shape torch.Size([960, 1, 3, 3])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 5.55e-05
MSE after  adaquant: 1.79e-05
 End of training layer  features.17.conv.1.0 better/total layers= 43 / 50 


Optimize 50:features.17.conv.2 for w8a8 bit of shape torch.Size([320, 960, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 4.86e-04
MSE after  adaquant: 3.28e-04
 End of training layer  features.17.conv.2 better/total layers= 44 / 51 


Optimize 51:features.18.0 for w8a8 bit of shape torch.Size([1280, 320, 1, 1])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 6.04e-04
MSE after  adaquant: 4.18e-04
 End of training layer  features.18.0 better/total layers= 45 / 52 


Optimize 52:classifier.1 for w8a8 bit of shape torch.Size([1000, 1280])
8-bit layer should use smaller LR = 0.01

MSE before adaquant: 1.84e-03
MSE after  adaquant: 1.32e-03
 End of training layer  classifier.1 better/total layers= 46 / 53 

step 4
Train: ########### All 8bit results ###########
Layer features.1.conv.0.0, precision switch from w8a8 to w4a8.
Layer features.1.conv.0.0, precision switch from w4a8 to w8a8.
finished 0 out of 50
Layer features.1.conv.1, precision switch from w8a8 to w4a8.
Layer features.1.conv.1, precision switch from w4a8 to w8a8.
finished 1 out of 50
Layer features.2.conv.0.0, precision switch from w8a8 to w4a8.
Layer features.2.conv.0.0, precision switch from w4a8 to w8a8.
finished 2 out of 50
Layer features.2.conv.1.0, precision switch from w8a8 to w4a8.
Layer features.2.conv.1.0, precision switch from w4a8 to w8a8.
finished 3 out of 50
Layer features.2.conv.2, precision switch from w8a8 to w4a8.
Layer features.2.conv.2, precision switch from w4a8 to w8a8.
finished 4 out of 50
Layer features.3.conv.0.0, precision switch from w8a8 to w4a8.
Layer features.3.conv.0.0, precision switch from w4a8 to w8a8.
finished 5 out of 50
Layer features.3.conv.1.0, precision switch from w8a8 to w4a8.
Layer features.3.conv.1.0, precision switch from w4a8 to w8a8.
finished 6 out of 50
Layer features.3.conv.2, precision switch from w8a8 to w4a8.
Layer features.3.conv.2, precision switch from w4a8 to w8a8.
finished 7 out of 50
Layer features.4.conv.0.0, precision switch from w8a8 to w4a8.
Layer features.4.conv.0.0, precision switch from w4a8 to w8a8.
finished 8 out of 50
Layer features.4.conv.1.0, precision switch from w8a8 to w4a8.
Layer features.4.conv.1.0, precision switch from w4a8 to w8a8.
finished 9 out of 50
Layer features.4.conv.2, precision switch from w8a8 to w4a8.
Layer features.4.conv.2, precision switch from w4a8 to w8a8.
finished 10 out of 50
Layer features.5.conv.0.0, precision switch from w8a8 to w4a8.
Layer features.5.conv.0.0, precision switch from w4a8 to w8a8.
finished 11 out of 50
Layer features.5.conv.1.0, precision switch from w8a8 to w4a8.
Layer features.5.conv.1.0, precision switch from w4a8 to w8a8.
finished 12 out of 50
Layer features.5.conv.2, precision switch from w8a8 to w4a8.
Layer features.5.conv.2, precision switch from w4a8 to w8a8.
finished 13 out of 50
Layer features.6.conv.0.0, precision switch from w8a8 to w4a8.
Layer features.6.conv.0.0, precision switch from w4a8 to w8a8.
finished 14 out of 50
Layer features.6.conv.1.0, precision switch from w8a8 to w4a8.
Layer features.6.conv.1.0, precision switch from w4a8 to w8a8.
finished 15 out of 50
Layer features.6.conv.2, precision switch from w8a8 to w4a8.
Layer features.6.conv.2, precision switch from w4a8 to w8a8.
finished 16 out of 50
Layer features.7.conv.0.0, precision switch from w8a8 to w4a8.
Layer features.7.conv.0.0, precision switch from w4a8 to w8a8.
finished 17 out of 50
Layer features.7.conv.1.0, precision switch from w8a8 to w4a8.
Layer features.7.conv.1.0, precision switch from w4a8 to w8a8.
finished 18 out of 50
Layer features.7.conv.2, precision switch from w8a8 to w4a8.
Layer features.7.conv.2, precision switch from w4a8 to w8a8.
finished 19 out of 50
Layer features.8.conv.0.0, precision switch from w8a8 to w4a8.
Layer features.8.conv.0.0, precision switch from w4a8 to w8a8.
finished 20 out of 50
Layer features.8.conv.1.0, precision switch from w8a8 to w4a8.
Layer features.8.conv.1.0, precision switch from w4a8 to w8a8.
finished 21 out of 50
Layer features.8.conv.2, precision switch from w8a8 to w4a8.
Layer features.8.conv.2, precision switch from w4a8 to w8a8.
finished 22 out of 50
Layer features.9.conv.0.0, precision switch from w8a8 to w4a8.
Layer features.9.conv.0.0, precision switch from w4a8 to w8a8.
finished 23 out of 50
Layer features.9.conv.1.0, precision switch from w8a8 to w4a8.
Layer features.9.conv.1.0, precision switch from w4a8 to w8a8.
finished 24 out of 50
Layer features.9.conv.2, precision switch from w8a8 to w4a8.
Layer features.9.conv.2, precision switch from w4a8 to w8a8.
finished 25 out of 50
Layer features.10.conv.0.0, precision switch from w8a8 to w4a8.
Layer features.10.conv.0.0, precision switch from w4a8 to w8a8.
finished 26 out of 50
Layer features.10.conv.1.0, precision switch from w8a8 to w4a8.
Layer features.10.conv.1.0, precision switch from w4a8 to w8a8.
finished 27 out of 50
Layer features.10.conv.2, precision switch from w8a8 to w4a8.
Layer features.10.conv.2, precision switch from w4a8 to w8a8.
finished 28 out of 50
Layer features.11.conv.0.0, precision switch from w8a8 to w4a8.
Layer features.11.conv.0.0, precision switch from w4a8 to w8a8.
finished 29 out of 50
Layer features.11.conv.1.0, precision switch from w8a8 to w4a8.
Layer features.11.conv.1.0, precision switch from w4a8 to w8a8.
finished 30 out of 50
Layer features.11.conv.2, precision switch from w8a8 to w4a8.
Layer features.11.conv.2, precision switch from w4a8 to w8a8.
finished 31 out of 50
Layer features.12.conv.0.0, precision switch from w8a8 to w4a8.
Layer features.12.conv.0.0, precision switch from w4a8 to w8a8.
finished 32 out of 50
Layer features.12.conv.1.0, precision switch from w8a8 to w4a8.
Layer features.12.conv.1.0, precision switch from w4a8 to w8a8.
finished 33 out of 50
Layer features.12.conv.2, precision switch from w8a8 to w4a8.
Layer features.12.conv.2, precision switch from w4a8 to w8a8.
finished 34 out of 50
Layer features.13.conv.0.0, precision switch from w8a8 to w4a8.
Layer features.13.conv.0.0, precision switch from w4a8 to w8a8.
finished 35 out of 50
Layer features.13.conv.1.0, precision switch from w8a8 to w4a8.
Layer features.13.conv.1.0, precision switch from w4a8 to w8a8.
finished 36 out of 50
Layer features.13.conv.2, precision switch from w8a8 to w4a8.
Layer features.13.conv.2, precision switch from w4a8 to w8a8.
finished 37 out of 50
Layer features.14.conv.0.0, precision switch from w8a8 to w4a8.
Layer features.14.conv.0.0, precision switch from w4a8 to w8a8.
finished 38 out of 50
Layer features.14.conv.1.0, precision switch from w8a8 to w4a8.
Layer features.14.conv.1.0, precision switch from w4a8 to w8a8.
finished 39 out of 50
Layer features.14.conv.2, precision switch from w8a8 to w4a8.
Layer features.14.conv.2, precision switch from w4a8 to w8a8.
finished 40 out of 50
Layer features.15.conv.0.0, precision switch from w8a8 to w4a8.
Layer features.15.conv.0.0, precision switch from w4a8 to w8a8.
finished 41 out of 50
Layer features.15.conv.1.0, precision switch from w8a8 to w4a8.
Layer features.15.conv.1.0, precision switch from w4a8 to w8a8.
finished 42 out of 50
Layer features.15.conv.2, precision switch from w8a8 to w4a8.
Layer features.15.conv.2, precision switch from w4a8 to w8a8.
finished 43 out of 50
Layer features.16.conv.0.0, precision switch from w8a8 to w4a8.
Layer features.16.conv.0.0, precision switch from w4a8 to w8a8.
finished 44 out of 50
Layer features.16.conv.1.0, precision switch from w8a8 to w4a8.
Layer features.16.conv.1.0, precision switch from w4a8 to w8a8.
finished 45 out of 50
Layer features.16.conv.2, precision switch from w8a8 to w4a8.
Layer features.16.conv.2, precision switch from w4a8 to w8a8.
finished 46 out of 50
Layer features.17.conv.0.0, precision switch from w8a8 to w4a8.
Layer features.17.conv.0.0, precision switch from w4a8 to w8a8.
finished 47 out of 50
Layer features.17.conv.1.0, precision switch from w8a8 to w4a8.
Layer features.17.conv.1.0, precision switch from w4a8 to w8a8.
finished 48 out of 50
Layer features.17.conv.2, precision switch from w8a8 to w4a8.
step 5
Found K = 34
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8']
Achieved compression:  0.13026968786010132
Expected acc:  3.970825977718355
Params % in int 4 = 0.9578423272600775
Params % in int 8 = 0.042157672739922596
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.w8a8.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.w4a8.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w4a8.
switched layer features.2.conv.2 to w4a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.1.0 to w8a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.4.conv.0.0 to w4a8
Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.1.0 to w8a8
Layer features.4.conv.2, precision switch from w8a8 to w4a8.
switched layer features.4.conv.2 to w4a8
Layer features.5.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.5.conv.0.0 to w4a8
Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.1.0 to w8a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.6.conv.0.0 to w4a8
Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.1.0 to w8a8
Layer features.6.conv.2, precision switch from w8a8 to w4a8.
switched layer features.6.conv.2 to w4a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.1.0 to w8a8
Layer features.8.conv.2, precision switch from w8a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w4a8.
switched layer features.10.conv.2 to w4a8
Layer features.11.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.11.conv.0.0 to w4a8
Layer features.11.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w4a8.
switched layer features.11.conv.2 to w4a8
Layer features.12.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.1.0 to w8a8
Layer features.12.conv.2, precision switch from w8a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.1.0 to w8a8
Layer features.13.conv.2, precision switch from w8a8 to w4a8.
switched layer features.13.conv.2 to w4a8
Layer features.14.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.14.conv.0.0 to w4a8
Layer features.14.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w4a8.
switched layer features.14.conv.2 to w4a8
Layer features.15.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w4a8.
switched layer features.15.conv.2 to w4a8
Layer features.16.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w8a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.17.conv.0.0 to w4a8
Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.1.0 to w8a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13026968786010132, expected loss 3.970825977718355, actual acc 30.999999954223632, actual loss 3.2294141387939455
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Found K = 33
Final Solution:  {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Achieved compression:  0.14331486766616297
Expected acc:  3.3187558130378743
Params % in int 4 = 0.8534808888115841
Params % in int 8 = 0.14651911118841587
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.w8a8.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.w4a8.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.1.conv.0.0 to w4a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w4a8.
switched layer features.2.conv.2 to w4a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.1.0 to w8a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.4.conv.0.0 to w4a8
Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.1.0 to w8a8
Layer features.4.conv.2, precision switch from w8a8 to w4a8.
switched layer features.4.conv.2 to w4a8
Layer features.5.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.5.conv.0.0 to w4a8
Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.1.0 to w8a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.6.conv.0.0 to w4a8
Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.1.0 to w8a8
Layer features.6.conv.2, precision switch from w8a8 to w4a8.
switched layer features.6.conv.2 to w4a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.8.conv.0.0 to w4a8
Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.1.0 to w8a8
Layer features.8.conv.2, precision switch from w8a8 to w4a8.
switched layer features.8.conv.2 to w4a8
Layer features.9.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w4a8.
switched layer features.10.conv.2 to w4a8
Layer features.11.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.11.conv.0.0 to w4a8
Layer features.11.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w4a8.
switched layer features.11.conv.2 to w4a8
Layer features.12.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.1.0 to w8a8
Layer features.12.conv.2, precision switch from w8a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.1.0 to w8a8
Layer features.13.conv.2, precision switch from w8a8 to w4a8.
switched layer features.13.conv.2 to w4a8
Layer features.14.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.14.conv.0.0 to w4a8
Layer features.14.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w4a8.
switched layer features.14.conv.2 to w4a8
Layer features.15.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w4a8.
switched layer features.15.conv.2 to w4a8
Layer features.16.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w8a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.1.0 to w8a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13026968786010132, expected loss 3.970825977718355, actual acc 30.999999954223632, actual loss 3.2294141387939455
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14331486766616297, expected loss 3.3187558130378743, actual acc 46.09999951171875, actual loss 2.513716911315918
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Found K = 27
Final Solution:  {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Achieved compression:  0.15039189894334043
Expected acc:  3.0664228647575396
Params % in int 4 = 0.7968648084532766
Params % in int 8 = 0.2031351915467235
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.w8a8.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.w4a8.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.1.conv.0.0 to w8a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w4a8.
switched layer features.2.conv.2 to w4a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.1.0 to w8a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.1.0 to w8a8
Layer features.4.conv.2, precision switch from w8a8 to w4a8.
switched layer features.4.conv.2 to w4a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.1.0 to w8a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.6.conv.0.0 to w4a8
Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.1.0 to w8a8
Layer features.6.conv.2, precision switch from w8a8 to w4a8.
switched layer features.6.conv.2 to w4a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.0.0 to w8a8
Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.1.0 to w8a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.10.conv.0.0 to w4a8
Layer features.10.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w4a8.
switched layer features.10.conv.2 to w4a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w4a8.
switched layer features.11.conv.2 to w4a8
Layer features.12.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.1.0 to w8a8
Layer features.12.conv.2, precision switch from w8a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.1.0 to w8a8
Layer features.13.conv.2, precision switch from w8a8 to w4a8.
switched layer features.13.conv.2 to w4a8
Layer features.14.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.14.conv.0.0 to w4a8
Layer features.14.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w4a8.
switched layer features.14.conv.2 to w4a8
Layer features.15.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.15.conv.1.0 to w4a8
Layer features.15.conv.2, precision switch from w8a8 to w4a8.
switched layer features.15.conv.2 to w4a8
Layer features.16.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w8a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.1.0 to w8a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13026968786010132, expected loss 3.970825977718355, actual acc 30.999999954223632, actual loss 3.2294141387939455
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14331486766616297, expected loss 3.3187558130378743, actual acc 46.09999951171875, actual loss 2.513716911315918
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.15039189894334043, expected loss 3.0664228647575396, actual acc 47.09999969482422, actual loss 2.4715241050720214
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Found K = 22
Final Solution:  {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Achieved compression:  0.16156183415228073
Expected acc:  2.850032648406983
Params % in int 4 = 0.7075053267817542
Params % in int 8 = 0.29249467321824585
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.w8a8.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.w4a8.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.1.conv.0.0 to w8a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w4a8.
switched layer features.2.conv.2 to w4a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.1.0 to w8a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.1.0 to w8a8
Layer features.4.conv.2, precision switch from w8a8 to w4a8.
switched layer features.4.conv.2 to w4a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.1.0 to w8a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.6.conv.0.0 to w4a8
Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.1.0 to w8a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.0.0 to w8a8
Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.1.0 to w8a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.9.conv.0.0 to w4a8
Layer features.9.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.0.0 to w8a8
Layer features.10.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w4a8.
switched layer features.10.conv.2 to w4a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.1.0 to w8a8
Layer features.12.conv.2, precision switch from w8a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.1.0 to w8a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.14.conv.0.0 to w4a8
Layer features.14.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w4a8.
switched layer features.14.conv.2 to w4a8
Layer features.15.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.15.conv.1.0 to w8a8
Layer features.15.conv.2, precision switch from w8a8 to w4a8.
switched layer features.15.conv.2 to w4a8
Layer features.16.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.16.conv.0.0 to w4a8
Layer features.16.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.16.conv.1.0 to w4a8
Layer features.16.conv.2, precision switch from w8a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.1.0 to w8a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13026968786010132, expected loss 3.970825977718355, actual acc 30.999999954223632, actual loss 3.2294141387939455
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14331486766616297, expected loss 3.3187558130378743, actual acc 46.09999951171875, actual loss 2.513716911315918
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.15039189894334043, expected loss 3.0664228647575396, actual acc 47.09999969482422, actual loss 2.4715241050720214
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16156183415228073, expected loss 2.850032648406983, actual acc 49.40000012207031, actual loss 2.304720260620117
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Found K = 18
Final Solution:  {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Achieved compression:  0.18212429882158543
Expected acc:  2.6272426694259643
Params % in int 4 = 0.5430056094273166
Params % in int 8 = 0.4569943905726834
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.w8a8.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.w4a8.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.1.conv.0.0 to w8a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w4a8.
switched layer features.2.conv.2 to w4a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.1.0 to w8a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.1.0 to w8a8
Layer features.4.conv.2, precision switch from w8a8 to w4a8.
switched layer features.4.conv.2 to w4a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.1.0 to w8a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.6.conv.0.0 to w4a8
Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.1.0 to w8a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.0.0 to w8a8
Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.1.0 to w8a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.0.0 to w8a8
Layer features.9.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.0.0 to w8a8
Layer features.10.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w4a8.
switched layer features.10.conv.2 to w4a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.1.0 to w8a8
Layer features.12.conv.2, precision switch from w8a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.1.0 to w8a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w4a8.
switched layer features.14.conv.2 to w4a8
Layer features.15.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.15.conv.1.0 to w8a8
Layer features.15.conv.2, precision switch from w8a8 to w4a8.
switched layer features.15.conv.2 to w4a8
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.16.conv.0.0 to w8a8
Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.16.conv.1.0 to w8a8
Layer features.16.conv.2, precision switch from w8a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.1.0 to w8a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13026968786010132, expected loss 3.970825977718355, actual acc 30.999999954223632, actual loss 3.2294141387939455
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14331486766616297, expected loss 3.3187558130378743, actual acc 46.09999951171875, actual loss 2.513716911315918
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.15039189894334043, expected loss 3.0664228647575396, actual acc 47.09999969482422, actual loss 2.4715241050720214
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16156183415228073, expected loss 2.850032648406983, actual acc 49.40000012207031, actual loss 2.304720260620117
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.18212429882158543, expected loss 2.6272426694259643, actual acc 51.49999975585938, actual loss 2.079436592102051
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Found K = 18
Final Solution:  {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Achieved compression:  0.18212429882158543
Expected acc:  2.6272426694259643
Params % in int 4 = 0.5430056094273166
Params % in int 8 = 0.4569943905726834
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.w8a8.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.w4a8.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.1.conv.0.0 to w8a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w4a8.
switched layer features.2.conv.2 to w4a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.1.0 to w8a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.1.0 to w8a8
Layer features.4.conv.2, precision switch from w8a8 to w4a8.
switched layer features.4.conv.2 to w4a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.1.0 to w8a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.6.conv.0.0 to w4a8
Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.1.0 to w8a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.0.0 to w8a8
Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.1.0 to w8a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.0.0 to w8a8
Layer features.9.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.0.0 to w8a8
Layer features.10.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w4a8.
switched layer features.10.conv.2 to w4a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.1.0 to w8a8
Layer features.12.conv.2, precision switch from w8a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.1.0 to w8a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w4a8.
switched layer features.14.conv.2 to w4a8
Layer features.15.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.15.conv.1.0 to w8a8
Layer features.15.conv.2, precision switch from w8a8 to w4a8.
switched layer features.15.conv.2 to w4a8
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.16.conv.0.0 to w8a8
Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.16.conv.1.0 to w8a8
Layer features.16.conv.2, precision switch from w8a8 to w4a8.
switched layer features.16.conv.2 to w4a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.1.0 to w8a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13026968786010132, expected loss 3.970825977718355, actual acc 30.999999954223632, actual loss 3.2294141387939455
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14331486766616297, expected loss 3.3187558130378743, actual acc 46.09999951171875, actual loss 2.513716911315918
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.15039189894334043, expected loss 3.0664228647575396, actual acc 47.09999969482422, actual loss 2.4715241050720214
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16156183415228073, expected loss 2.850032648406983, actual acc 49.40000012207031, actual loss 2.304720260620117
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.18212429882158543, expected loss 2.6272426694259643, actual acc 51.49999975585938, actual loss 2.079436592102051
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.18212429882158543, expected loss 2.6272426694259643, actual acc 51.49999975585938, actual loss 2.079436592102051
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Found K = 16
Final Solution:  {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Achieved compression:  0.20299658651128408
Expected acc:  2.4533814280853274
Params % in int 4 = 0.3760273079097274
Params % in int 8 = 0.6239726920902726
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.w8a8.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.w4a8.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.1.conv.0.0 to w8a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w4a8.
switched layer features.2.conv.2 to w4a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.1.0 to w8a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.1.0 to w8a8
Layer features.4.conv.2, precision switch from w8a8 to w4a8.
switched layer features.4.conv.2 to w4a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.1.0 to w8a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.6.conv.0.0 to w4a8
Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.1.0 to w8a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.0.0 to w8a8
Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.1.0 to w8a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.0.0 to w8a8
Layer features.9.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.0.0 to w8a8
Layer features.10.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w4a8.
switched layer features.10.conv.2 to w4a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.1.0 to w8a8
Layer features.12.conv.2, precision switch from w8a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.1.0 to w8a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.15.conv.1.0 to w8a8
Layer features.15.conv.2, precision switch from w8a8 to w4a8.
switched layer features.15.conv.2 to w4a8
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.16.conv.0.0 to w8a8
Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.16.conv.1.0 to w8a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.1.0 to w8a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13026968786010132, expected loss 3.970825977718355, actual acc 30.999999954223632, actual loss 3.2294141387939455
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14331486766616297, expected loss 3.3187558130378743, actual acc 46.09999951171875, actual loss 2.513716911315918
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.15039189894334043, expected loss 3.0664228647575396, actual acc 47.09999969482422, actual loss 2.4715241050720214
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16156183415228073, expected loss 2.850032648406983, actual acc 49.40000012207031, actual loss 2.304720260620117
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.18212429882158543, expected loss 2.6272426694259643, actual acc 51.49999975585938, actual loss 2.079436592102051
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.18212429882158543, expected loss 2.6272426694259643, actual acc 51.49999975585938, actual loss 2.079436592102051
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.20299658651128408, expected loss 2.4533814280853274, actual acc 59.09999963378906, actual loss 1.6862680978775024
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Found K = 16
Final Solution:  {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Achieved compression:  0.20299658651128408
Expected acc:  2.4533814280853274
Params % in int 4 = 0.3760273079097274
Params % in int 8 = 0.6239726920902726
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.w8a8.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.w4a8.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.1.conv.0.0 to w8a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w4a8.
switched layer features.2.conv.2 to w4a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.1.0 to w8a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.1.0 to w8a8
Layer features.4.conv.2, precision switch from w8a8 to w4a8.
switched layer features.4.conv.2 to w4a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.1.0 to w8a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.6.conv.0.0 to w4a8
Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.1.0 to w8a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.0.0 to w8a8
Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.1.0 to w8a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.0.0 to w8a8
Layer features.9.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.0.0 to w8a8
Layer features.10.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w4a8.
switched layer features.10.conv.2 to w4a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.1.0 to w8a8
Layer features.12.conv.2, precision switch from w8a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.1.0 to w8a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.15.conv.1.0 to w8a8
Layer features.15.conv.2, precision switch from w8a8 to w4a8.
switched layer features.15.conv.2 to w4a8
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.16.conv.0.0 to w8a8
Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.16.conv.1.0 to w8a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.1.0 to w8a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13026968786010132, expected loss 3.970825977718355, actual acc 30.999999954223632, actual loss 3.2294141387939455
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14331486766616297, expected loss 3.3187558130378743, actual acc 46.09999951171875, actual loss 2.513716911315918
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.15039189894334043, expected loss 3.0664228647575396, actual acc 47.09999969482422, actual loss 2.4715241050720214
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16156183415228073, expected loss 2.850032648406983, actual acc 49.40000012207031, actual loss 2.304720260620117
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.18212429882158543, expected loss 2.6272426694259643, actual acc 51.49999975585938, actual loss 2.079436592102051
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.18212429882158543, expected loss 2.6272426694259643, actual acc 51.49999975585938, actual loss 2.079436592102051
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.20299658651128408, expected loss 2.4533814280853274, actual acc 59.09999963378906, actual loss 1.6862680978775024
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.20299658651128408, expected loss 2.4533814280853274, actual acc 59.09999963378906, actual loss 1.6862680978775024
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Found K = 15
Final Solution:  {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Achieved compression:  0.21604176631734573
Expected acc:  2.3512199490890504
Params % in int 4 = 0.27166586946123406
Params % in int 8 = 0.728334130538766
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.w8a8.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.w4a8.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.1.conv.0.0 to w8a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w4a8.
switched layer features.2.conv.2 to w4a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.1.0 to w8a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.1.0 to w8a8
Layer features.4.conv.2, precision switch from w8a8 to w4a8.
switched layer features.4.conv.2 to w4a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.1.0 to w8a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.6.conv.0.0 to w4a8
Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.1.0 to w8a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.0.0 to w8a8
Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.1.0 to w8a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.0.0 to w8a8
Layer features.9.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.0.0 to w8a8
Layer features.10.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w4a8.
switched layer features.10.conv.2 to w4a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.1.0 to w8a8
Layer features.12.conv.2, precision switch from w8a8 to w4a8.
switched layer features.12.conv.2 to w4a8
Layer features.13.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.1.0 to w8a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.15.conv.1.0 to w8a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.16.conv.0.0 to w8a8
Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.16.conv.1.0 to w8a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.1.0 to w8a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13026968786010132, expected loss 3.970825977718355, actual acc 30.999999954223632, actual loss 3.2294141387939455
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14331486766616297, expected loss 3.3187558130378743, actual acc 46.09999951171875, actual loss 2.513716911315918
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.15039189894334043, expected loss 3.0664228647575396, actual acc 47.09999969482422, actual loss 2.4715241050720214
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16156183415228073, expected loss 2.850032648406983, actual acc 49.40000012207031, actual loss 2.304720260620117
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.18212429882158543, expected loss 2.6272426694259643, actual acc 51.49999975585938, actual loss 2.079436592102051
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.18212429882158543, expected loss 2.6272426694259643, actual acc 51.49999975585938, actual loss 2.079436592102051
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.20299658651128408, expected loss 2.4533814280853274, actual acc 59.09999963378906, actual loss 1.6862680978775024
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.20299658651128408, expected loss 2.4533814280853274, actual acc 59.09999963378906, actual loss 1.6862680978775024
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.21, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss, compression 0.21604176631734573, expected loss 2.3512199490890504, actual acc 59.60000006103515, actual loss 1.6337575912475586
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Found K = 14
Final Solution:  {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Achieved compression:  0.22073803104752793
Expected acc:  2.3263268202171328
Params % in int 4 = 0.2340957516197765
Params % in int 8 = 0.7659042483802235
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.w8a8.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.w4a8.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.1.conv.0.0 to w8a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w4a8.
switched layer features.2.conv.2 to w4a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.1.0 to w8a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.1.0 to w8a8
Layer features.4.conv.2, precision switch from w8a8 to w4a8.
switched layer features.4.conv.2 to w4a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.1.0 to w8a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.6.conv.0.0 to w4a8
Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.1.0 to w8a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.0.0 to w8a8
Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.1.0 to w8a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.0.0 to w8a8
Layer features.9.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.0.0 to w8a8
Layer features.10.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w4a8.
switched layer features.10.conv.2 to w4a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.1.0 to w8a8
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
switched layer features.12.conv.2 to w8a8
Layer features.13.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.1.0 to w8a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.15.conv.0.0 to w4a8
Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.15.conv.1.0 to w8a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.16.conv.0.0 to w8a8
Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.16.conv.1.0 to w8a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.1.0 to w8a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13026968786010132, expected loss 3.970825977718355, actual acc 30.999999954223632, actual loss 3.2294141387939455
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14331486766616297, expected loss 3.3187558130378743, actual acc 46.09999951171875, actual loss 2.513716911315918
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.15039189894334043, expected loss 3.0664228647575396, actual acc 47.09999969482422, actual loss 2.4715241050720214
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16156183415228073, expected loss 2.850032648406983, actual acc 49.40000012207031, actual loss 2.304720260620117
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.18212429882158543, expected loss 2.6272426694259643, actual acc 51.49999975585938, actual loss 2.079436592102051
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.18212429882158543, expected loss 2.6272426694259643, actual acc 51.49999975585938, actual loss 2.079436592102051
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.20299658651128408, expected loss 2.4533814280853274, actual acc 59.09999963378906, actual loss 1.6862680978775024
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.20299658651128408, expected loss 2.4533814280853274, actual acc 59.09999963378906, actual loss 1.6862680978775024
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.21, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss, compression 0.21604176631734573, expected loss 2.3512199490890504, actual acc 59.60000006103515, actual loss 1.6337575912475586
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.22, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss, compression 0.22073803104752793, expected loss 2.3263268202171328, actual acc 60.49999969482422, actual loss 1.6265387296676637
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Found K = 13
Final Solution:  {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Achieved compression:  0.2337832108535896
Expected acc:  2.2694633334503176
Params % in int 4 = 0.1297343131712832
Params % in int 8 = 0.8702656868287167
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.w8a8.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.w4a8.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.1.conv.0.0 to w8a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.2.conv.1.0 to w4a8
Layer features.2.conv.2, precision switch from w8a8 to w4a8.
switched layer features.2.conv.2 to w4a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.1.0 to w8a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.1.0 to w8a8
Layer features.4.conv.2, precision switch from w8a8 to w4a8.
switched layer features.4.conv.2 to w4a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.1.0 to w8a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.6.conv.0.0 to w4a8
Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.1.0 to w8a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.7.conv.1.0 to w4a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.0.0 to w8a8
Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.1.0 to w8a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.0.0 to w8a8
Layer features.9.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.9.conv.1.0 to w4a8
Layer features.9.conv.2, precision switch from w8a8 to w4a8.
switched layer features.9.conv.2 to w4a8
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.0.0 to w8a8
Layer features.10.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.10.conv.1.0 to w4a8
Layer features.10.conv.2, precision switch from w8a8 to w4a8.
switched layer features.10.conv.2 to w4a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.11.conv.1.0 to w4a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.1.0 to w8a8
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
switched layer features.12.conv.2 to w8a8
Layer features.13.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.1.0 to w8a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w8a8 to w4a8.
switched layer features.14.conv.1.0 to w4a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.15.conv.0.0 to w8a8
Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.15.conv.1.0 to w8a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.16.conv.0.0 to w8a8
Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.16.conv.1.0 to w8a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.1.0 to w8a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.23_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.23_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13026968786010132, expected loss 3.970825977718355, actual acc 30.999999954223632, actual loss 3.2294141387939455
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14331486766616297, expected loss 3.3187558130378743, actual acc 46.09999951171875, actual loss 2.513716911315918
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.15039189894334043, expected loss 3.0664228647575396, actual acc 47.09999969482422, actual loss 2.4715241050720214
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16156183415228073, expected loss 2.850032648406983, actual acc 49.40000012207031, actual loss 2.304720260620117
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.18212429882158543, expected loss 2.6272426694259643, actual acc 51.49999975585938, actual loss 2.079436592102051
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.18212429882158543, expected loss 2.6272426694259643, actual acc 51.49999975585938, actual loss 2.079436592102051
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.20299658651128408, expected loss 2.4533814280853274, actual acc 59.09999963378906, actual loss 1.6862680978775024
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.20299658651128408, expected loss 2.4533814280853274, actual acc 59.09999963378906, actual loss 1.6862680978775024
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.21, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss, compression 0.21604176631734573, expected loss 2.3512199490890504, actual acc 59.60000006103515, actual loss 1.6337575912475586
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.22, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss, compression 0.22073803104752793, expected loss 2.3263268202171328, actual acc 60.49999969482422, actual loss 1.6265387296676637
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.23, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.23_loss, compression 0.2337832108535896, expected loss 2.2694633334503176, actual acc 61.699999420166016, actual loss 1.554146978378296
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Found K = 2
Final Solution:  {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [8, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [8, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [8, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [8, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [8, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [8, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Policy:  ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Achieved compression:  0.2406074705396356
Expected acc:  2.2663931819458005
Params % in int 4 = 0.07514023568291517
Params % in int 8 = 0.9248597643170848
For precision=w8a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.w8a8.measure_perC.adaquant
For precision=w4a8, loading /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.w4a8.measure_perC.adaquant
Layer features.1.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.1.conv.0.0 to w8a8
Layer features.1.conv.1, precision switch from w8a8 to w8a8.
switched layer features.1.conv.1 to w8a8
Layer features.2.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.0.0 to w8a8
Layer features.2.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.2.conv.1.0 to w8a8
Layer features.2.conv.2, precision switch from w8a8 to w8a8.
switched layer features.2.conv.2 to w8a8
Layer features.3.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.0.0 to w8a8
Layer features.3.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.3.conv.1.0 to w8a8
Layer features.3.conv.2, precision switch from w8a8 to w8a8.
switched layer features.3.conv.2 to w8a8
Layer features.4.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.0.0 to w8a8
Layer features.4.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.4.conv.1.0 to w8a8
Layer features.4.conv.2, precision switch from w8a8 to w8a8.
switched layer features.4.conv.2 to w8a8
Layer features.5.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.0.0 to w8a8
Layer features.5.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.5.conv.1.0 to w8a8
Layer features.5.conv.2, precision switch from w8a8 to w8a8.
switched layer features.5.conv.2 to w8a8
Layer features.6.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.0.0 to w8a8
Layer features.6.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.6.conv.1.0 to w8a8
Layer features.6.conv.2, precision switch from w8a8 to w8a8.
switched layer features.6.conv.2 to w8a8
Layer features.7.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.0.0 to w8a8
Layer features.7.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.7.conv.1.0 to w8a8
Layer features.7.conv.2, precision switch from w8a8 to w8a8.
switched layer features.7.conv.2 to w8a8
Layer features.8.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.0.0 to w8a8
Layer features.8.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.8.conv.1.0 to w8a8
Layer features.8.conv.2, precision switch from w8a8 to w8a8.
switched layer features.8.conv.2 to w8a8
Layer features.9.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.0.0 to w8a8
Layer features.9.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.9.conv.1.0 to w8a8
Layer features.9.conv.2, precision switch from w8a8 to w8a8.
switched layer features.9.conv.2 to w8a8
Layer features.10.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.0.0 to w8a8
Layer features.10.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.10.conv.1.0 to w8a8
Layer features.10.conv.2, precision switch from w8a8 to w8a8.
switched layer features.10.conv.2 to w8a8
Layer features.11.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.0.0 to w8a8
Layer features.11.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.11.conv.1.0 to w8a8
Layer features.11.conv.2, precision switch from w8a8 to w8a8.
switched layer features.11.conv.2 to w8a8
Layer features.12.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.12.conv.0.0 to w4a8
Layer features.12.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.12.conv.1.0 to w8a8
Layer features.12.conv.2, precision switch from w8a8 to w8a8.
switched layer features.12.conv.2 to w8a8
Layer features.13.conv.0.0, precision switch from w8a8 to w4a8.
switched layer features.13.conv.0.0 to w4a8
Layer features.13.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.13.conv.1.0 to w8a8
Layer features.13.conv.2, precision switch from w8a8 to w8a8.
switched layer features.13.conv.2 to w8a8
Layer features.14.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.0.0 to w8a8
Layer features.14.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.14.conv.1.0 to w8a8
Layer features.14.conv.2, precision switch from w8a8 to w8a8.
switched layer features.14.conv.2 to w8a8
Layer features.15.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.15.conv.0.0 to w8a8
Layer features.15.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.15.conv.1.0 to w8a8
Layer features.15.conv.2, precision switch from w8a8 to w8a8.
switched layer features.15.conv.2 to w8a8
Layer features.16.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.16.conv.0.0 to w8a8
Layer features.16.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.16.conv.1.0 to w8a8
Layer features.16.conv.2, precision switch from w8a8 to w8a8.
switched layer features.16.conv.2 to w8a8
Layer features.17.conv.0.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.0.0 to w8a8
Layer features.17.conv.1.0, precision switch from w8a8 to w8a8.
switched layer features.17.conv.1.0 to w8a8
Layer features.17.conv.2, precision switch from w8a8 to w8a8.
switched layer features.17.conv.2 to w8a8

Starting ONNX export with onnx 1.8.204...
****onnx file**** /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.24_loss.onnx
ONNX export success, saved as /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.24_loss.onnx
Compression thr 0.13, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, compression 0.13026968786010132, expected loss 3.970825977718355, actual acc 30.999999954223632, actual loss 3.2294141387939455
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [4, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.14, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, compression 0.14331486766616297, expected loss 3.3187558130378743, actual acc 46.09999951171875, actual loss 2.513716911315918
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [4, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [4, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [4, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [4, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [4, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [4, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.15, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, compression 0.15039189894334043, expected loss 3.0664228647575396, actual acc 47.09999969482422, actual loss 2.4715241050720214
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [4, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [4, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [4, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [4, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [4, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.16, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, compression 0.16156183415228073, expected loss 2.850032648406983, actual acc 49.40000012207031, actual loss 2.304720260620117
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [4, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [4, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [4, 8], 'features.16.conv.1.0': [4, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.17, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, compression 0.18212429882158543, expected loss 2.6272426694259643, actual acc 51.49999975585938, actual loss 2.079436592102051
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.18, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, compression 0.18212429882158543, expected loss 2.6272426694259643, actual acc 51.49999975585938, actual loss 2.079436592102051
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [4, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [4, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.19, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, compression 0.20299658651128408, expected loss 2.4533814280853274, actual acc 59.09999963378906, actual loss 1.6862680978775024
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.20, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, compression 0.20299658651128408, expected loss 2.4533814280853274, actual acc 59.09999963378906, actual loss 1.6862680978775024
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [4, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.21, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss, compression 0.21604176631734573, expected loss 2.3512199490890504, actual acc 59.60000006103515, actual loss 1.6337575912475586
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [4, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.22, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss, compression 0.22073803104752793, expected loss 2.3263268202171328, actual acc 60.49999969482422, actual loss 1.6265387296676637
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [4, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.23, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.23_loss, compression 0.2337832108535896, expected loss 2.2694633334503176, actual acc 61.699999420166016, actual loss 1.554146978378296
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [4, 8], 'features.2.conv.2': [4, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [4, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [4, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [4, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [4, 8], 'features.9.conv.2': [4, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [4, 8], 'features.10.conv.2': [4, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [4, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [4, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.24, experiment 0,state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.24_loss, compression 0.2406074705396356, expected loss 2.2663931819458005, actual acc 51.500000091552735, actual loss 2.1138603954315185
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Configuration = {'features.1.conv.0.0': [8, 8], 'features.1.conv.1': [8, 8], 'features.2.conv.0.0': [8, 8], 'features.2.conv.1.0': [8, 8], 'features.2.conv.2': [8, 8], 'features.3.conv.0.0': [8, 8], 'features.3.conv.1.0': [8, 8], 'features.3.conv.2': [8, 8], 'features.4.conv.0.0': [8, 8], 'features.4.conv.1.0': [8, 8], 'features.4.conv.2': [8, 8], 'features.5.conv.0.0': [8, 8], 'features.5.conv.1.0': [8, 8], 'features.5.conv.2': [8, 8], 'features.6.conv.0.0': [8, 8], 'features.6.conv.1.0': [8, 8], 'features.6.conv.2': [8, 8], 'features.7.conv.0.0': [8, 8], 'features.7.conv.1.0': [8, 8], 'features.7.conv.2': [8, 8], 'features.8.conv.0.0': [8, 8], 'features.8.conv.1.0': [8, 8], 'features.8.conv.2': [8, 8], 'features.9.conv.0.0': [8, 8], 'features.9.conv.1.0': [8, 8], 'features.9.conv.2': [8, 8], 'features.10.conv.0.0': [8, 8], 'features.10.conv.1.0': [8, 8], 'features.10.conv.2': [8, 8], 'features.11.conv.0.0': [8, 8], 'features.11.conv.1.0': [8, 8], 'features.11.conv.2': [8, 8], 'features.12.conv.0.0': [4, 8], 'features.12.conv.1.0': [8, 8], 'features.12.conv.2': [8, 8], 'features.13.conv.0.0': [4, 8], 'features.13.conv.1.0': [8, 8], 'features.13.conv.2': [8, 8], 'features.14.conv.0.0': [8, 8], 'features.14.conv.1.0': [8, 8], 'features.14.conv.2': [8, 8], 'features.15.conv.0.0': [8, 8], 'features.15.conv.1.0': [8, 8], 'features.15.conv.2': [8, 8], 'features.16.conv.0.0': [8, 8], 'features.16.conv.1.0': [8, 8], 'features.16.conv.2': [8, 8], 'features.17.conv.0.0': [8, 8], 'features.17.conv.1.0': [8, 8], 'features.17.conv.2': [8, 8]}
Compression thr 0.13, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.13_loss, actual_compression 0.13026968786010132, expected loss 3.970825977718355, actual acc 30.999999954223632, actual loss 3.2294141387939455
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8']
Compression thr 0.14, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.14_loss, actual_compression 0.14331486766616297, expected loss 3.3187558130378743, actual acc 46.09999951171875, actual loss 2.513716911315918
Policy: ['w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Compression thr 0.15000000000000002, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.15_loss, actual_compression 0.15039189894334043, expected loss 3.0664228647575396, actual acc 47.09999969482422, actual loss 2.4715241050720214
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Compression thr 0.16000000000000003, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.16_loss, actual_compression 0.16156183415228073, expected loss 2.850032648406983, actual acc 49.40000012207031, actual loss 2.304720260620117
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Compression thr 0.17000000000000004, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.17_loss, actual_compression 0.18212429882158543, expected loss 2.6272426694259643, actual acc 51.49999975585938, actual loss 2.079436592102051
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Compression thr 0.18000000000000005, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.18_loss, actual_compression 0.18212429882158543, expected loss 2.6272426694259643, actual acc 51.49999975585938, actual loss 2.079436592102051
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8']
Compression thr 0.19000000000000006, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.19_loss, actual_compression 0.20299658651128408, expected loss 2.4533814280853274, actual acc 59.09999963378906, actual loss 1.6862680978775024
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Compression thr 0.20000000000000007, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.20_loss, actual_compression 0.20299658651128408, expected loss 2.4533814280853274, actual acc 59.09999963378906, actual loss 1.6862680978775024
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Compression thr 0.21000000000000008, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.21_loss, actual_compression 0.21604176631734573, expected loss 2.3512199490890504, actual acc 59.60000006103515, actual loss 1.6337575912475586
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Compression thr 0.22000000000000008, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.22_loss, actual_compression 0.22073803104752793, expected loss 2.3263268202171328, actual acc 60.49999969482422, actual loss 1.6265387296676637
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Compression thr 0.2300000000000001, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.23_loss, actual_compression 0.2337832108535896, expected loss 2.2694633334503176, actual acc 61.699999420166016, actual loss 1.554146978378296
Policy: ['w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
Compression thr 0.2400000000000001, experiment 0, state_dict_path /workspace/develop/CalibTIP/results/mobilenet_v2.adaquant/mobilenet_v2.absorb_bn.mixed-ip-results.comp_0.24_loss, actual_compression 0.2406074705396356, expected loss 2.2663931819458005, actual acc 51.500000091552735, actual loss 2.1138603954315185
Policy: ['w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w4a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8', 'w8a8']
